
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Qcert.Translation.NNRCMRtoCldMR</title>
<meta name="description" content="Documentation of Coq module Qcert.Translation.NNRCMRtoCldMR" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Qcert.Translation.NNRCMRtoCldMR</h1>
<div class="coq">
<br/>
<span class="kwd">Section</span> <span class="id"><a name="NNRCMRToCldMR">NNRCMRToCldMR</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html">String</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Sorting.Mergesort.html">Sorting.Mergesort</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html">EquivDec</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.Utils.Utils.html">Utils</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.Common.CommonRuntime.html">CommonRuntime</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.NNRC.NNRCRuntime.html">NNRCRuntime</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.NNRCMR.NNRCMRRuntime.html">NNRCMRRuntime</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.CldMR.Lang.ForeignCloudant.html">ForeignCloudant</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.Translation.ForeignToCloudant.html">ForeignToCloudant</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.CldMR.Lang.CldMRUtil.html">CldMRUtil</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html">CldMR</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">fredop</span>:<span class="id"><a href="Qcert.NNRCMR.Lang.ForeignReduceOps.html#foreign_reduce_op">foreign_reduce_op</a></span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">fcloudant</span>:<span class="id"><a href="Qcert.CldMR.Lang.ForeignCloudant.html#foreign_cloudant">foreign_cloudant</a></span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">ftocloudant</span>:<span class="id"><a href="Qcert.Translation.ForeignToCloudant.html#foreign_to_cloudant">foreign_to_cloudant</a></span>}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> (<span class="id">h</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>*<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>)).<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="MRtoMapCld">MRtoMapCld</a></span> (<span class="id">mrmap</span>: <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#map_fun">NNRCMR.map_fun</a></span>) (<span class="id">collectflag</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span class="id">index</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cld_map">cld_map</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">emit</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#collectflag">collectflag</a></span> <span class="kwd">then</span> <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#CldEmitCollect">CldEmitCollect</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="kwd">else</span> <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#CldEmitDist">CldEmitDist</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mrmap">mrmap</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#MapDist">MapDist</a></span> (<span class="id">x</span>, <span class="id">n</span>) =&gt; <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#mkMapCld">mkMapCld</a></span> (<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#CldMapId">CldMapId</a></span> (<span class="id">x</span>, <span class="id">n</span>)) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#emit">emit</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#MapDistFlatten">MapDistFlatten</a></span> (<span class="id">x</span>, <span class="id">n</span>) =&gt; <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#mkMapCld">mkMapCld</a></span> (<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#CldMapFlatten">CldMapFlatten</a></span> (<span class="id">x</span>, <span class="id">n</span>)) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#emit">emit</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#MapScalar">MapScalar</a></span> (<span class="id">x</span>, <span class="id">n</span>) =&gt; <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#mkMapCld">mkMapCld</a></span> (<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#CldMapFlatten">CldMapFlatten</a></span> (<span class="id">x</span>,<span class="id">n</span>)) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#emit">emit</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="pushReduce">pushReduce</a></span> (<span class="id">avoiddb</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) (<span class="id">r</span>:(<span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>*<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)) : <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cld_reduce">cld_reduce</a></span> * (<span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>*<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cld_map">cld_map</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">fresh_outputdb</span> := <span class="id"><a href="Qcert.Utils.Fresh.html#fresh_var">fresh_var</a></span> "<span class="id">output_</span>" <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">pushed_reduce</span> := <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#collectReduce">collectReduce</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#fresh_outputdb">fresh_outputdb</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v_red</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#r">r</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">f_red</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#r">r</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">pushed_map</span> := <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoMapCld">MRtoMapCld</a></span> (<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#MapScalar">MapScalar</a></span> (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#v_red">v_red</a></span>,<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AColl">AColl</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#f_red">f_red</a></span>)) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> 0 <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#pushed_reduce">pushed_reduce</a></span>, (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#fresh_outputdb">fresh_outputdb</a></span>, <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#pushed_map">pushed_map</a></span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="pushMR">pushMR</a></span> (<span class="id">dbinput</span> <span class="id">dboutput</span>:<span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) (<span class="id">pushed_map</span>: <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cld_map">cld_map</a></span>) (<span class="id">mrempty</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#mkMRCld">mkMRCld</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#dbinput">dbinput</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#pushed_map">pushed_map</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#idReduce">idReduce</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#dboutput">dboutput</a></span>))) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mrempty">mrempty</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="pushMRNoRed">pushMRNoRed</a></span> (<span class="id">dbinput</span>:<span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) (<span class="id">pushed_map</span>: <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cld_map">cld_map</a></span>) (<span class="id">mrempty</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#mkMRCld">mkMRCld</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#dbinput">dbinput</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#pushed_map">pushed_map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mrempty">mrempty</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="minMap">minMap</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">x</span> := "<span class="id">x</span>"%<span class="id">string</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">map_fun</span> := (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#x">x</a></span>, <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ADot">ADot</a></span> "<span class="id">min</span>") (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#x">x</a></span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#mkMapCld">mkMapCld</a></span> (<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#CldMapId">CldMapId</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#map_fun">map_fun</a></span>) (<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#CldEmitCollect">CldEmitCollect</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="minMR">minMR</a></span> (<span class="id">stats_v</span> <span class="id">out_v</span>: <span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#mkMRCld">mkMRCld</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#stats_v">stats_v</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#minMap">minMap</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#idReduce">idReduce</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#out_v">out_v</a></span>))).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="minMRNoRed">minMRNoRed</a></span> (<span class="id">stats_v</span>: <span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#mkMRCld">mkMRCld</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#stats_v">stats_v</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#minMap">minMap</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="maxMap">maxMap</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">x</span> := "<span class="id">x</span>"%<span class="id">string</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">map_fun</span> := (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#x">x</a></span>, <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ADot">ADot</a></span> "<span class="id">max</span>") (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#x">x</a></span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#mkMapCld">mkMapCld</a></span> (<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#CldMapId">CldMapId</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#map_fun">map_fun</a></span>) (<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#CldEmitCollect">CldEmitCollect</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="maxMR">maxMR</a></span> (<span class="id">stats_v</span> <span class="id">out_v</span>: <span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#mkMRCld">mkMRCld</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#stats_v">stats_v</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#maxMap">maxMap</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#idReduce">idReduce</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#out_v">out_v</a></span>))).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="maxMRNoRed">maxMRNoRed</a></span> (<span class="id">stats_v</span>: <span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#mkMRCld">mkMRCld</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#stats_v">stats_v</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#maxMap">maxMap</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="MRtoReduceCld">MRtoReduceCld</a></span> (<span class="id">v_key</span>:<span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) (<span class="id">out_v</span>:<span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) (<span class="id">avoiddb</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) (<span class="id">mrr</span>: <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#reduce_fun">NNRCMR.reduce_fun</a></span>) (<span class="id">mrempty</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> * <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cld_reduce">cld_reduce</a></span> * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_step">cldmr_step</a></span>) * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mrr">mrr</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#RedId">RedId</a></span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>, <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#idReduce">idReduce</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#out_v">out_v</a></span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#RedCollect">RedCollect</a></span> <span class="id">redf</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">pushed_red</span>, (<span class="id">newdbout</span>,<span class="id">pushed_map</span>)) := <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#pushReduce">pushReduce</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span> <span class="id">redf</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">pushed_mr</span> := <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#pushMR">pushMR</a></span> <span class="id">newdbout</span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#out_v">out_v</a></span> <span class="id">pushed_map</span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mrempty">mrempty</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>, <span class="id">pushed_red</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#pushed_mr">pushed_mr</a></span>, <span class="id">newdbout</span>::<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#RedOp">RedOp</a></span> <span class="id">op</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">op</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#RedOpForeign">RedOpForeign</a></span> <span class="id">frop</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>, <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#opReduce">opReduce</a></span> (<span class="id"><a href="Qcert.Translation.ForeignToCloudant.html#foreign_to_cloudant_reduce_op">foreign_to_cloudant_reduce_op</a></span> <span class="id">frop</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#out_v">out_v</a></span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#RedSingleton">RedSingleton</a></span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>, <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#idReduce">idReduce</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#out_v">out_v</a></span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="MRtoMRCld">MRtoMRCld</a></span> (<span class="id">avoiddb</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) (<span class="id">mr</span>: <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr">mr</a></span>) : (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_step">cldmr_step</a></span>) * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">cld_input</span> := <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_input">mr_input</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr">mr</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">cld_output</span> := <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_output">mr_output</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr">mr</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mrmap</span> := <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_map">mr_map</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr">mr</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mrred</span> := <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_reduce">mr_reduce</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr">mr</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">mrempty</span> := <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_reduce_empty">mr_reduce_empty</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#NNRCMRToCldMR.h">h</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr">mr</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">v_key</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mrmap">mrmap</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#MapDist">MapDist</a></span> (<span class="id">x</span>, <span class="id">_</span>) =&gt; <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#MapDistFlatten">MapDistFlatten</a></span> (<span class="id">x</span>, <span class="id">_</span>) =&gt; <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#MapScalar">MapScalar</a></span> (<span class="id">x</span>, <span class="id">_</span>) =&gt; <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">collectflag</span>, <span class="id">first_reduce</span>,<span class="id">pushedmr</span>,<span class="id">avoiddb</span>') := <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoReduceCld">MRtoReduceCld</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#v_key">v_key</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#cld_output">cld_output</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mrred">mrred</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mrempty">mrempty</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">cld_map</span> := <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoMapCld">MRtoMapCld</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mrmap">mrmap</a></span> <span class="id">collectflag</span> 0 <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">pushedmr</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; (<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#mkMRCld">mkMRCld</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#cld_input">cld_input</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#cld_map">cld_map</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">first_reduce</span>) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mrempty">mrempty</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>, <span class="id">avoiddb</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">nextmr</span> =&gt; ((<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#mkMRCld">mkMRCld</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#cld_input">cld_input</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#cld_map">cld_map</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">first_reduce</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Common.Data.RData.html#dcoll">dcoll</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)))) :: <span class="id">nextmr</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>, <span class="id">avoiddb</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="cld_data_of_localized_data">cld_data_of_localized_data</a></span> (<span class="id">locd</span>:<span class="id"><a href="Qcert.Common.Data.DData.html#ddata">ddata</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Qcert.Common.Data.RData.html#data">data</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#locd">locd</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Data.DData.html#Dlocal">Dlocal</a></span> <span class="id">d</span> =&gt; (<span class="id">d</span>::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Data.DData.html#Ddistr">Ddistr</a></span> <span class="id">dl</span> =&gt; <span class="id">dl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="rmap_with_key">rmap_with_key</a></span> (<span class="id">prefix</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">i</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">v</span>:<span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) (<span class="id">n</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) (<span class="id">coll</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Qcert.Common.Data.RData.html#data">data</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.Common.Data.RRelation.html#rmap">rmap</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">d</span> : <span class="id"><a href="Qcert.Common.Data.RData.html#data">data</a></span> * <span class="id"><a href="Qcert.Common.Data.RData.html#data">data</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">k</span>, <span class="id">v0</span>) := <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#d">d</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#nnrc_core_eval">nnrc_core_eval</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#NNRCMRToCldMR.h">h</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ((<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#v">v</a></span>, <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#v0">v0</a></span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#n">n</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">res</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#k">k</a></span>, <span class="id">res</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) (<span class="id"><a href="Qcert.CldMR.Lang.CldMRUtil.html#init_keys_aux">init_keys_aux</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#prefix">prefix</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#i">i</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#coll">coll</a></span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Utils.Lift.html#lift">lift</a></span> (<span class="id"><a href="Qcert.CldMR.Lang.CldMRUtil.html#init_keys_aux">init_keys_aux</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#prefix">prefix</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#i">i</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.Common.Data.RRelation.html#rmap">rmap</a></span> (<span class="kwd">fun</span> <span class="id">d</span> : <span class="id"><a href="Qcert.Common.Data.RData.html#data">data</a></span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#nnrc_core_eval">nnrc_core_eval</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#NNRCMRToCldMR.h">h</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ((<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#v">v</a></span>, <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#d">d</a></span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#n">n</a></span>) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#coll">coll</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2889')">Proof.</div>
<div class="proofscript" id="proof2889">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">coll</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#nnrc_core_eval">nnrc_core_eval</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#NNRCMRToCldMR.h">h</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ((<span class="id">v</span>, <span class="id">a</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">n</span>); <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">IHcoll</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">i</span>)); <span class="tactic">clear</span> <span class="id">IHcoll</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ((<span class="id"><a href="Qcert.Common.Data.RRelation.html#rmap">rmap</a></span> (<span class="kwd">fun</span> <span class="id">d0</span> : <span class="id"><a href="Qcert.Common.Data.RData.html#data">data</a></span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#nnrc_core_eval">nnrc_core_eval</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#NNRCMRToCldMR.h">h</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ((<span class="id">v</span>, <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#d0">d0</a></span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">n</span>) <span class="id">coll</span>)); <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="rmap_eval_through_init_keys">rmap_eval_through_init_keys</a></span> (<span class="id">l</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Qcert.Common.Data.RData.html#data">data</a></span>) (<span class="id">n</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) (<span class="id">v</span>:<span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.Common.Data.RRelation.html#rmap">rmap</a></span> (<span class="kwd">fun</span> <span class="id">d</span> : <span class="id"><a href="Qcert.Common.Data.RData.html#data">data</a></span> * <span class="id"><a href="Qcert.Common.Data.RData.html#data">data</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">k</span>, <span class="id">v0</span>) := <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#d">d</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#nnrc_core_eval">nnrc_core_eval</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#NNRCMRToCldMR.h">h</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ((<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#v">v</a></span>, <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#v0">v0</a></span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#n">n</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">res0</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#k">k</a></span>, <span class="id">res0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) (<span class="id"><a href="Qcert.CldMR.Lang.CldMRUtil.html#init_keys">init_keys</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#l">l</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="Qcert.Utils.Lift.html#lift">lift</a></span> <span class="id"><a href="Qcert.CldMR.Lang.CldMRUtil.html#init_keys">init_keys</a></span> (<span class="id"><a href="Qcert.Common.Data.RRelation.html#rmap">rmap</a></span> (<span class="kwd">fun</span> <span class="id">d</span> : <span class="id"><a href="Qcert.Common.Data.RData.html#data">data</a></span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#nnrc_core_eval">nnrc_core_eval</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#NNRCMRToCldMR.h">h</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> ((<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#v">v</a></span>, <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#d">d</a></span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#n">n</a></span>) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#l">l</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2890')">Proof.</div>
<div class="proofscript" id="proof2890">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.CldMR.Lang.CldMRUtil.html#init_keys">init_keys</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#rmap_with_key">rmap_with_key</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="MRtoMRCld_preserves_causally_consistent">MRtoMRCld_preserves_causally_consistent</a></span> (<span class="id">init_unit</span>:<span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) (<span class="id">mr</span>:<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr">mr</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr">mr</a></span>.(<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_input">mr_input</a></span>) &lt;&gt; <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr">mr</a></span>.(<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_output">mr_output</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr">mr</a></span>.(<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_output">mr_output</a></span>) &lt;&gt; <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#init_unit">init_unit</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#init_unit">init_unit</a></span> &lt;&gt; <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr">mr</a></span>.(<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_input">mr_input</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_chain_causally_consistent">cldmr_chain_causally_consistent</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoMRCld">MRtoMRCld</a></span> (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr">mr</a></span>.(<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_input">mr_input</a></span>) :: <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr">mr</a></span>.(<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_output">mr_output</a></span>) :: <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#init_unit">init_unit</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr">mr</a></span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2891')">Proof.</div>
<div class="proofscript" id="proof2891">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoMRCld">MRtoMRCld</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoReduceCld">MRtoReduceCld</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">mr</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">mr_reduce</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_chain_causally_consistent">cldmr_chain_causally_consistent</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_step_causally_consistent">cldmr_step_causally_consistent</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#nequiv_decb">nequiv_decb</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_decb">equiv_decb</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">mr_input</span> <span class="id">mr_output</span>); [ <span class="tactic">congruence</span> | ].<br/>
<div class="doc">TODO: currently false </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">admit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">r</span>; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">match_destr</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Admitted.</div>
<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="mr_chain_to_cldmr_chain">mr_chain_to_cldmr_chain</a></span> (<span class="id">avoiddb</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr">mr</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_step">cldmr_step</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">mr</span> :: <span class="id">l</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">cldmr_step</span>,<span class="id">avoiddb</span>') := (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoMRCld">MRtoMRCld</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span> <span class="id">mr</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#cldmr_step">cldmr_step</a></span> ++ (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr_chain_to_cldmr_chain">mr_chain_to_cldmr_chain</a></span> <span class="id">avoiddb</span>' <span class="id">l</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="mr_last_to_cldmr_last">mr_last_to_cldmr_last</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">mr_last_closure</span>:(<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span> * <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span> * <span class="id"><a href="Qcert.Common.Data.DData.html#dlocalization">dlocalization</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span> * <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">fvs</span>, <span class="id">mr_last</span>) := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr_last_closure">mr_last_closure</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vars_loc</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr_last_closure">mr_last_closure</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">cldmr_last</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">fv</span> <span class="id">k</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Utils.Assoc.html#lookup">lookup</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#vars_loc">vars_loc</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#fv">fv</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#k">k</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Qcert.Common.Data.DData.html#Vdistr">Vdistr</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#fv">fv</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#fv">fv</a></span>) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#k">k</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="Qcert.Common.Data.DData.html#Vlocal">Vlocal</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#fv">fv</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ASingleton">ASingleton</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#fv">fv</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#fv">fv</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#fv">fv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#fv">fv</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id"><a href="Qcert.Common.Data.RData.html#dunit">dunit</a></span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#k">k</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr_last">mr_last</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#fvs">fvs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#fvs">fvs</a></span>, <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#cldmr_last">cldmr_last</a></span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#vars_loc">vars_loc</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="NNRCMRtoNNRCMRCloudant">NNRCMRtoNNRCMRCloudant</a></span> (<span class="id">avoiddb</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) (<span class="id">mrl</span>: <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#nnrcmr">nnrcmr</a></span>) : <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr">cldmr</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#mkMRCldChain">mkMRCldChain</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr_chain_to_cldmr_chain">mr_chain_to_cldmr_chain</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mrl">mrl</a></span>.(<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_chain">mr_chain</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr_last_to_cldmr_last">mr_last_to_cldmr_last</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mrl">mrl</a></span>.(<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_last">mr_last</a></span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html">Bool</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="MRtoMRCld_causally_consistent">MRtoMRCld_causally_consistent</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">avoiddb</span> (<span class="id">mr</span>:<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr">mr</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr">mr</a></span>.(<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_input">mr_input</a></span>) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_causally_consistent">mr_causally_consistent</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr">mr</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr">mr</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_step_input">cldmr_step_input</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#y">y</a></span> &lt;&gt;<span class="id">b</span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr">mr</a></span>.(<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_output">mr_output</a></span>)) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#x">x</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_chain_causally_consistent">cldmr_chain_causally_consistent</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#x">x</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr">mr</a></span>.(<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_output">mr_output</a></span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_step_input">cldmr_step_input</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#x">x</a></span>) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_chain_causally_consistent">cldmr_chain_causally_consistent</a></span> (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#x">x</a></span> ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoMRCld">MRtoMRCld</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr">mr</a></span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2892')">Proof.</div>
<div class="proofscript" id="proof2892">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoMRCld">MRtoMRCld</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoReduceCld">MRtoReduceCld</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">mr</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">mr_reduce</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_chain_causally_consistent">cldmr_chain_causally_consistent</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_step_causally_consistent">cldmr_step_causally_consistent</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_causally_consistent">mr_causally_consistent</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#nequiv_decb">nequiv_decb</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_decb">equiv_decb</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Qcert.Utils.ListAdd.html#forallb_ordpairs_refl_app_cons">forallb_ordpairs_refl_app_cons</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="Qcert.Utils.ListAdd.html#app_cons_cons_expand">app_cons_cons_expand</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.Utils.ListAdd.html#forallb_ordpairs_refl_app_cons">forallb_ordpairs_refl_app_cons</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Qcert.Utils.ListAdd.html#forallb_ordpairs_refl_app_cons">forallb_ordpairs_refl_app_cons</a></span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">e</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.Utils.Fresh.html#fresh_var_fresh">fresh_var_fresh</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb_forall">forallb_forall</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">aa</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> (<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_step_input">cldmr_step_input</a></span> <span class="id">aa</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">e</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eelim</span> <span class="id"><a href="Qcert.Utils.Fresh.html#fresh_var_fresh">fresh_var_fresh</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">e</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eelim</span> <span class="id"><a href="Qcert.Utils.Fresh.html#fresh_var_fresh">fresh_var_fresh</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr_in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Qcert.Utils.CoqLibAdd.html#forallb_app">forallb_app</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">r</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [ <span class="tactic">apply</span> <span class="id"><a href="Qcert.Utils.ListAdd.html#forallb_ordpairs_refl_app_cons">forallb_ordpairs_refl_app_cons</a></span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Qcert.Utils.ListAdd.html#forallb_ordpairs_refl_app_cons">forallb_ordpairs_refl_app_cons</a></span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="MRtoMRCid_avoids">MRtoMRCid_avoids</a></span> <span class="id">avoiddb</span> <span class="id">a</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">l0</span>, <span class="id">l1</span>) := <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoMRCld">MRtoMRCld</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#a">a</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_input">mr_input</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#a">a</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span> ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_step_input">cldmr_step_input</a></span> <span class="id">l0</span>) <span class="id">l1</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2893')">Proof.</div>
<div class="proofscript" id="proof2893">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoMRCld">MRtoMRCld</a></span>, <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoReduceCld">MRtoReduceCld</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">mr_reduce</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">r</span>; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="MRtoMRCid_input_avoids">MRtoMRCid_input_avoids</a></span> <span class="id">avoiddb</span> <span class="id">a</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">l0</span>, <span class="id">l1</span>) := <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoMRCld">MRtoMRCld</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#a">a</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_step_input">cldmr_step_input</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#x">x</a></span> = <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_input">mr_input</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#a">a</a></span> \/ ~ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_step_input">cldmr_step_input</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#x">x</a></span>) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span>) <span class="id">l0</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2894')">Proof.</div>
<div class="proofscript" id="proof2894">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">fresh_var_fresh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoMRCld">MRtoMRCld</a></span>, <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoReduceCld">MRtoReduceCld</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">mr_reduce</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>; <span class="tactic">simpl</span>; [<span class="tactic">intuition</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">simpl</span>; [| <span class="tactic">intuition</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">r</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="NNRCMRtoNNRCMRCloudant_causally_consistent">NNRCMRtoNNRCMRCloudant_causally_consistent</a></span> <span class="id">avoiddb</span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_chain_causally_consistent">mr_chain_causally_consistent</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_chain_causally_consistent">cldmr_chain_causally_consistent</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#x">x</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="kwd">fun</span> <span class="id">a</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="kwd">fun</span> <span class="id">y</span> : <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_step">cldmr_step</a></span> =&gt; <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_step_input">cldmr_step_input</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#y">y</a></span> &lt;&gt;<span class="id">b</span> <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_output">mr_output</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#a">a</a></span>) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#x">x</a></span>) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_input">mr_input</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#l">l</a></span> ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_output">mr_output</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#l">l</a></span> ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_step_input">cldmr_step_input</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#x">x</a></span>) <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_chain_causally_consistent">cldmr_chain_causally_consistent</a></span> (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#x">x</a></span> ++ <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mr_chain_to_cldmr_chain">mr_chain_to_cldmr_chain</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#l">l</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2895')">Proof.</div>
<div class="proofscript" id="proof2895">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_chain_causally_consistent">mr_chain_causally_consistent</a></span>, <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_chain_causally_consistent">cldmr_chain_causally_consistent</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">avoiddb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span> <span class="id">avoiddb</span> <span class="id">lcc</span> <span class="id">x</span> <span class="id">xcc</span> <span class="id">avoided</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span>; <span class="tactic">trivial</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">andb_true_iff</a></span> <span class="kwd">in</span> * .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">admit</span>. <span class="comment">(*&nbsp;XXXXXXXXXXXXX&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;rewrite&nbsp;app_nil_r.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;apply&nbsp;MRtoMRCldLast_causually_consistent;&nbsp;trivial.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;simpl&nbsp;in&nbsp;*.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;unfold&nbsp;incl&nbsp;in&nbsp;*;&nbsp;simpl&nbsp;in&nbsp;*;&nbsp;intuition.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">match_case</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_ass">app_ass</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span> <span class="kwd">in</span> * .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">andb_true_iff</a></span> <span class="kwd">in</span> * .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">generalize</span> (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoMRCld_causally_consistent">MRtoMRCld_causally_consistent</a></span> <span class="id">avoiddb</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">HH</span>; <span class="tactic">clear</span> <span class="id">HH</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">aa</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">aa</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">andb_true_iff</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Qcert.Utils.CoqLibAdd.html#forallb_app">forallb_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">generalize</span> (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoMRCid_input_avoids">MRtoMRCid_input_avoids</a></span> <span class="id">avoiddb</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb_forall">forallb_forall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">HH</span> ? <span class="id">inn2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">HH</span> <span class="id">_</span> <span class="id">inn2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#nequiv_decb">nequiv_decb</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_decb">equiv_decb</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">e</span> <span class="kwd">in</span> * .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> [<span class="id">eqq</span>|<span class="id">inn3</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_causally_consistent">mr_causally_consistent</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#nequiv_decb">nequiv_decb</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_decb">equiv_decb</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr_in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">elim</span> <span class="id">inn3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H</span> (<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_output">mr_output</a></span> <span class="id">m</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb_forall">forallb_forall</a></span> <span class="kwd">in</span> <span class="id">H8</span> |- *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H8</span> <span class="id">_</span> <span class="id">inn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Qcert.Utils.CoqLibAdd.html#forallb_app">forallb_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoMRCid_input_avoids">MRtoMRCid_input_avoids</a></span> <span class="id">avoiddb</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_forall">Forall_forall</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb_forall">forallb_forall</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">HH</span> ? <span class="id">inn2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">HH</span> <span class="id">_</span> <span class="id">inn2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#nequiv_decb">nequiv_decb</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_decb">equiv_decb</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">e</span> <span class="kwd">in</span> * .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">HH</span> <span class="kwd">as</span> [<span class="id">eqq</span>|<span class="id">inn3</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb_forall">forallb_forall</a></span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H9</span> <span class="id">_</span> <span class="id">inn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_causally_consistent">mr_causally_consistent</a></span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#nequiv_decb">nequiv_decb</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_decb">equiv_decb</a></span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr_in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">elim</span> <span class="id">inn3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H</span> (<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_output">mr_output</a></span> <span class="id">x0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_output">mr_output</a></span> <span class="id">x0</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_output">mr_output</a></span> <span class="id">l</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">repeat</span> (<span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map_iff">in_map_iff</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">generalize</span> (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#MRtoMRCid_avoids">MRtoMRCid_avoids</a></span> <span class="id">avoiddb</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">intros</span> <span class="id">inc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">inc</span>; <span class="tactic">clear</span> <span class="id">inc</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="kwd">in</span> *; <span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">aa</span> <span class="id">inn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">aa</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span> <span class="kwd">in</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span> <span class="kwd">in</span> <span class="id">inn</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">inn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Admitted.</div>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="nnrcmr_to_cldmr_top">nnrcmr_to_cldmr_top</a></span> (<span class="id">mrl</span>: <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#nnrcmr">nnrcmr</a></span>) : <span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr">cldmr</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">avoiddb</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_input">mr_input</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mrl">mrl</a></span>.(<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_chain">mr_chain</a></span>) ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_output">mr_output</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mrl">mrl</a></span>.(<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#mr_chain">mr_chain</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#NNRCMRtoNNRCMRCloudant">NNRCMRtoNNRCMRCloudant</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#avoiddb">avoiddb</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mrl">mrl</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="nnrcmr_to_cldmr_top_causally_consistent">nnrcmr_to_cldmr_top_causally_consistent</a></span> <span class="id">mrl</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRCMR.Lang.NNRCMR.html#nnrcmr_causally_consistent">nnrcmr_causally_consistent</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mrl">mrl</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_chain_causally_consistent">cldmr_chain_causally_consistent</a></span> (<span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#nnrcmr_to_cldmr_top">nnrcmr_to_cldmr_top</a></span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#mrl">mrl</a></span>).(<span class="id"><a href="Qcert.CldMR.Lang.CldMR.html#cldmr_chain">cldmr_chain</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2896')">Proof.</div>
<div class="proofscript" id="proof2896">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">cc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#nnrcmr_to_cldmr_top">nnrcmr_to_cldmr_top</a></span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;generalize&nbsp;(NNRCMRtoNNRCMRCloudantInit_causally_consistent&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(List.map&nbsp;mr_input&nbsp;l&nbsp;++&nbsp;List.map&nbsp;mr_output&nbsp;l)&nbsp;l&nbsp;cc&nbsp;nil);&nbsp;simpl;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;HH.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;apply&nbsp;HH.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;reflexivity.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;rewrite&nbsp;forallb_forall;&nbsp;intuition.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;-&nbsp;rewrite&nbsp;app_nil_r.&nbsp;reflexivity.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>
&nbsp;&nbsp;Admitted.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Qcert.Translation.NNRCMRtoCldMR.html#NNRCMRToCldMR">NNRCMRToCldMR</a></span>.<br/>
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
