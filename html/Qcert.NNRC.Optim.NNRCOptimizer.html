
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Qcert.NNRC.Optim.NNRCOptimizer</title>
<meta name="description" content="Documentation of Coq module Qcert.NNRC.Optim.NNRCOptimizer" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Qcert.NNRC.Optim.NNRCOptimizer</h1>
<div class="coq">
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="NNRCOptimizer">NNRCOptimizer</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html">String</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.ListSet.html">ListSet</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Arith.html">Arith</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Equivalence.html">Equivalence</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html">Morphisms</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Setoids.Setoid.html">Setoid</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html">EquivDec</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="kwd">Program</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.Common.CommonSystem.html">CommonSystem</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.cNNRC.cNNRCSystem.html">cNNRCSystem</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.NNRC.NNRCSystem.html">NNRCSystem</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCRewriteUtil.html">NNRCRewriteUtil</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCRewrite.html">NNRCRewrite</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html">TNNRCRewrite</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.Common.Logger.OptimizerLogger.html">OptimizerLogger</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html">OptimizerStep</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">nnrc_scope</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">string</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="NNRCOptimizer.engine">engine</a></span>.<br/>
<div class="doc">Apply the function f to the direct child of p </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="nnrc_map">nnrc_map</a></span> (<span class="id">f</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span> -&gt; <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCGetConstant">NNRCGetConstant</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCGetConstant">NNRCGetConstant</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id">bop</span> <span class="id">e1</span> <span class="id">e2</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id">bop</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e1</span>) (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">uop</span> <span class="id">e1</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">uop</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id">v</span> <span class="id">e1</span> <span class="id">e2</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id">v</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e1</span>) (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v</span> <span class="id">e1</span> <span class="id">e2</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e1</span>) (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">e3</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e1</span>) (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e2</span>) (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">ed</span> <span class="id">xl</span> <span class="id">el</span> <span class="id">xr</span> <span class="id">er</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">ed</span>) <span class="id">xl</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">el</span>) <span class="id">xr</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">er</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCGroupBy">NNRCGroupBy</a></span> <span class="id">g</span> <span class="id">sl</span> <span class="id">e1</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCGroupBy">NNRCGroupBy</a></span> <span class="id">g</span> <span class="id">sl</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="nnrc_map_correctness">nnrc_map_correctness</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span> -&gt; <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">e</span>', <span class="id"><a href="Qcert.NNRC.Lang.NNRCEq.html#nnrc_eq">nnrc_eq</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e</span>') <span class="id">e</span>') -&gt; <span class="id"><a href="Qcert.NNRC.Lang.NNRCEq.html#nnrc_eq">nnrc_eq</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map">nnrc_map</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>) <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2557')">Proof.</div>
<div class="proofscript" id="proof2557">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">f</span> <span class="id">e</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nnrc_cases</span> (<span class="tactic">induction</span> <span class="id">e</span>) <span class="id">Case</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">simpl</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Hf</span>; <span class="tactic">reflexivity</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">Apply the function f to all subexpression of e. </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="nnrc_map_deep">nnrc_map_deep</a></span> (<span class="id">f</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span> -&gt; <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) (<span class="id">e</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCGetConstant">NNRCGetConstant</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCGetConstant">NNRCGetConstant</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id">bop</span> <span class="id">e1</span> <span class="id">e2</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id">bop</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map_deep">nnrc_map_deep</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e1</span>) (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map_deep">nnrc_map_deep</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">uop</span> <span class="id">e1</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">uop</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map_deep">nnrc_map_deep</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id">v</span> <span class="id">e1</span> <span class="id">e2</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id">v</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map_deep">nnrc_map_deep</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e1</span>) (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map_deep">nnrc_map_deep</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v</span> <span class="id">e1</span> <span class="id">e2</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map_deep">nnrc_map_deep</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e1</span>) (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map_deep">nnrc_map_deep</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">e3</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map_deep">nnrc_map_deep</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e1</span>) (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map_deep">nnrc_map_deep</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e2</span>) (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map_deep">nnrc_map_deep</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e3</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">ed</span> <span class="id">xl</span> <span class="id">el</span> <span class="id">xr</span> <span class="id">er</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map_deep">nnrc_map_deep</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">ed</span>) <span class="id">xl</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map_deep">nnrc_map_deep</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span>  <span class="id">el</span>) <span class="id">xr</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map_deep">nnrc_map_deep</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">er</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCGroupBy">NNRCGroupBy</a></span> <span class="id">g</span> <span class="id">sl</span> <span class="id">e1</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCGroupBy">NNRCGroupBy</a></span> <span class="id">g</span> <span class="id">sl</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map_deep">nnrc_map_deep</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="nnrc_map_deep_corretness">nnrc_map_deep_corretness</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span> -&gt; <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">e</span>', <span class="id"><a href="Qcert.NNRC.Lang.NNRCEq.html#nnrc_eq">nnrc_eq</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e</span>') <span class="id">e</span>') -&gt; <span class="id"><a href="Qcert.NNRC.Lang.NNRCEq.html#nnrc_eq">nnrc_eq</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map_deep">nnrc_map_deep</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>) <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2558')">Proof.</div>
<div class="proofscript" id="proof2558">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">f</span> <span class="id">e</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nnrc_cases</span> (<span class="tactic">induction</span> <span class="id">e</span>) <span class="id">Case</span>; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Hf</span>; <span class="tactic">reflexivity</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Hf</span>; <span class="tactic">rewrite</span> <span class="id">IHe</span>; <span class="tactic">reflexivity</span> ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Hf</span>; <span class="tactic">rewrite</span> <span class="id">IHe1</span>; <span class="tactic">rewrite</span> <span class="id">IHe2</span>; <span class="tactic">reflexivity</span> ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Hf</span>; <span class="tactic">rewrite</span> <span class="id">IHe1</span>; <span class="tactic">rewrite</span> <span class="id">IHe2</span>; <span class="tactic">rewrite</span> <span class="id">IHe3</span>; <span class="tactic">reflexivity</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="nunshadow">nunshadow</a></span> := <span class="id"><a href="Qcert.NNRC.Lang.NNRCShadow.html#unshadow_simpl">unshadow_simpl</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="head_rew">head_rew</a></span> (<span class="id">e</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nunshadow">nunshadow</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="head_rew_correctness">head_rew_correctness</a></span> <span class="id">e</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Lang.NNRCEq.html#nnrc_eq">nnrc_eq</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#head_rew">head_rew</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>) <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2559')">Proof.</div>
<div class="proofscript" id="proof2559">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#head_rew">head_rew</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCRewrite.html#nnrc_unshadow_preserves">nnrc_unshadow_preserves</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="rewriter_simpl_rew_no_free_var">rewriter_simpl_rew_no_free_var</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">op</span> : <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) (<span class="id">x</span> : <span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#x">x</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRCShadow.html#nnrc_free_vars">nnrc_free_vars</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#head_rew">head_rew</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#op">op</a></span>)) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#x">x</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRCShadow.html#nnrc_free_vars">nnrc_free_vars</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#op">op</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2560')">Proof.</div>
<div class="proofscript" id="proof2560">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#head_rew">head_rew</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCRewrite.html#unshadow_free_vars">unshadow_free_vars</a></span>; <span class="tactic">eapply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#NNRCOptimizer.engine">engine</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">tcorrectness_prover</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">repeat</span> <span class="tactic">progress</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">try</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id">context</span> [<span class="kwd">match</span> ?<span class="id">p</span> <span class="kwd">with</span> | <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span>] ] =&gt; <span class="tactic">destruct</span> <span class="id">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Equivalence.html#equiv">Equivalence.equiv</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">subst</span>).<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">tprove_correctness</span> <span class="id">p</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">p</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tcorrectness_prover</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tnnrc_rewrites_to_trans">tnnrc_rewrites_to_trans</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} <span class="id">e1</span> <span class="id">e2</span> <span class="id">e3</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e1">e1</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e2">e2</a></span> -&gt; <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e2">e2</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e3">e3</a></span> -&gt; <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e1">e1</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e3">e3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2561')">Proof.</div>
<div class="proofscript" id="proof2561">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="tactic">transitivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="AUX">AUX</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} <span class="id">f</span> <span class="id">e</span> <span class="id">e</span>' :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">e</span>, <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>)) -&gt; <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="id">e</span>' -&gt; <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">e</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2562')">Proof.</div>
<div class="proofscript" id="proof2562">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">e</span>') <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tnnrc_map">tnnrc_map</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} := <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map">nnrc_map</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tnnrc_map_correctness">tnnrc_map_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span> -&gt; <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">p</span>', <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">p</span>' (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">p</span>')) -&gt; <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_map">tnnrc_map</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2563')">Proof.</div>
<div class="proofscript" id="proof2563">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nnrc_cases</span> (<span class="tactic">induction</span> <span class="id">p</span>) <span class="id">Case</span>; <span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">simpl</span>; <span class="tactic">apply</span> <span class="id">Hf</span>]; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">reflexivity</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p1</span>) <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p2</span>) <span class="tactic">at</span> 1; <span class="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p</span>) <span class="tactic">at</span> 1; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p1</span>) <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p2</span>) <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p3</span>) <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p1</span>) <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p2</span>) <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p3</span>) <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p</span>) <span class="tactic">at</span> 1; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tnnrc_map_deep">tnnrc_map_deep</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} := <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map_deep">nnrc_map_deep</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tnnrc_map_deep_correctness">tnnrc_map_deep_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span> -&gt; <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">p</span>', <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">p</span>' (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id">p</span>')) -&gt; <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_map_deep">tnnrc_map_deep</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#f">f</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2564')">Proof.</div>
<div class="proofscript" id="proof2564">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">f</span> <span class="id">p</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nnrc_cases</span> (<span class="tactic">induction</span> <span class="id">p</span>) <span class="id">Case</span>; <span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">simpl</span>; <span class="tactic">apply</span> <span class="id">Hf</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">rewrite</span> <span class="id">IHp1</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">IHp2</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">Hf</span> <span class="tactic">at</span> 1; <span class="tactic">reflexivity</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">rewrite</span> <span class="id">IHp</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">Hf</span> <span class="tactic">at</span> 1; <span class="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHp1</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">IHp2</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">IHp3</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">Hf</span> <span class="tactic">at</span> 1; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHp1</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">IHp2</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">IHp3</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">Hf</span> <span class="tactic">at</span> 1; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tunshadow_preserves_fun">tunshadow_preserves_fun</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Lang.NNRCShadow.html#unshadow_simpl">unshadow_simpl</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tunshadow_preserves_fun_correctness">tunshadow_preserves_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunshadow_preserves_fun">tunshadow_preserves_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2565')">Proof.</div>
<div class="proofscript" id="proof2565">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunshadow_preserves_fun">tunshadow_preserves_fun</a></span>, <span class="id"><a href="Qcert.NNRC.Lang.NNRCShadow.html#unshadow_simpl">unshadow_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tunshadow_preserves_arrow">tunshadow_preserves_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tunshadow_preserves_step">tunshadow_preserves_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">unshadow</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Renames</span> <span class="id">variables</span> <span class="id">to</span> <span class="id">avoid</span> <span class="id">shadowing</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tunshadow_preserves_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunshadow_preserves_fun">tunshadow_preserves_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tunshadow_preserves_step_correct">tunshadow_preserves_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunshadow_preserves_step">tunshadow_preserves_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunshadow_preserves_fun_correctness">tunshadow_preserves_fun_correctness</a></span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_nil_fun">tfor_nil_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">x</span> ‵{||} <span class="id">e2</span> =&gt; ‵{||}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tfor_nil_fun_correctness">tfor_nil_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_nil_fun">tfor_nil_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2566')">Proof.</div>
<div class="proofscript" id="proof2566">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tfor_nil_arrow">tfor_nil_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_nil_step">tfor_nil_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="kwd">for</span>/<span class="id">nil</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Remove</span> <span class="id">loop</span> <span class="id">comprehensions</span> <span class="id">over</span> <span class="id">empty</span> <span class="id">bags</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tfor_nil_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_nil_fun">tfor_nil_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_nil_step_correct">tfor_nil_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_nil_step">tfor_nil_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_nil_fun_correctness">tfor_nil_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_singleton_to_let_fun">tfor_singleton_to_let_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">x</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AColl">AColl</a></span> <span class="id">e1</span>) <span class="id">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AColl">AColl</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id">x</span> <span class="id">e1</span> <span class="id">e2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tfor_singleton_to_let_fun_correctness">tfor_singleton_to_let_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_singleton_to_let_fun">tfor_singleton_to_let_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2567')">Proof.</div>
<div class="proofscript" id="proof2567">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tfor_singleton_to_let_arrow">tfor_singleton_to_let_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_singleton_to_let_step">tfor_singleton_to_let_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="kwd">for</span>/<span class="id">singleton</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Lower</span> <span class="id">a</span> <span class="id">loop</span> <span class="id">comprehension</span> <span class="id">over</span> <span class="id">a</span> <span class="id">singleton</span> <span class="id">into</span> <span class="id">a</span> <span class="id">singleton</span> <span class="id">of</span> <span class="id">a</span> <span class="kwd">let</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tfor_singleton_to_let_step</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_singleton_to_let_fun">tfor_singleton_to_let_fun</a></span> .<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_singleton_to_let_step_correct">tfor_singleton_to_let_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_singleton_to_let_step">tfor_singleton_to_let_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_singleton_to_let_fun_correctness">tfor_singleton_to_let_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tflatten_singleton_fun">tflatten_singleton_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ♯<span class="id">flatten</span>(‵{| <span class="id">e1</span> |}) =&gt; <span class="id">e1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tflatten_singleton_fun_correctness">tflatten_singleton_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_singleton_fun">tflatten_singleton_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2568')">Proof.</div>
<div class="proofscript" id="proof2568">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tflatten_singleton_nnrc_arrow">tflatten_singleton_nnrc_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tflatten_singleton_step">tflatten_singleton_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">flatten</span>/<span class="id">singleton</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">a</span> <span class="id">flatten</span> <span class="id">of</span> <span class="id">a</span> <span class="id">singleton</span> <span class="id">bag</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tflatten_singleton_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_singleton_fun">tflatten_singleton_fun</a></span> .<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tflatten_singleton_step_correct">tflatten_singleton_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_singleton_step">tflatten_singleton_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_singleton_fun_correctness">tflatten_singleton_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tflatten_nil_fun">tflatten_nil_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ♯<span class="id">flatten</span>(‵{||}) =&gt; ‵{||}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tflatten_nil_fun_correctness">tflatten_nil_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_nil_fun">tflatten_nil_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2569')">Proof.</div>
<div class="proofscript" id="proof2569">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tflatten_nil_nnrc_arrow">tflatten_nil_nnrc_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tflatten_nil_step">tflatten_nil_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">flatten</span>/<span class="id">nil</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">flatten</span> <span class="id">of</span> <span class="id">an</span> <span class="id">empty</span> <span class="id">bag</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tflatten_nil_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_nil_fun">tflatten_nil_fun</a></span> .<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tflatten_nil_step_correct">tflatten_nil_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_nil_step">tflatten_nil_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_nil_fun_correctness">tflatten_nil_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tsigma_to_if_fun">tsigma_to_if_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AFlatten">AFlatten</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v1</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AColl">AColl</a></span> <span class="id">e2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AColl">AColl</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id">v2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Common.Data.RData.html#dcoll">dcoll</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>))))) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id">v1</span> == <span class="id">v2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id">v1</span> <span class="id">e2</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e1</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AColl">AColl</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id">v1</span>)) (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Common.Data.RData.html#dcoll">dcoll</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tsigma_to_if_fun_correctness">tsigma_to_if_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tsigma_to_if_fun">tsigma_to_if_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2570')">Proof.</div>
<div class="proofscript" id="proof2570">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tsigma_to_if_arrow">tsigma_to_if_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tsigma_to_if_step">tsigma_to_if_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">sigma</span>/<span class="kwd">if</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"???" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tsigma_to_if_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tsigma_to_if_fun">tsigma_to_if_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tsigma_to_if_step_correct">tsigma_to_if_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tsigma_to_if_step">tsigma_to_if_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tsigma_to_if_fun_correctness">tsigma_to_if_fun_correctness</a></span>.<br/>
&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tmap_sigma_fusion_samevar_fun">tmap_sigma_fusion_samevar_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v2</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AFlatten">AFlatten</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v1</span> <span class="id">e1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e2</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AColl">AColl</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id">v1</span>')) (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Common.Data.RData.html#dcoll">dcoll</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">e3</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id">v1</span> == <span class="id">v1</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id">v1</span> == <span class="id">v2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AFlatten">AFlatten</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v1</span> <span class="id">e1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AColl">AColl</a></span> <span class="id">e3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Common.Data.RData.html#dcoll">dcoll</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tmap_sigma_fusion_samevar_fun_correctness">tmap_sigma_fusion_samevar_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmap_sigma_fusion_samevar_fun">tmap_sigma_fusion_samevar_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2571')">Proof.</div>
<div class="proofscript" id="proof2571">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tmap_sigma_fusion_samevar_arrow">tmap_sigma_fusion_samevar_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tmap_sigma_fusion_samevar_step">tmap_sigma_fusion_samevar_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">sigma</span>/<span class="id">same</span> <span class="id">var</span> <span class="id">fusion</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"???" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tmap_sigma_fusion_samevar_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmap_sigma_fusion_samevar_fun">tmap_sigma_fusion_samevar_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tmap_sigma_fusion_samevar_step_correct">tmap_sigma_fusion_samevar_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmap_sigma_fusion_samevar_step">tmap_sigma_fusion_samevar_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmap_sigma_fusion_samevar_fun_correctness">tmap_sigma_fusion_samevar_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tdot_of_rec_fun">tdot_of_rec_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ADot">ADot</a></span> <span class="id">s1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARec">ARec</a></span> <span class="id">s2</span>) <span class="id">e1</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id">s1</span> == <span class="id">s2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id">e1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tdot_of_rec_fun_correctness">tdot_of_rec_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_rec_fun">tdot_of_rec_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2572')">Proof.</div>
<div class="proofscript" id="proof2572">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tdot_of_rec">tdot_of_rec</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tdot_of_rec_step">tdot_of_rec_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">dot</span>/<span class="id">rec</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">lookup</span> <span class="id">of</span> <span class="id">a</span> <span class="id">new</span> <span class="id">record</span> <span class="id">constructor</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tdot_of_rec_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_rec_fun">tdot_of_rec_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tdot_of_rec_step_correct">tdot_of_rec_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_rec_step">tdot_of_rec_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_rec_fun_correctness">tdot_of_rec_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tmerge_concat_to_concat_fun">tmerge_concat_to_concat_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (‵[| (<span class="id">s1</span>, <span class="id">p1</span>)|] ⊗ ‵[| (<span class="id">s2</span>, <span class="id">p2</span>)|])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="kwd">if</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_decb">equiv_decb</a></span> <span class="id">s1</span> <span class="id">s2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> (‵{|‵[| (<span class="id">s1</span>, <span class="id">p1</span>)|] ⊕ ‵[| (<span class="id">s2</span>, <span class="id">p2</span>)|]|})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tmerge_concat_to_concat_fun_correctness">tmerge_concat_to_concat_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_concat_to_concat_fun">tmerge_concat_to_concat_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2573')">Proof.</div>
<div class="proofscript" id="proof2573">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e1</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">u</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e2</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">u</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_decb">equiv_decb</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">s</span> <span class="id">s0</span>); <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrc_merge_concat_to_concat_arrow">tnnrc_merge_concat_to_concat_arrow</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tmerge_concat_to_concat_step">tmerge_concat_to_concat_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">merge</span>-<span class="id">concat</span>-&gt;<span class="id">merge</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">a</span> <span class="id">merge</span>-<span class="id">concat</span> <span class="id">of</span> <span class="id">two</span> <span class="id">singleton</span> <span class="id">records</span> <span class="kwd">with</span> <span class="id">different</span> <span class="id">fields</span> <span class="kwd">using</span> <span class="id">concat</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tmerge_concat_to_concat_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_concat_to_concat_fun">tmerge_concat_to_concat_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tmerge_concat_to_concat_step_correct">tmerge_concat_to_concat_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_concat_to_concat_step">tmerge_concat_to_concat_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_concat_to_concat_fun_correctness">tmerge_concat_to_concat_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tdot_of_concat_rec_fun">tdot_of_concat_rec_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ADot">ADot</a></span> <span class="id">s</span>) (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#AConcat">AConcat</a></span> <span class="id">e1</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARec">ARec</a></span> <span class="id">s2</span>) <span class="id">e2</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_decb">equiv_decb</a></span> <span class="id">s</span> <span class="id">s2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ADot">ADot</a></span> <span class="id">s</span>) <span class="id">e1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tdot_of_concat_rec_fun_correctness">tdot_of_concat_rec_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_concat_rec_fun">tdot_of_concat_rec_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2574')">Proof.</div>
<div class="proofscript" id="proof2574">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">u</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e2</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">u</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_decb">equiv_decb</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">s</span> <span class="id">s0</span>); <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrc_dot_of_concat_rec_eq_arrow">tnnrc_dot_of_concat_rec_eq_arrow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrc_dot_of_concat_rec_neq_arrow">tnnrc_dot_of_concat_rec_neq_arrow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tdot_of_concat_rec_step">tdot_of_concat_rec_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">dot</span>/<span class="id">concat</span>/<span class="id">rec</span> 2" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplifies</span> <span class="id">lookup</span> <span class="id">of</span> <span class="id">a</span> <span class="id">concatenation</span> <span class="kwd">with</span> <span class="id">a</span> <span class="id">record</span> <span class="id">constructor</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tdot_of_concat_rec_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_concat_rec_fun">tdot_of_concat_rec_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tdot_of_concat_rec_step_correct">tdot_of_concat_rec_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_concat_rec_step">tdot_of_concat_rec_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_concat_rec_fun_correctness">tdot_of_concat_rec_fun_correctness</a></span>.<br/>
<br/>
<div class="doc">Inlining </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="is_small_unop">is_small_unop</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">u</span>:<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#unaryOp">unaryOp</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#u">u</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AIdOp">AIdOp</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ANeg">ANeg</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AColl">AColl</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ALeft">ALeft</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARight">ARight</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ABrand">ABrand</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARec">ARec</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="should_inline_small">should_inline_small</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">from</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#from">from</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">u</span> <span class="id">e</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#is_small_unop">is_small_unop</a></span> <span class="id">u</span> &amp;&amp; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#should_inline_small">should_inline_small</a></span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#AConcat">AConcat</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARec">ARec</a></span> <span class="id">_</span>) <span class="id">e1</span>) (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARec">ARec</a></span> <span class="id">_</span>) <span class="id">e2</span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="should_inline_few_occurences">should_inline_few_occurences</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">x</span>:<span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) (<span class="id">to</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCRewriteUtil.html#use_count">use_count</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#x">x</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#to">to</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.NNRC.Optim.NNRCRewriteUtil.html#NotUsed">NotUsed</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.NNRC.Optim.NNRCRewriteUtil.html#UsedOnce">UsedOnce</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="should_inline">should_inline</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">x</span>:<span class="id"><a href="Qcert.Common.Env.RVar.html#var">var</a></span>) (<span class="id">from</span> <span class="id">to</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#should_inline_small">should_inline_small</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#from">from</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#should_inline_few_occurences">should_inline_few_occurences</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#x">x</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#to">to</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tinline_let_fun">tinline_let_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id">x</span> <span class="id">e1</span> <span class="id">e2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#should_inline">should_inline</a></span> <span class="id">x</span> <span class="id">e1</span> <span class="id">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Qcert.cNNRC.Lang.cNNRCShadow.html#nnrc_subst">nnrc_subst</a></span> (<span class="id"><a href="Qcert.NNRC.Lang.NNRCShadow.html#unshadow_simpl">unshadow_simpl</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRCShadow.html#nnrc_free_vars">nnrc_free_vars</a></span> <span class="id">e1</span>) <span class="id">e2</span>) <span class="id">x</span> <span class="id">e1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tinline_let_fun_correctness">tinline_let_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tinline_let_fun">tinline_let_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2575')">Proof.</div>
<div class="proofscript" id="proof2575">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tlet_inline_arrow">tlet_inline_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tinline_let_step">tinline_let_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="kwd">let</span> <span class="id">inline</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="kwd">Inline</span> <span class="kwd">let</span> <span class="id">statements</span> <span class="id">heuristically</span> <span class="id">deemed</span> <span class="id">suitable</span> <span class="kwd">for</span> <span class="id">inlining</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tinline_let_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tinline_let_fun">tinline_let_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tinline_let_step_correct">tinline_let_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tinline_let_step">tinline_let_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tinline_let_fun_correctness">tinline_let_fun_correctness</a></span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_over_if_nil_fun">tfor_over_if_nil_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">x</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e1</span> <span class="id">e2</span> ‵{||}) <span class="id">ebody</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e1</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">x</span> <span class="id">e2</span> <span class="id">ebody</span>) ‵{||})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tfor_over_if_nil_fun_correctness">tfor_over_if_nil_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_if_nil_fun">tfor_over_if_nil_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2576')">Proof.</div>
<div class="proofscript" id="proof2576">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tfor_over_if_arrow">tfor_over_if_arrow</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tfor_nil_arrow">tfor_nil_arrow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_over_if_nil_step">tfor_over_if_nil_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="kwd">for</span>/<span class="kwd">if</span>/<span class="kwd">else</span> <span class="id">nil</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Push</span> <span class="id">loop</span> <span class="id">comprehension</span> <span class="id">over</span> <span class="id">an</span> <span class="kwd">if</span> <span class="id">statement</span> <span class="id">through</span> <span class="id">the</span> <span class="kwd">if</span> <span class="id">statement</span> <span class="id">when</span> <span class="id">the</span> <span class="kwd">else</span> <span class="id">clause</span> <span class="id">just</span> <span class="id">constructs</span> <span class="id">an</span> <span class="id">empty</span> <span class="id">bag</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tfor_over_if_nil_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_if_nil_fun">tfor_over_if_nil_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_over_if_nil_step_correct">tfor_over_if_nil_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_if_nil_step">tfor_over_if_nil_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_if_nil_fun_correctness">tfor_over_if_nil_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_over_either_nil_fun">tfor_over_either_nil_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|  (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">x</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e1</span> <span class="id">xl</span> <span class="id">el</span> <span class="id">xr</span> ‵{||}) <span class="id">ebody</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(    <span class="kwd">let</span> <span class="id">xl</span>' := <span class="id"><a href="Qcert.cNNRC.Lang.cNNRCShadow.html#really_fresh_in">really_fresh_in</a></span> <span class="id"><a href="Qcert.NNRC.Lang.NNRCShadow.html#nnrc_unshadow_sep">nnrc_unshadow_sep</a></span> <span class="id">xl</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRCShadow.html#nnrc_free_vars">nnrc_free_vars</a></span> <span class="id">el</span> ++ <span class="id"><a href="Qcert.cNNRC.Lang.cNNRCShadow.html#nnrc_bound_vars">nnrc_bound_vars</a></span> <span class="id">el</span>) <span class="id">ebody</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xl</span>' (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">x</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRCShadow.html#nnrc_subst">nnrc_subst</a></span> <span class="id">el</span> <span class="id">xl</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id">xl</span>')) <span class="id">ebody</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xr</span> ‵{||}))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tfor_over_either_nil_fun_correctness">tfor_over_either_nil_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_either_nil_fun">tfor_over_either_nil_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2577')">Proof.</div>
<div class="proofscript" id="proof2577">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tfor_over_either_arrow">tfor_over_either_arrow</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tfor_nil_arrow">tfor_nil_arrow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrceither_rename_r_arrow">tnnrceither_rename_r_arrow</a></span> <span class="tactic">by</span> <span class="tactic">intuition</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_over_either_nil_step">tfor_over_either_nil_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="kwd">for</span>/<span class="id">either</span>/<span class="id">right</span> <span class="id">nil</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Push</span> <span class="id">loop</span> <span class="id">comprehension</span> <span class="id">over</span> <span class="id">an</span> <span class="id">either</span> <span class="id">statement</span> <span class="id">through</span> <span class="id">the</span> <span class="id">either</span> <span class="id">statement</span> <span class="id">when</span> <span class="id">the</span> <span class="id">right</span> <span class="id">clause</span> <span class="id">just</span> <span class="id">constructs</span> <span class="id">an</span> <span class="id">empty</span> <span class="id">bag</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tfor_over_either_nil_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_either_nil_fun">tfor_over_either_nil_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_over_either_nil_step_correct">tfor_over_either_nil_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_either_nil_step">tfor_over_either_nil_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_either_nil_fun_correctness">tfor_over_either_nil_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tunop_over_either_const_fun">tunop_over_either_const_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">op</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e1</span> <span class="id">xl</span> <span class="id">el</span> <span class="id">xr</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e1</span> <span class="id">xl</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">op</span> <span class="id">el</span>) <span class="id">xr</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">op</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tunop_over_either_const_fun_correctness">tunop_over_either_const_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_either_const_fun">tunop_over_either_const_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2578')">Proof.</div>
<div class="proofscript" id="proof2578">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcunop_over_either_arrow">tnnrcunop_over_either_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tunop_over_either_const_step">tunop_over_either_const_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">unary</span>/<span class="id">either</span>/<span class="id">right</span> <span class="id">const</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Push</span> <span class="id">unary</span> <span class="id">operators</span> <span class="id">through</span> <span class="id">either</span> <span class="id">when</span> <span class="id">the</span> <span class="id">right</span> <span class="id">branch</span> <span class="id">is</span> <span class="id">a</span> <span class="id">constant</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tunop_over_either_const_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_either_const_fun">tunop_over_either_const_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tunop_over_either_const_step_correct">tunop_over_either_const_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_either_const_step">tunop_over_either_const_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_either_const_fun_correctness">tunop_over_either_const_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tunop_over_if_const_fun">tunop_over_if_const_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">op</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e1</span> <span class="id">e2</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e1</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">op</span> <span class="id">e2</span>) (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">op</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tunop_over_if_const_fun_correctness">tunop_over_if_const_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_if_const_fun">tunop_over_if_const_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2579')">Proof.</div>
<div class="proofscript" id="proof2579">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcunop_over_if_arrow">tnnrcunop_over_if_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tunop_over_if_const_step">tunop_over_if_const_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">unary</span>/<span class="kwd">if</span>/<span class="kwd">else</span> <span class="id">const</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Push</span> <span class="id">unary</span> <span class="id">operators</span> <span class="id">through</span> <span class="kwd">if</span> <span class="id">when</span> <span class="id">the</span> <span class="kwd">else</span> <span class="id">branch</span> <span class="id">is</span> <span class="id">a</span> <span class="id">constant</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tunop_over_if_const_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_if_const_fun">tunop_over_if_const_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tunop_over_if_const_step_correct">tunop_over_if_const_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_if_const_step">tunop_over_if_const_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_if_const_fun_correctness">tunop_over_if_const_fun_correctness</a></span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_nil_fun">tproject_nil_fun</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARecProject">ARecProject</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">e</span>₁<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Common.Data.RData.html#drec">drec</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_nil_fun_correctness">tproject_nil_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} <span class="id">p</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span> ⇒ᶜ <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_nil_fun">tproject_nil_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2580')">Proof.</div>
<div class="proofscript" id="proof2580">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcproject_nil">tnnrcproject_nil</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Rewrite</span> @<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_nil_fun_correctness">tproject_nil_fun_correctness</a></span> : <span class="id">toptim_correct</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_nil_step">tproject_nil_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">project</span>/<span class="id">nil</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">record</span> <span class="id">projection</span> <span class="id">over</span> <span class="id">empty</span> <span class="id">bags</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tproject_nil_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_nil_fun">tproject_nil_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_nil_step_correct">tproject_nil_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_nil_step">tproject_nil_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_nil_fun_correctness">tproject_nil_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_const_fun">tproject_over_const_fun</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARecProject">ARecProject</a></span> <span class="id">sl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Common.Data.RData.html#drec">drec</a></span> <span class="id">l</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Common.Data.RData.html#drec">drec</a></span> (<span class="id"><a href="Qcert.Common.Data.RRelation.html#rproject">rproject</a></span> <span class="id">l</span> <span class="id">sl</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_const_fun_correctness">tproject_over_const_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} <span class="id">p</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span> ⇒ᶜ <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_const_fun">tproject_over_const_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2581')">Proof.</div>
<div class="proofscript" id="proof2581">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcproject_over_const">tnnrcproject_over_const</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Rewrite</span> @<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_const_fun_correctness">tproject_over_const_fun_correctness</a></span> : <span class="id">toptim_correct</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_const_step">tproject_over_const_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">project</span>/<span class="id">const</span> <span class="id">rec</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">record</span> <span class="id">projection</span> <span class="id">over</span> <span class="id">constant</span> <span class="id">records</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tproject_over_const_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_const_fun">tproject_over_const_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_const_step_correct">tproject_over_const_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_const_step">tproject_over_const_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_const_fun_correctness">tproject_over_const_fun_correctness</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_rec_fun">tproject_over_rec_fun</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARecProject">ARecProject</a></span> <span class="id">sl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARec">ARec</a></span> <span class="id">s</span>) <span class="id">p</span>₁)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">s</span> <span class="id">sl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARec">ARec</a></span> <span class="id">s</span>) <span class="id">p</span>₁<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> ‵[||]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_rec_fun_correctness">tproject_over_rec_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} <span class="id">p</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span> ⇒ᶜ <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_rec_fun">tproject_over_rec_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2582')">Proof.</div>
<div class="proofscript" id="proof2582">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcproject_over_rec_in">tnnrcproject_over_rec_in</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcproject_over_rec_nin">tnnrcproject_over_rec_nin</a></span>; <span class="tactic">trivial</span>. <br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Rewrite</span> @<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_rec_fun_correctness">tproject_over_rec_fun_correctness</a></span> : <span class="id">toptim_correct</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_rec_step">tproject_over_rec_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">project</span>/<span class="id">rec</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">record</span> <span class="id">projection</span> <span class="id">over</span> <span class="id">a</span> <span class="id">record</span> <span class="id">constructor</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tproject_over_rec_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_rec_fun">tproject_over_rec_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_rec_step_correct">tproject_over_rec_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_rec_step">tproject_over_rec_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_rec_fun_correctness">tproject_over_rec_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_concat_r_fun">tproject_over_concat_r_fun</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARecProject">ARecProject</a></span> <span class="id">sl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#AConcat">AConcat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">p</span>₁ (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARec">ARec</a></span> <span class="id">s</span>) <span class="id">p</span>₂))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">s</span> <span class="id">sl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#AConcat">AConcat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARecProject">ARecProject</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#remove">remove</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">s</span> <span class="id">sl</span>)) <span class="id">p</span>₁)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARec">ARec</a></span> <span class="id">s</span>) <span class="id">p</span>₂)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARecProject">ARecProject</a></span> <span class="id">sl</span>) <span class="id">p</span>₁)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_concat_r_fun_correctness">tproject_over_concat_r_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} <span class="id">p</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span> ⇒ᶜ <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_r_fun">tproject_over_concat_r_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2583')">Proof.</div>
<div class="proofscript" id="proof2583">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcproject_over_concat_rec_r_in">tnnrcproject_over_concat_rec_r_in</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcproject_over_concat_rec_r_nin">tnnrcproject_over_concat_rec_r_nin</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Rewrite</span> @<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_r_fun_correctness">tproject_over_concat_r_fun_correctness</a></span> : <span class="id">toptim_correct</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_concat_r_step">tproject_over_concat_r_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">project</span>/<span class="id">concat</span>/<span class="id">right</span> <span class="id">rec</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">record</span> <span class="id">projection</span> <span class="id">over</span> <span class="id">concatenation</span> <span class="kwd">with</span> <span class="id">a</span> <span class="id">record</span> <span class="id">constructor</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tproject_over_concat_r_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_r_fun">tproject_over_concat_r_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_concat_r_step_correct">tproject_over_concat_r_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_r_step">tproject_over_concat_r_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_r_fun_correctness">tproject_over_concat_r_fun_correctness</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_concat_l_fun">tproject_over_concat_l_fun</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARecProject">ARecProject</a></span> <span class="id">sl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#AConcat">AConcat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARec">ARec</a></span> <span class="id">s</span>) <span class="id">p</span>₁) <span class="id">p</span>₂)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">s</span> <span class="id">sl</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARecProject">ARecProject</a></span> <span class="id">sl</span>) <span class="id">p</span>₂)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_concat_l_fun_correctness">tproject_over_concat_l_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} <span class="id">p</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span> ⇒ᶜ <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_l_fun">tproject_over_concat_l_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2584')">Proof.</div>
<div class="proofscript" id="proof2584">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcproject_over_concat_rec_l_nin">tnnrcproject_over_concat_rec_l_nin</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Rewrite</span> @<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_l_fun_correctness">tproject_over_concat_l_fun_correctness</a></span> : <span class="id">toptim_correct</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_concat_l_step">tproject_over_concat_l_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">project</span>/<span class="id">concat</span>/<span class="id">left</span> <span class="id">rec</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">record</span> <span class="id">projection</span> <span class="id">over</span> <span class="id">concatenation</span> <span class="kwd">with</span> <span class="id">a</span> <span class="id">record</span> <span class="id">constructor</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tproject_over_concat_l_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_l_fun">tproject_over_concat_l_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_concat_l_step_correct">tproject_over_concat_l_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_l_step">tproject_over_concat_l_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_l_fun_correctness">tproject_over_concat_l_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_project_fun">tproject_over_project_fun</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARecProject">ARecProject</a></span> <span class="id">sl1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARecProject">ARecProject</a></span> <span class="id">sl2</span>) <span class="id">p1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARecProject">ARecProject</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.ListSet.html#set_inter">set_inter</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">sl2</span> <span class="id">sl1</span>)) <span class="id">p1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_project_fun_correctness">tproject_over_project_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} <span class="id">p</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span> ⇒ᶜ <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_project_fun">tproject_over_project_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2585')">Proof.</div>
<div class="proofscript" id="proof2585">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcproject_over_nnrcproject">tnnrcproject_over_nnrcproject</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Rewrite</span> @<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_project_fun_correctness">tproject_over_project_fun_correctness</a></span> : <span class="id">toptim_correct</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_project_step">tproject_over_project_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">project</span>/<span class="id">project</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Fuse</span> <span class="id">nested</span> <span class="id">record</span> <span class="id">projections</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tproject_over_project_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_project_fun">tproject_over_project_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_project_step_correct">tproject_over_project_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_project_step">tproject_over_project_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_project_fun_correctness">tproject_over_project_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_either_fun">tproject_over_either_fun</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARecProject">ARecProject</a></span> <span class="id">sl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">p</span> <span class="id">xl</span> <span class="id">p</span>₁ <span class="id">xr</span> <span class="id">p</span>₂)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">p</span> <span class="id">xl</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARecProject">ARecProject</a></span> <span class="id">sl</span>) <span class="id">p</span>₁) <span class="id">xr</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARecProject">ARecProject</a></span> <span class="id">sl</span>) <span class="id">p</span>₂)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_either_fun_correctness">tproject_over_either_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} <span class="id">p</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span> ⇒ᶜ <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_either_fun">tproject_over_either_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2586')">Proof.</div>
<div class="proofscript" id="proof2586">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcproject_over_either">tnnrcproject_over_either</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Rewrite</span> @<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_either_fun_correctness">tproject_over_either_fun_correctness</a></span> : <span class="id">toptim_correct</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_either_step">tproject_over_either_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">project</span>/<span class="id">either</span>/" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Push</span> <span class="id">record</span> <span class="id">projection</span> <span class="id">through</span> <span class="id">either</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tproject_over_either_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_either_fun">tproject_over_either_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_either_step_correct">tproject_over_either_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_either_step">tproject_over_either_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_either_fun_correctness">tproject_over_either_fun_correctness</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tcount_over_flat_for_either_if_nil_fun">tcount_over_flat_for_either_if_nil_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (♯<span class="id">count</span>(♯<span class="id">flatten</span>(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ehead</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e1</span> <span class="id">xl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e11</span>(‵{| <span class="id">e12</span>|}) ‵{||}) <span class="id">xr</span> ‵{||}))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; (♯<span class="id">count</span>(♯<span class="id">flatten</span>(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ehead</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e1</span> <span class="id">xl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e11</span>(‵{| ‵(<span class="id"><a href="Qcert.Common.Data.RData.html#dunit">dunit</a></span>) |}) ‵{||}) <span class="id">xr</span> ‵{||}))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tcount_over_flat_for_either_if_nil_fun_correctness">tcount_over_flat_for_either_if_nil_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_if_nil_fun">tcount_over_flat_for_either_if_nil_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2587')">Proof.</div>
<div class="proofscript" id="proof2587">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">match_destr</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tcount_over_flat_for_either_if_nil_arrow">tcount_over_flat_for_either_if_nil_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tcount_over_flat_for_either_if_nil_step">tcount_over_flat_for_either_if_nil_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">count</span>/<span class="id">flatten</span>/<span class="kwd">for</span>/<span class="id">either</span>/<span class="id">right</span> <span class="kwd">if</span>/<span class="kwd">else</span> <span class="id">nil</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Remove</span> <span class="id">work</span> <span class="id">that</span> <span class="id">is</span> <span class="id">not</span> <span class="id">needed</span> <span class="id">when</span> <span class="id">only</span> <span class="id">the</span> <span class="id">bag</span> <span class="id">count</span> <span class="id">is</span> <span class="id">needed</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tcount_over_flat_for_either_if_nil_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_if_nil_fun">tcount_over_flat_for_either_if_nil_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tcount_over_flat_for_either_if_nil_step_correct">tcount_over_flat_for_either_if_nil_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_if_nil_step">tcount_over_flat_for_either_if_nil_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_if_nil_fun_correctness">tcount_over_flat_for_either_if_nil_fun_correctness</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tcount_over_flat_for_either_either_nil_fun">tcount_over_flat_for_either_either_nil_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (♯<span class="id">count</span>(♯<span class="id">flatten</span>(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ehead</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e1</span> <span class="id">xl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e11</span> <span class="id">xll</span> (‵{| <span class="id">e12</span>|}) <span class="id">xrr</span> ‵{||}) <span class="id">xr</span> ‵{||}))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; (♯<span class="id">count</span>(♯<span class="id">flatten</span>(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ehead</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e1</span> <span class="id">xl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e11</span> <span class="id">xll</span> (‵{| ‵(<span class="id"><a href="Qcert.Common.Data.RData.html#dunit">dunit</a></span>) |}) <span class="id">xrr</span> ‵{||}) <span class="id">xr</span> ‵{||}))))<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tcount_over_flat_for_either_either_nil_fun_correctness">tcount_over_flat_for_either_either_nil_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_either_nil_fun">tcount_over_flat_for_either_either_nil_fun</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2588')">Proof.</div>
<div class="proofscript" id="proof2588">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">match_destr</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tcount_over_flat_for_either_either_nil_arrow">tcount_over_flat_for_either_either_nil_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tcount_over_flat_for_either_either_nil_step">tcount_over_flat_for_either_either_nil_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">count</span>/<span class="id">flatten</span>/<span class="kwd">for</span>/<span class="id">either</span>/<span class="id">right</span> <span class="id">either</span>/<span class="id">right</span> <span class="id">nil</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Remove</span> <span class="id">work</span> <span class="id">that</span> <span class="id">is</span> <span class="id">not</span> <span class="id">needed</span> <span class="id">when</span> <span class="id">only</span> <span class="id">the</span> <span class="id">bag</span> <span class="id">count</span> <span class="id">is</span> <span class="id">needed</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tcount_over_flat_for_either_either_nil_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_either_nil_fun">tcount_over_flat_for_either_either_nil_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tcount_over_flat_for_either_either_nil_step_correct">tcount_over_flat_for_either_either_nil_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_either_nil_step">tcount_over_flat_for_either_either_nil_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_either_nil_fun_correctness">tcount_over_flat_for_either_either_nil_fun_correctness</a></span>.  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tnnrc_optim_list">tnnrc_optim_list</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (@<span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#OptimizerStep">OptimizerStep</a></span> <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_nil_step">tfor_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_singleton_to_let_step">tfor_singleton_to_let_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_singleton_step">tflatten_singleton_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_nil_step">tflatten_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tsigma_to_if_step">tsigma_to_if_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmap_sigma_fusion_samevar_step">tmap_sigma_fusion_samevar_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_rec_step">tdot_of_rec_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_concat_to_concat_step">tmerge_concat_to_concat_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_concat_rec_step">tdot_of_concat_rec_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tinline_let_step">tinline_let_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_if_nil_step">tfor_over_if_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_either_nil_step">tfor_over_either_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_either_const_step">tunop_over_either_const_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_if_const_step">tunop_over_if_const_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_nil_step">tproject_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_const_step">tproject_over_const_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_rec_step">tproject_over_rec_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_r_step">tproject_over_concat_r_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_l_step">tproject_over_concat_l_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_project_step">tproject_over_project_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_either_step">tproject_over_either_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_if_nil_step">tcount_over_flat_for_either_if_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_either_nil_step">tcount_over_flat_for_either_either_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tnnrc_optim_model_list">tnnrc_optim_model_list</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#OptimizerStepModel">OptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_nil_step_correct">tfor_nil_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_singleton_to_let_step_correct">tfor_singleton_to_let_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_singleton_step_correct">tflatten_singleton_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_nil_step_correct">tflatten_nil_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tsigma_to_if_step_correct">tsigma_to_if_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmap_sigma_fusion_samevar_step_correct">tmap_sigma_fusion_samevar_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_rec_step_correct">tdot_of_rec_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_concat_to_concat_step_correct">tmerge_concat_to_concat_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_concat_rec_step_correct">tdot_of_concat_rec_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tinline_let_step_correct">tinline_let_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_if_nil_step_correct">tfor_over_if_nil_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_either_nil_step_correct">tfor_over_either_nil_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_either_const_step_correct">tunop_over_either_const_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_if_const_step_correct">tunop_over_if_const_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_nil_step_correct">tproject_nil_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_const_step_correct">tproject_over_const_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_rec_step_correct">tproject_over_rec_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_r_step_correct">tproject_over_concat_r_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_l_step_correct">tproject_over_concat_l_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_project_step_correct">tproject_over_project_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_either_step_correct">tproject_over_either_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_if_nil_step_correct">tcount_over_flat_for_either_if_nil_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_either_nil_step_correct">tcount_over_flat_for_either_either_nil_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tnnrc_optim_model_list_complete">tnnrc_optim_model_list_complete</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_model_list_complete">optim_model_list_complete</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_optim_list">tnnrc_optim_list</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_optim_model_list">tnnrc_optim_model_list</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2589')">Proof.</div>
<div class="proofscript" id="proof2589">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">optim_correct_list_complete_prover</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tnnrc_optim_list_correct">tnnrc_optim_list_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_list_correct">optim_list_correct</a></span> <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_optim_list">tnnrc_optim_list</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_list_correct_from_model">optim_list_correct_from_model</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_optim_model_list_complete">tnnrc_optim_model_list_complete</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tnnrc_optim_list_distinct">tnnrc_optim_list_distinct</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_list_distinct">optim_list_distinct</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_optim_list">tnnrc_optim_list</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2590')">Proof.</div>
<div class="proofscript" id="proof2590">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_list_distinct_prover">optim_list_distinct_prover</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vm_compute</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="run_nnrc_optims">run_nnrc_optims</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">logger</span>:<span class="id"><a href="Qcert.Common.Logger.OptimizerLogger.html#optimizer_logger">optimizer_logger</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">opc</span>:<span class="id"><a href="Qcert.Common.Logger.OptimizerLogger.html#optim_phases_config">optim_phases_config</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span> -&gt; <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Common.Logger.OptimizerLogger.html#run_phases">run_phases</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_map_deep">tnnrc_map_deep</a></span> <span class="id"><a href="Qcert.NNRC.Lang.NNRCSize.html#nnrc_size">NNRCSize.nnrc_size</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_optim_list">tnnrc_optim_list</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#opc">opc</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="run_nnrc_optims_correctness">run_nnrc_optims_correctness</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} {<span class="id">logger</span>:<span class="id"><a href="Qcert.Common.Logger.OptimizerLogger.html#optimizer_logger">optimizer_logger</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">opc</span>:<span class="id"><a href="Qcert.Common.Logger.OptimizerLogger.html#optim_phases_config">optim_phases_config</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">p</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#run_nnrc_optims">run_nnrc_optims</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#opc">opc</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2591')">Proof.</div>
<div class="proofscript" id="proof2591">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#run_nnrc_optims">run_nnrc_optims</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.Common.Logger.OptimizerLogger.html#run_phases_correctness">run_phases_correctness</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_map_deep_correctness">tnnrc_map_deep_correctness</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_optim_list_correct">tnnrc_optim_list_correct</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="NNRCOptimizer.default">default</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="nnrc_default_optim_list">nnrc_default_optim_list</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tinline_let_step">tinline_let_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_either_nil_step">tcount_over_flat_for_either_either_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_if_nil_step">tcount_over_flat_for_either_if_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_concat_to_concat_step">tmerge_concat_to_concat_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_concat_rec_step">tdot_of_concat_rec_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_rec_step">tdot_of_rec_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_singleton_step">tflatten_singleton_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_nil_step">tflatten_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_singleton_to_let_step">tfor_singleton_to_let_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_either_const_step">tunop_over_either_const_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_if_const_step">tunop_over_if_const_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_either_nil_step">tfor_over_either_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_if_nil_step">tfor_over_if_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_nil_step">tfor_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmap_sigma_fusion_samevar_step">tmap_sigma_fusion_samevar_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_nil_step">tproject_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_const_step">tproject_over_const_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_rec_step">tproject_over_rec_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_r_step">tproject_over_concat_r_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_l_step">tproject_over_concat_l_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_project_step">tproject_over_project_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_either_step">tproject_over_either_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Remark</span> <span class="id"><a name="nnrc_default_optim_list_all_valid">nnrc_default_optim_list_all_valid</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="Qcert.Common.Logger.OptimizerStep.html#valid_optims">valid_optims</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_optim_list">tnnrc_optim_list</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_default_optim_list">nnrc_default_optim_list</a></span> = (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_default_optim_list">nnrc_default_optim_list</a></span>,<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2592')">Proof.</div>
<div class="proofscript" id="proof2592">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vm_compute</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="default_nnrc_optim_phases">default_nnrc_optim_phases</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;("[<span class="id">nnrc</span>] <span class="id">default</span>"%<span class="id">string</span>,<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_default_optim_list">nnrc_default_optim_list</a></span>,10)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#NNRCOptimizer.default">default</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="run_nnrc_optims_default">run_nnrc_optims_default</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} {<span class="id">logger</span>:<span class="id"><a href="Qcert.Common.Logger.OptimizerLogger.html#optimizer_logger">optimizer_logger</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#run_nnrc_optims">run_nnrc_optims</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#default_nnrc_optim_phases">default_nnrc_optim_phases</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="run_nnrc_optims_default_correct">run_nnrc_optims_default_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">model</span>:<span class="id"><a href="Qcert.Common.CommonSystem.html#basic_model">basic_model</a></span>} {<span class="id">logger</span>:<span class="id"><a href="Qcert.Common.Logger.OptimizerLogger.html#optimizer_logger">optimizer_logger</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>} <span class="id">p</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#run_nnrc_optims_default">run_nnrc_optims_default</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#p">p</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2593')">Proof.</div>
<div class="proofscript" id="proof2593">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#run_nnrc_optims_default">run_nnrc_optims_default</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#run_nnrc_optims_correctness">run_nnrc_optims_correctness</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#NNRCOptimizer">NNRCOptimizer</a></span>.<br/>
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
