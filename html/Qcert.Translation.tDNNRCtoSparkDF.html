
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Qcert.Translation.tDNNRCtoSparkDF</title>
<meta name="description" content="Documentation of Coq module Qcert.Translation.tDNNRCtoSparkDF" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Qcert.Translation.tDNNRCtoSparkDF</h1>
<div class="coq">
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Helpers">Helpers</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html">String</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="eol">eol</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#String">String</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.Ascii.html#ascii_of_nat">Ascii.ascii_of_nat</a></span> 10) <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#EmptyString">EmptyString</a></span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#Helpers">Helpers</a></span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html">String</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Peano_dec.html">Peano_dec</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html">EquivDec</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.Common.CommonSystem.html">CommonSystem</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.NNRC.NNRCRuntime.html">NNRCRuntime</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.tDNNRC.tDNNRCSystem.html">tDNNRCSystem</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.Translation.ForeignToScala.html">ForeignToScala</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.Translation.DatatoSparkDF.html">DatatoSparkDF</a></span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">string_scope</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="tDNNRCtoSparkDF">tDNNRCtoSparkDF</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">f</span>:<span class="id"><a href="Qcert.Common.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">h</span>:<span class="id"><a href="Qcert.Common.Data.BrandRelation.html#brand_relation_t">brand_relation_t</a></span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">ftype</span>:<span class="id"><a href="Qcert.Common.TypeSystem.ForeignType.html#foreign_type">foreign_type</a></span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">m</span>:<span class="id"><a href="Qcert.Common.TypeSystem.TBrandModel.html#brand_model">brand_model</a></span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">fdtyping</span>:<span class="id"><a href="Qcert.Common.Typing.ForeignDataTyping.html#foreign_data_typing">foreign_data_typing</a></span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">fboptyping</span>:<span class="id"><a href="Qcert.Common.Typing.ForeignOpsTyping.html#foreign_binary_op_typing">foreign_binary_op_typing</a></span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">fuoptyping</span>:<span class="id"><a href="Qcert.Common.Typing.ForeignOpsTyping.html#foreign_unary_op_typing">foreign_unary_op_typing</a></span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">fttjs</span>: <span class="id"><a href="Qcert.Translation.ForeignToJavaScript.html#foreign_to_javascript">ForeignToJavaScript.foreign_to_javascript</a></span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">fts</span>: <span class="id"><a href="Qcert.Translation.ForeignToScala.html#foreign_to_scala">ForeignToScala.foreign_to_scala</a></span>}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="quote_string">quote_string</a></span> (<span class="id">s</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;"""" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#s">s</a></span> ++ """".<br/>
<br/>
<div class="doc">Get code for a Spark DataType corresping to an rtype.
   *
   * These are things like StringType, ArrayType(...), StructType(Seq(FieldType(...), ...)), ...
   *
   * This function encodes details of our data representation, e.g. records are StructFields
   * with two toplevel fields $blob and $known, and the $known contains a record with the
   * statically known fields and their types.
   </div>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="rtype_to_spark_DataType">rtype_to_spark_DataType</a></span> (<span class="id">r</span>: <span class="id">rtype</span>₀) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#r">r</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Bottom</span>₀ =&gt; "<span class="id">NullType</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Top</span>₀ =&gt; "<span class="id">StringType</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Unit</span>₀ =&gt; "<span class="id">NullType</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Nat</span>₀ =&gt; "<span class="id">LongType</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Bool</span>₀ =&gt; "<span class="id">BooleanType</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span>₀ =&gt; "<span class="id">StringType</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Coll</span>₀ <span class="id">e</span> =&gt; "<span class="id">ArrayType</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#rtype_to_spark_DataType">rtype_to_spark_DataType</a></span> <span class="id">e</span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Rec</span>₀ <span class="id">_</span> <span class="id">fields</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">known_fields</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt; "<span class="id">StructField</span>(""" ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#p">p</a></span> ++ """, " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#rtype_to_spark_DataType">rtype_to_spark_DataType</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#p">p</a></span>) ++ ")")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fields</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">known_struct</span> := "<span class="id">StructType</span>(<span class="id">Seq</span>(" ++ <span class="id"><a href="Qcert.Common.Operators.RUtilOps.html#joinStrings">joinStrings</a></span> ", " <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#known_fields">known_fields</a></span> ++ "))" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">StructType</span>(<span class="id">Seq</span>(<span class="id">StructField</span>(""$<span class="id">blob</span>"", <span class="id">StringType</span>), <span class="id">StructField</span>(""$<span class="id">known</span>"", " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#known_struct">known_struct</a></span> ++ ")))"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Either</span>₀ <span class="id">l</span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">StructType</span>(<span class="id">Seq</span>(<span class="id">StructField</span>(""$<span class="id">left</span>"", " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#rtype_to_spark_DataType">rtype_to_spark_DataType</a></span> <span class="id">l</span> ++ "), <span class="id">StructField</span>(""$<span class="id">right</span>"", " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#rtype_to_spark_DataType">rtype_to_spark_DataType</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#r">r</a></span> ++ ")))"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Brand</span>₀ <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">StructType</span>(<span class="id">Seq</span>(<span class="id">StructField</span>(""$<span class="id">data</span>"", <span class="id">StringType</span>), <span class="id">StructField</span>(""$<span class="id">type</span>"", <span class="id">ArrayType</span>(<span class="id">StringType</span>))))"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Arrow</span>₀ <span class="id">_</span> <span class="id">_</span> =&gt; "<span class="id">ARROW</span> <span class="id">TYPE</span>?"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Foreign</span>₀ <span class="id">ft</span> =&gt; <span class="id"><a href="Qcert.Translation.ForeignToScala.html#foreign_to_scala_spark_datatype">foreign_to_scala_spark_datatype</a></span> <span class="id">ft</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Scala-level type of an rtype.
   *
   * These are things like Long, String, Boolean, Array<span class="bracket">...</span>, Row.
   *
   * We need to annotate some expressions with Scala-level types
   * (e.g. Array<span class="bracket"><span class="id">Row</span></span>() for an empty Array of Records) to help
   * the Scala compiler because it does not infer types everywhere.
   </div>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="rtype_to_scala_type">rtype_to_scala_type</a></span> (<span class="id">t</span>: <span class="id">rtype</span>₀): <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#t">t</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Bottom</span>₀ =&gt; "<span class="id">BOTTOM</span>?"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Top</span>₀ =&gt; "<span class="id">TOP</span>?"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Unit</span>₀ =&gt; "<span class="id">Unit</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Nat</span>₀ =&gt; "<span class="id">Long</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Bool</span>₀ =&gt; "<span class="id">Boolean</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span>₀ =&gt; "<span class="id">String</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Coll</span>₀ <span class="id">r</span> =&gt; "<span class="id">Array</span>[" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#rtype_to_scala_type">rtype_to_scala_type</a></span> <span class="id">r</span> ++ "]"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Rec</span>₀ <span class="id">_</span> <span class="id">_</span> =&gt; "<span class="kwd">Record</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Either</span>₀ <span class="id">tl</span> <span class="id">tr</span> =&gt; "<span class="id">Either</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Brand</span>₀ <span class="id">bs</span> =&gt; "<span class="id">BrandedValue</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Arrow</span>₀ <span class="id">tin</span> <span class="id">t</span> =&gt; "<span class="id">CANNOT</span> <span class="id">PUT</span> <span class="id">AN</span> <span class="id">ARROW</span> <span class="id">INTO</span> <span class="id">A</span> <span class="id">DATAFRAME</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Foreign</span>₀ <span class="id">f</span> =&gt; "<span class="id">FOREIGN</span>?"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="drtype_to_scala">drtype_to_scala</a></span> (<span class="id">t</span>: <span class="id"><a href="Qcert.Common.TypeSystem.DType.html#drtype">drtype</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#t">t</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.TypeSystem.DType.html#Tlocal">Tlocal</a></span> <span class="id">r</span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#rtype_to_scala_type">rtype_to_scala_type</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.TypeSystem.DType.html#Tdistr">Tdistr</a></span> <span class="id">r</span> =&gt; "<span class="id">Dataset</span>[" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#rtype_to_scala_type">rtype_to_scala_type</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">r</span>) ++ "]"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="scala_literal_data">scala_literal_data</a></span> (<span class="id">d</span>: <span class="id"><a href="Qcert.Common.Data.RData.html#data">data</a></span>) (<span class="id">t</span>: <span class="id">rtype</span>₀) {<span class="kwd">struct</span> <span class="id">t</span>}: <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#t">t</a></span>, <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#d">d</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Unit</span>₀, <span class="id">d</span> =&gt; "()"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Nat</span>₀, <span class="id"><a href="Qcert.Common.Data.RData.html#dnat">dnat</a></span> <span class="id">i</span> =&gt; <span class="id"><a href="Qcert.Utils.Digits.html#Z_to_string10">Z_to_string10</a></span> <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Bool</span>₀, <span class="id"><a href="Qcert.Common.Data.RData.html#dbool">dbool</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> =&gt; "<span class="id">true</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Bool</span>₀, <span class="id"><a href="Qcert.Common.Data.RData.html#dbool">dbool</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> =&gt; "<span class="id">false</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span>₀, <span class="id"><a href="Qcert.Common.Data.RData.html#dstring">dstring</a></span> <span class="id">s</span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#quote_string">quote_string</a></span> <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Coll</span>₀ <span class="id">r</span>, <span class="id"><a href="Qcert.Common.Data.RData.html#dcoll">dcoll</a></span> <span class="id">xs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">element_type</span> := <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#rtype_to_scala_type">rtype_to_scala_type</a></span> <span class="id">r</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">elements</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_literal_data">scala_literal_data</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#x">x</a></span> <span class="id">r</span>) <span class="id">xs</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Array</span>[" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#element_type">element_type</a></span> ++ "](" ++ <span class="id"><a href="Qcert.Common.Operators.RUtilOps.html#joinStrings">joinStrings</a></span> ", " <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#elements">elements</a></span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Rec</span>₀ <span class="id">_</span> <span class="id">fts</span>, <span class="id"><a href="Qcert.Common.Data.RData.html#drec">drec</a></span> <span class="id">fds</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">blob</span> := <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#quote_string">quote_string</a></span> (<span class="id"><a href="Qcert.Translation.DatatoSparkDF.html#data_to_blob">data_to_blob</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#d">d</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">known_schema</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">StructType</span>(<span class="id">Seq</span>("<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id"><a href="Qcert.Common.Operators.RUtilOps.html#joinStrings">joinStrings</a></span> ", "<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ft</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">StructField</span>(""" ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#ft">ft</a></span> ++ """, " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#rtype_to_spark_DataType">rtype_to_spark_DataType</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#ft">ft</a></span>) ++ ")")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fts</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "))" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">fields</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">ft</span> =&gt; <span class="kwd">match</span> <span class="id"><a href="Qcert.Utils.Assoc.html#lookup">lookup</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">fds</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#ft">ft</a></span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">d</span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_literal_data">scala_literal_data</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#d">d</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#ft">ft</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; "<span class="id">FIELD_IN_TYPE_BUT_NOT_IN_DATA</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) <span class="id">fts</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">known</span> := "<span class="id">srow</span>(" ++ <span class="id"><a href="Qcert.Common.Operators.RUtilOps.html#joinStrings">joinStrings</a></span> ", " (<span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#known_schema">known_schema</a></span> :: <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#fields">fields</a></span>) ++ ")" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">srow</span>(<span class="id">StructType</span>(<span class="id">Seq</span>(<span class="id">StructField</span>(""$<span class="id">blob</span>"", <span class="id">StringType</span>), <span class="id">StructField</span>(""$<span class="id">known</span>"", " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#known_schema">known_schema</a></span> ++ "))), " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#blob">blob</a></span> ++ ", " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#known">known</a></span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; "<span class="id">UNIMPLEMENTED_SCALA_LITERAL_DATA</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="code_of_column">code_of_column</a></span> (<span class="id">c</span>: <span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#column">column</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#c">c</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#CCol">CCol</a></span> <span class="id">s</span> =&gt; "<span class="id">column</span>(""" ++ <span class="id">s</span> ++ """)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#CDot">CDot</a></span> <span class="id">fld</span> <span class="id">c</span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_column">code_of_column</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#c">c</a></span> ++ ".<span class="id">getField</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#quote_string">quote_string</a></span> <span class="id">fld</span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#CEq">CEq</a></span> <span class="id">c1</span> <span class="id">c2</span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_column">code_of_column</a></span> <span class="id">c1</span> ++ ".<span class="id">equalTo</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_column">code_of_column</a></span> <span class="id">c2</span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#CLessThan">CLessThan</a></span> <span class="id">c1</span> <span class="id">c2</span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_column">code_of_column</a></span> <span class="id">c1</span> ++ ".<span class="id">lt</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_column">code_of_column</a></span> <span class="id">c2</span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#CLit">CLit</a></span> (<span class="id">d</span>, <span class="id">r</span>) =&gt; "<span class="id">lit</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_literal_data">scala_literal_data</a></span> <span class="id">d</span> <span class="id">r</span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#CNeg">CNeg</a></span> <span class="id">c</span> =&gt; "<span class="id">not</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_column">code_of_column</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#c">c</a></span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#CPlus">CPlus</a></span> <span class="id">c1</span> <span class="id">c2</span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_column">code_of_column</a></span> <span class="id">c1</span> ++ ".<span class="id">plus</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_column">code_of_column</a></span> <span class="id">c2</span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#CSConcat">CSConcat</a></span> <span class="id">c1</span> <span class="id">c2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">concat</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_column">code_of_column</a></span> <span class="id">c1</span> ++ ", " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_column">code_of_column</a></span> <span class="id">c2</span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#CToString">CToString</a></span> <span class="id">c</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">toQcertStringUDF</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_column">code_of_column</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#c">c</a></span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#CUDFCast">CUDFCast</a></span> <span class="id">bs</span> <span class="id">c</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">castUDF</span>(" ++ <span class="id"><a href="Qcert.Common.Operators.RUtilOps.html#joinStrings">joinStrings</a></span> ", " ("<span class="id">HIERARCHY</span>"%<span class="id">string</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#quote_string">quote_string</a></span> <span class="id">bs</span>) ++ ")(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_column">code_of_column</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#c">c</a></span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#CUDFUnbrand">CUDFUnbrand</a></span> <span class="id">t</span> <span class="id">c</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">unbrandUDF</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#rtype_to_spark_DataType">rtype_to_spark_DataType</a></span> <span class="id">t</span> ++ ")(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_column">code_of_column</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#c">c</a></span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="code_of_dataframe">code_of_dataframe</a></span> (<span class="id">e</span>: <span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#dataframe">dataframe</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#DSVar">DSVar</a></span> <span class="id">s</span> =&gt; <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#DSSelect">DSSelect</a></span> <span class="id">cs</span> <span class="id">d</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">columns</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">nc</span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_column">code_of_column</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#nc">nc</a></span>) ++ ".<span class="kwd">as</span>(""" ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#nc">nc</a></span> ++ """)") <span class="id">cs</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_dataframe">code_of_dataframe</a></span> <span class="id">d</span> ++ ".<span class="id">select</span>(" ++ <span class="id"><a href="Qcert.Common.Operators.RUtilOps.html#joinStrings">joinStrings</a></span> ", " <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#columns">columns</a></span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#DSFilter">DSFilter</a></span> <span class="id">c</span> <span class="id">d</span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_dataframe">code_of_dataframe</a></span> <span class="id">d</span> ++ ".<span class="id">filter</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_column">code_of_column</a></span> <span class="id">c</span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#DSCartesian">DSCartesian</a></span> <span class="id">d1</span> <span class="id">d2</span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_dataframe">code_of_dataframe</a></span> <span class="id">d1</span> ++ ".<span class="id">join</span>(" ++ (<span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_dataframe">code_of_dataframe</a></span> <span class="id">d2</span>) ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#DSExplode">DSExplode</a></span> <span class="id">s</span> <span class="id">d1</span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_dataframe">code_of_dataframe</a></span> <span class="id">d1</span> ++ ".<span class="id">select</span>(<span class="id">explode</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_column">code_of_column</a></span> (<span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#CCol">CCol</a></span> <span class="id">s</span>) ++ ").<span class="kwd">as</span>(""" ++ <span class="id">s</span> ++ """))"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="spark_of_unop">spark_of_unop</a></span> (<span class="id">op</span>: <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#unaryOp">unaryOp</a></span>) (<span class="id">x</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#op">op</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ACount">ACount</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#x">x</a></span> ++ ".<span class="id">count</span>()" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ASum">ASum</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#x">x</a></span> ++ ".<span class="id">select</span>(<span class="id">sum</span>(""<span class="id">value</span>"")).<span class="id">first</span>().<span class="id">getLong</span>(0)" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AFlatten">AFlatten</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#x">x</a></span> ++ ".<span class="id">flatMap</span>(<span class="id">r</span> =&gt; <span class="id">r</span>)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; "<span class="id">SPARK_OF_UNOP</span> <span class="id">don</span>'<span class="id">t</span> <span class="id">know</span> <span class="id">how</span> <span class="id">to</span> <span class="id">generate</span> <span class="id">Spark</span> <span class="id">code</span> <span class="kwd">for</span> <span class="id">this</span> <span class="id">operator</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="scala_of_unop">scala_of_unop</a></span> (<span class="id">required_type</span>: <span class="id"><a href="Qcert.Common.TypeSystem.DType.html#drtype">drtype</a></span>) (<span class="id">op</span>: <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#unaryOp">unaryOp</a></span>) (<span class="id">x</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">prefix</span> <span class="id">s</span> := <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#s">s</a></span> ++ "(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#x">x</a></span> ++ ")" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">postfix</span> <span class="id">s</span> := <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#x">x</a></span> ++ "." ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#s">s</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#op">op</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AArithMean">AArithMean</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#prefix">prefix</a></span> "<span class="id">arithMean</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ABrand">ABrand</a></span> <span class="id">bs</span> =&gt; "<span class="id">brand</span>(" ++ <span class="id"><a href="Qcert.Common.Operators.RUtilOps.html#joinStrings">joinStrings</a></span> ", " (<span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#x">x</a></span>::(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#quote_string">quote_string</a></span> <span class="id">bs</span>)) ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ACast">ACast</a></span> <span class="id">bs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">cast</span>(<span class="id">HIERARCHY</span>, " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#x">x</a></span> ++ ", " ++ <span class="id"><a href="Qcert.Common.Operators.RUtilOps.html#joinStrings">joinStrings</a></span> ", " (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#quote_string">quote_string</a></span> <span class="id">bs</span>) ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AColl">AColl</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#prefix">prefix</a></span> "<span class="id">Array</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ACount">ACount</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#postfix">postfix</a></span> "<span class="id">length</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ADot">ADot</a></span> <span class="id">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#lift_tlocal">lift_tlocal</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#required_type">required_type</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#prefix">prefix</a></span> ("<span class="id">dot</span>[" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#rtype_to_scala_type">rtype_to_scala_type</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">r</span>) ++ "](""" ++ <span class="id">n</span> ++ """)")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; "<span class="id">NONLOCAL</span> <span class="id">EXPECTED</span> <span class="id">TYPE</span> <span class="id">IN</span> <span class="id">DOT</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AFlatten">AFlatten</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#postfix">postfix</a></span> "<span class="id">flatten.sorted</span>(<span class="id">QcertOrdering</span>)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AIdOp">AIdOp</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#prefix">prefix</a></span> "<span class="id">identity</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ALeft">ALeft</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#prefix">prefix</a></span> "<span class="id">left</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ANeg">ANeg</a></span> =&gt; "(!" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#x">x</a></span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ANumMax">ANumMax</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#prefix">prefix</a></span> "<span class="id">anummax</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ANumMin">ANumMin</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#prefix">prefix</a></span> "<span class="id">anummin</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARec">ARec</a></span> <span class="id">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#lift_tlocal">lift_tlocal</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#required_type">required_type</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> (<span class="id">Rec</span>₀ <span class="id"><a href="Qcert.Common.TypeSystem.RType.html#Closed">Closed</a></span> ((<span class="id">_</span>, <span class="id">ft</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">singletonRecord</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#quote_string">quote_string</a></span> <span class="id">n</span> ++ ", " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#rtype_to_spark_DataType">rtype_to_spark_DataType</a></span> <span class="id">ft</span> ++ ", " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#x">x</a></span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; "<span class="id">AREC_WITH_UNEXPECTED_REQUIRED_TYPE</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARecProject">ARecProject</a></span> <span class="id">fs</span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#prefix">prefix</a></span> ("<span class="id">recProject</span>(" ++ <span class="id"><a href="Qcert.Common.Operators.RUtilOps.html#joinStrings">joinStrings</a></span> ", " (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#quote_string">quote_string</a></span> <span class="id">fs</span>) ++ ")")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARight">ARight</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#prefix">prefix</a></span> "<span class="id">right</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ASum">ASum</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#postfix">postfix</a></span> "<span class="id">sum</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AToString">AToString</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#prefix">prefix</a></span> "<span class="id">toQcertString</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ASubstring">ASubstring</a></span> <span class="id">start</span> <span class="id">olen</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#x">x</a></span> ++ ").<span class="id">substring</span>(" ++ <span class="id"><a href="Qcert.Utils.CoqLibAdd.html#toString">toString</a></span> <span class="id">start</span> ++<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">olen</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">len</span> =&gt; ", " ++ <span class="id"><a href="Qcert.Utils.CoqLibAdd.html#toString">toString</a></span> <span class="id">len</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; ""<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ALike">ALike</a></span> <span class="id">pat</span> <span class="id">oescape</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">ALike</span> <span class="id">currently</span> <span class="id">implemented</span>.  <span class="id">Please</span> <span class="id">implement</span> <span class="kwd">as</span> <span class="kwd">in</span> <span class="id">the</span> <span class="id">java</span> <span class="id">backend</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AUArith">AUArith</a></span> <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ArithAbs">ArithAbs</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#prefix">prefix</a></span> "<span class="id">Math.abs</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AUnbrand">AUnbrand</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#lift_tlocal">lift_tlocal</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#required_type">required_type</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">r</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">schema</span> := <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#rtype_to_spark_DataType">rtype_to_spark_DataType</a></span> <span class="id">r</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">scala</span> := <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#rtype_to_scala_type">rtype_to_scala_type</a></span> <span class="id">r</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">unbrand</span>[" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala">scala</a></span> ++ "](" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#schema">schema</a></span> ++ ", " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#x">x</a></span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; "<span class="id">UNBRAND_REQUIRED_TYPE_ISSUE</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ADistinct">ADistinct</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#postfix">postfix</a></span> "<span class="id">distinct</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AOrderBy">AOrderBy</a></span> <span class="id">scl</span> =&gt; "<span class="id">SORT</span>???" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AForeignUnaryOp">AForeignUnaryOp</a></span> <span class="id">o</span> =&gt; <span class="id"><a href="Qcert.Translation.ForeignToScala.html#foreign_to_scala_unary_op">foreign_to_scala_unary_op</a></span> <span class="id">o</span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#x">x</a></span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ARecRemove">ARecRemove</a></span> <span class="id">_</span> =&gt; "<span class="id">ARECREMOVE</span>???"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ASingleton">ASingleton</a></span> =&gt; "<span class="id">SINGLETON</span>???"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AUArith">AUArith</a></span> <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ArithLog2">ArithLog2</a></span> =&gt; "<span class="id">LOG2</span>???" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#AUArith">AUArith</a></span> <span class="id"><a href="Qcert.Common.Operators.RUnaryOps.html#ArithSqrt">ArithSqrt</a></span> =&gt; "<span class="id">SQRT</span>???" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="spark_of_binop">spark_of_binop</a></span> (<span class="id">op</span>: <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#binOp">binOp</a></span>) (<span class="id">x</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>) (<span class="id">y</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#op">op</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#AUnion">AUnion</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#x">x</a></span> ++ ".<span class="id">union</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#y">y</a></span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; "<span class="id">SPARK_OF_BINOP</span> <span class="id">don</span>'<span class="id">t</span> <span class="id">know</span> <span class="id">how</span> <span class="id">to</span> <span class="id">generate</span> <span class="id">Spark</span> <span class="id">code</span> <span class="kwd">for</span> <span class="id">this</span> <span class="id">operator</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="scala_of_binop">scala_of_binop</a></span> (<span class="id">op</span>: <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#binOp">binOp</a></span>) (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>) (<span class="id">r</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">infix</span> <span class="id">s</span> := <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#l">l</a></span> ++ "." ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#s">s</a></span> ++ "(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#r">r</a></span> ++ ")" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">infix</span>' <span class="id">s</span> := "(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#l">l</a></span> ++ " " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#s">s</a></span> ++ " " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#r">r</a></span> ++ ")" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">prefix</span> <span class="id">s</span> := <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#s">s</a></span> ++ "(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#l">l</a></span> ++ ", " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#r">r</a></span> ++ ")" <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#op">op</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#AAnd">AAnd</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#infix">infix</a></span> "&amp;&amp;"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#ABArith">ABArith</a></span> <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#ArithDivide">ArithDivide</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#infix">infix</a></span> "/"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#ABArith">ABArith</a></span> <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#ArithMax">ArithMax</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#infix">infix</a></span> "<span class="id">max</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#ABArith">ABArith</a></span> <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#ArithMin">ArithMin</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#infix">infix</a></span> "<span class="id">min</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#ABArith">ABArith</a></span> <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#ArithMinus">ArithMinus</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#infix">infix</a></span> "-"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#ABArith">ABArith</a></span> <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#ArithMult">ArithMult</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#infix">infix</a></span> "*"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#ABArith">ABArith</a></span> <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#ArithPlus">ArithPlus</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#infix">infix</a></span> "+"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#ABArith">ABArith</a></span> <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#ArithRem">ArithRem</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#infix">infix</a></span> "%" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#AConcat">AConcat</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#prefix">prefix</a></span> "<span class="id">recordConcat</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#AContains">AContains</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#prefix">prefix</a></span> "<span class="id">AContains</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#AEq">AEq</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#prefix">prefix</a></span> "<span class="id">equal</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#ALe">ALe</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#prefix">prefix</a></span> "<span class="id">lessOrEqual</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#ALt">ALt</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#prefix">prefix</a></span> "<span class="id">lessThan</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#AMax">AMax</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#l">l</a></span> ++ ".++(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#r">r</a></span> ++ ".<span class="id">diff</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#l">l</a></span> ++ "))" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#AMin">AMin</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#l">l</a></span> ++ ".<span class="id">diff</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#l">l</a></span> ++ ".<span class="id">diff</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#r">r</a></span> ++ "))" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#AMinus">AMinus</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#r">r</a></span> ++ ".<span class="id">diff</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#l">l</a></span> ++ ")" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#AMergeConcat">AMergeConcat</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#prefix">prefix</a></span> "<span class="id">mergeConcat</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#AOr">AOr</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#infix">infix</a></span> "||"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#ASConcat">ASConcat</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#infix">infix</a></span> "+" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#AUnion">AUnion</a></span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#infix">infix</a></span> "++" ++ ".<span class="id">sorted</span>(<span class="id">QcertOrdering</span>)" <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.Operators.RBinaryOps.html#AForeignBinaryOp">AForeignBinaryOp</a></span> <span class="id">op</span> =&gt; "<span class="id">FOREIGNBINARYOP</span>???"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="primitive_type">primitive_type</a></span> (<span class="id">t</span>: <span class="id"><a href="Qcert.Common.TypeSystem.RType.html#rtype">rtype</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#t">t</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ⊥₀ | ⊤₀ | <span class="id">Unit</span>₀ | <span class="id">Nat</span>₀ | <span class="id">String</span>₀ | <span class="id">Bool</span>₀ =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Coll</span>₀ <span class="id">_</span> | <span class="id">Rec</span>₀ <span class="id">_</span> <span class="id">_</span> | <span class="id">Either</span>₀ <span class="id">_</span> <span class="id">_</span> | <span class="id">Arrow</span>₀ <span class="id">_</span> <span class="id">_</span> | <span class="id">Brand</span>₀ <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Foreign</span>₀ <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> {<span class="id">A</span>: <span class="kwd">Set</span>} (<span class="id">d</span>:@<span class="id"><a href="Qcert.DNNRC.Lang.DNNRCBase.html#dnnrc_base">dnnrc_base</a></span> <span class="id">_</span> (<span class="id"><a href="Qcert.tDNNRC.Lang.tDNNRC.html#type_annotation">type_annotation</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#A">A</a></span>) <span class="id"><a href="Qcert.DNNRC.Lang.Dataframe.html#dataframe">dataframe</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">code</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#d">d</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.DNNRCBase.html#DNNRCGetConstant">DNNRCGetConstant</a></span> <span class="id">t</span> <span class="id">n</span> =&gt; <span class="id">n</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.DNNRCBase.html#DNNRCVar">DNNRCVar</a></span> <span class="id">t</span> <span class="id">n</span> =&gt; <span class="id">n</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.DNNRCBase.html#DNNRCConst">DNNRCConst</a></span> <span class="id">t</span> <span class="id">c</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#lift_tlocal">lift_tlocal</a></span> (<span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#di_required_typeof">di_required_typeof</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#d">d</a></span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_literal_data">scala_literal_data</a></span> <span class="id">c</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; "<span class="id">Don</span>'<span class="id">t</span> <span class="id">know</span> <span class="id">how</span> <span class="id">to</span> <span class="id">construct</span> <span class="id">a</span> <span class="id">distributed</span> <span class="id">constant</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.DNNRCBase.html#DNNRCBinop">DNNRCBinop</a></span> <span class="id">t</span> <span class="id">op</span> <span class="id">x</span> <span class="id">y</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#di_typeof">di_typeof</a></span> <span class="id">x</span>, <span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#di_typeof">di_typeof</a></span> <span class="id">y</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.TypeSystem.DType.html#Tlocal">Tlocal</a></span> <span class="id">_</span>, <span class="id"><a href="Qcert.Common.TypeSystem.DType.html#Tlocal">Tlocal</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_binop">scala_of_binop</a></span> <span class="id">op</span> (<span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id">x</span>) (<span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.TypeSystem.DType.html#Tdistr">Tdistr</a></span> <span class="id">_</span>, <span class="id"><a href="Qcert.Common.TypeSystem.DType.html#Tdistr">Tdistr</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#spark_of_binop">spark_of_binop</a></span> <span class="id">op</span> (<span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id">x</span>) (<span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; "<span class="id">DONT_SUPPORT_MIXED_LOCAL_DISTRIBUTED_BINARY_OPERATORS</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.DNNRCBase.html#DNNRCUnop">DNNRCUnop</a></span> <span class="id">t</span> <span class="id">op</span> <span class="id">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#di_typeof">di_typeof</a></span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.TypeSystem.DType.html#Tlocal">Tlocal</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_unop">scala_of_unop</a></span> (<span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#di_required_typeof">di_required_typeof</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#d">d</a></span>) <span class="id">op</span> (<span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Common.TypeSystem.DType.html#Tdistr">Tdistr</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#spark_of_unop">spark_of_unop</a></span> <span class="id">op</span> (<span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.DNNRCBase.html#DNNRCLet">DNNRCLet</a></span> <span class="id">t</span> <span class="id">n</span> <span class="id">x</span> <span class="id">y</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"((( " ++ <span class="id">n</span> ++ ": " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#drtype_to_scala">drtype_to_scala</a></span> (<span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#di_typeof">di_typeof</a></span> <span class="id">x</span>) ++ ") =&gt; " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id">y</span> ++ ")(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id">x</span> ++ "))"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.DNNRCBase.html#DNNRCFor">DNNRCFor</a></span> <span class="id">t</span> <span class="id">n</span> <span class="id">x</span> <span class="id">y</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id">x</span> ++ ".<span class="id">map</span>((" ++ <span class="id">n</span> ++ ") =&gt; { " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id">y</span> ++ " })"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.DNNRCBase.html#DNNRCIf">DNNRCIf</a></span> <span class="id">t</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(<span class="kwd">if</span> (" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id">x</span> ++ ") " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id">y</span> ++ " <span class="kwd">else</span> " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id">z</span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.DNNRCBase.html#DNNRCEither">DNNRCEither</a></span> <span class="id">t</span> <span class="id">x</span> <span class="id">vy</span> <span class="id">y</span> <span class="id">vz</span> <span class="id">z</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Utils.Lift.html#olift">olift</a></span> <span class="id"><a href="Qcert.Common.Typing.TUtil.html#tuneither">tuneither</a></span> (<span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#lift_tlocal">lift_tlocal</a></span> (<span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#di_required_typeof">di_required_typeof</a></span> <span class="id">x</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">lt</span>, <span class="id">rt</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">either</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id">x</span> ++ ", (" ++<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vy</span> ++ ": " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#rtype_to_scala_type">rtype_to_scala_type</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">lt</span>) ++<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;") =&gt; { " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id">y</span> ++ " }, (" ++<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vz</span> ++ ": " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#rtype_to_scala_type">rtype_to_scala_type</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">rt</span>) ++<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;") =&gt; { " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id">z</span> ++ " })"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; "<span class="id">DNNRCEither</span>'<span class="id">s</span> <span class="id">first</span> <span class="id">argument</span> <span class="id">is</span> <span class="id">not</span> <span class="id">of</span> <span class="id">type</span> <span class="id">Either</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.DNNRCBase.html#DNNRCGroupBy">DNNRCGroupBy</a></span> <span class="id">t</span> <span class="id">g</span> <span class="id">sl</span> <span class="id">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">DNNRC_GROUPBY_CODEGEN_IS_NOT_CURRENTLY_IMPLEMENTED</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.DNNRCBase.html#DNNRCCollect">DNNRCCollect</a></span> <span class="id">t</span> <span class="id">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">postfix</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Utils.Lift.html#olift">olift</a></span> <span class="id"><a href="Qcert.Common.Typing.TUtil.html#tuncoll">tuncoll</a></span> (<span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#lift_tdistr">lift_tdistr</a></span> (<span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#di_typeof">di_typeof</a></span> <span class="id">x</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">rt</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">rt</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Nat</span>₀ =&gt; ".<span class="id">map</span>((<span class="id">row</span>) =&gt; <span class="id">row.getLong</span>(0))"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Foreign</span>₀ <span class="id">_</span> =&gt; ".<span class="id">map</span>((<span class="id">row</span>) =&gt; <span class="id">row.getFloat</span>(0))" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; "" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; "<span class="id">ARGUMENT_TO_COLLECT_SHOULD_BE_A_DISTRIBUTED_COLLECTION</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id">x</span> ++ ".<span class="id">collect</span>()" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#postfix">postfix</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.DNNRCBase.html#DNNRCDispatch">DNNRCDispatch</a></span> <span class="id">t</span> <span class="id">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Utils.Lift.html#olift">olift</a></span> <span class="id"><a href="Qcert.Common.Typing.TUtil.html#tuncoll">tuncoll</a></span> (<span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#lift_tlocal">lift_tlocal</a></span> (<span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#di_typeof">di_typeof</a></span> <span class="id">x</span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">et</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">dispatch</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#rtype_to_spark_DataType">rtype_to_spark_DataType</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">et</span>) ++ ", " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id">x</span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; "<span class="id">Argument</span> <span class="id">to</span> <span class="id">dispatch</span> <span class="id">is</span> <span class="id">not</span> <span class="id">a</span> <span class="id">local</span> <span class="id">collection</span>."<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.DNNRCBase.html#DNNRCAlg">DNNRCAlg</a></span> <span class="id">t</span> <span class="id">a</span> ((<span class="id">x</span>, <span class="id">d</span>)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"{ <span class="id">val</span> " ++ <span class="id">x</span> ++ " = " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#d">d</a></span> ++ "; " ++<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code_of_dataframe">code_of_dataframe</a></span> <span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ " }"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.DNNRC.Lang.DNNRCBase.html#DNNRCAlg">DNNRCAlg</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">NON_UNARY_ALG_CODEGEN_IS_NOT_CURRENTLY_IMPLEMENTED</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#di_typeof">di_typeof</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#d">d</a></span> == <span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#di_required_typeof">di_required_typeof</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#d">d</a></span> <span class="kwd">then</span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code">code</a></span> <span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#lift_tlocal">lift_tlocal</a></span> (<span class="id"><a href="Qcert.tDNNRC.Typing.tDNNRCInfer.html#di_required_typeof">di_required_typeof</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#d">d</a></span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span> =&gt; "<span class="id">identity</span>/*<span class="id">CAST</span>*/(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#code">code</a></span> ++ ")"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; "<span class="id">CANTCASTTODISTRIBUTEDTYPE</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="initBrandHierarchy">initBrandHierarchy</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">lines</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt; "(""" ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#p">p</a></span> ++ """ -&gt; """ ++ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#p">p</a></span> ++ """)")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Common.Data.BrandRelation.html#brand_relation_brands">brand_relation_brands</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Common.Operators.RUtilOps.html#joinStrings">joinStrings</a></span> ", " <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#lines">lines</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="emitGlobals">emitGlobals</a></span> (<span class="id">tenv</span>: <span class="id"><a href="Qcert.Common.Typing.TDBindings.html#tdbindings">tdbindings</a></span>) (<span class="id">fileArgCounter</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#tenv">tenv</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; ""<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id">name</span>, <span class="id"><a href="Qcert.Common.TypeSystem.DType.html#Tlocal">Tlocal</a></span> <span class="id">lt</span>) :: <span class="id">rest</span> =&gt; "<span class="id">LOCAL</span> <span class="id">INPUT</span> <span class="id">UNIMPLEMENTED</span>"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id">name</span>, <span class="id"><a href="Qcert.Common.TypeSystem.DType.html#Tdistr">Tdistr</a></span> <span class="id">elt</span>) :: <span class="id">rest</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">val</span> " ++ <span class="id">name</span> ++ " = <span class="id">sparkSession.read.schema</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#rtype_to_spark_DataType">rtype_to_spark_DataType</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">elt</span>) ++ ").<span class="id">json</span>(<span class="id">args</span>(" ++ <span class="id"><a href="Qcert.Utils.Digits.html#nat_to_string10">nat_to_string10</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#fileArgCounter">fileArgCounter</a></span> ++ "))" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span> ++<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#emitGlobals">emitGlobals</a></span> <span class="id">rest</span> (<span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#fileArgCounter">fileArgCounter</a></span> + 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Toplevel entry to Spark2/Scala codegen </div>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="dnnrc_typed_to_spark_df_top">dnnrc_typed_to_spark_df_top</a></span> {<span class="id">A</span> : <span class="kwd">Set</span>} (<span class="id">tenv</span>:<span class="id"><a href="Qcert.Common.Typing.TDBindings.html#tdbindings">tdbindings</a></span>) (<span class="id">name</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span>:<span class="id"><a href="Qcert.tDNNRC.Lang.tDNNRC.html#dnnrc_typed">dnnrc_typed</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;""<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "<span class="id">import</span> <span class="id">org.apache.spark.SparkContext</span>" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "<span class="id">import</span> <span class="id">org.apache.spark.sql.functions._</span>" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "<span class="id">import</span> <span class="id">org.apache.spark.sql.SparkSession</span>" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "<span class="id">import</span> <span class="id">org.apache.spark.sql.types._</span>" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "<span class="id">import</span> <span class="id">org.qcert.QcertRuntime</span>" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "<span class="id">import</span> <span class="id">org.qcert.QcertRuntime._</span>" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "<span class="id">object</span> " ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#name">name</a></span> ++ " {" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "<span class="id">def</span> <span class="id">main</span>(<span class="id">args</span>: <span class="id">Array</span>[<span class="id">String</span>]): <span class="id">Unit</span> = {" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "<span class="id">val</span> <span class="id">HIERARCHY</span> = <span class="id">QcertRuntime.makeHierarchy</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#initBrandHierarchy">initBrandHierarchy</a></span> ++ ")" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "<span class="id">val</span> <span class="id">sparkContext</span> = <span class="id">new</span> <span class="id">SparkContext</span>()" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "<span class="id">org.apache.log4j.Logger.getRootLogger</span>().<span class="id">setLevel</span>(<span class="id">org.apache.log4j.Level.WARN</span>)" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "<span class="id">val</span> <span class="id">sparkSession</span> = <span class="id">SparkSession.builder</span>().<span class="id">getOrCreate</span>()" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#emitGlobals">emitGlobals</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#tenv">tenv</a></span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "<span class="id">import</span> <span class="id">sparkSession.implicits._</span>" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "<span class="id">QcertRuntime.beforeQuery</span>()" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "<span class="id">println</span>(<span class="id">QcertRuntime.toBlob</span>(" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#scala_of_dnnrc_base">scala_of_dnnrc_base</a></span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#e">e</a></span> ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "))" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "<span class="id">QcertRuntime.afterQuery</span>()" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "<span class="id">sparkContext.stop</span>()" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "}" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ "}" ++ <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#eol">eol</a></span><br/>
&nbsp;&nbsp;.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Qcert.Translation.tDNNRCtoSparkDF.html#tDNNRCtoSparkDF">tDNNRCtoSparkDF</a></span>.<br/>
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
