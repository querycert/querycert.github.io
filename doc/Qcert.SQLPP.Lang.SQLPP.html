
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Qcert.SQLPP.Lang.SQLPP</title>
<meta name="description" content="Documentation of Coq module Qcert.SQLPP.Lang.SQLPP" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Qcert.SQLPP.Lang.SQLPP</h1>
<div class="coq">
<br/>
<span class="kwd">Section</span> <span class="id">SQLPP</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">String</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">ZArith</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">List</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Arith</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">EquivDec</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Utils</span> <span class="id">BasicSystem</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">fruntime</span>:<span class="id">foreign_runtime</span>}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">RDataSort</span>. <br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Unset</span> <span class="id">Elimination</span> <span class="id">Schemes</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">sqlpp_order_spec</span> : <span class="kwd">Set</span> := <span class="id">SortDesc</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id">sqlpp_distinct</span> : <span class="kwd">Set</span> := <span class="id">SPDistinct</span> | <span class="id">SPAll</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id">sqlpp_join_type</span> : <span class="kwd">Set</span> := <span class="id">SPInner</span> | <span class="id">SPLeftOuter</span>.<br/>
<br/>
<div class="doc">The SQLPP grammar according to AsterixDB
<pre>
Statement ::= ( SingleStatement ( ";" )? )* &lt;EOF&gt;

SingleStatement ::= DatabaseDeclaration
                  | FunctionDeclaration
                  | CreateStatement
                  | DropStatement
                  | LoadStatement
                  | SetStatement
                  | InsertStatement
                  | DeleteStatement
                  | Query ";"</pre>
We currently support source files containing all possible statement types but only Query statements are passed along
by the initial front end.   Other statements are silently elided.  Of course, this can result in semantic nonsense when,
for example, a FunctionDeclaration is elided but is then used in a subsequent Query.  However, eliding most other statement
types works in practice since they are present for bookkeeping purposes and don't affect the semantics of the Query statements.
<pre>
Query ::= (Expression | SelectStatement) ";" </pre>
The distinction between Expression and SelectStatement is a superficial grammar technicality, because a
parenthesized SelectStatement is an Expression.  The duality at this production amounts to saying it is ok to
omit the parentheses at top level when followed by a semi-colon.  At the level of the AST, though, a Query is
an Expression and Expression is actually the top-level production.
Most of the non-terminals below "Expression" are there to show precedence, which is important in the grammar but
is not needed in the AST.  So, the AST is basically a huge inductive set on Expression.  </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id">sqlpp_expr</span> : <span class="kwd">Set</span> :=<br/>
<br/>
<br/>
&nbsp;&nbsp;| <span class="id">SPPositive</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPNegative</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPExists</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPNot</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPIsNull</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPIsMissing</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPIsUnknown</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span>                                  <br/>
<br/>
<div class="doc">                                
Valid operators for the second form (binary operators) are
plus, minus, mult, div, mod, exp, concat, in, fuzzy-eq, eq, neq, lt, gt, le, ge, like, and, or
(Actually, fuzzy-eq isn't listed in the SQL++ grammar, but it's in the AQL grammar and supported for SQL++ by AsterixDB).
Note that we restrict the RHS of 'like' to be a String literal, which is more restrictive than the language spec.
</div>
<br/>
&nbsp;&nbsp;| <span class="id">SPPlus</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPMinus</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPMult</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPDiv</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPMod</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPExp</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPConcat</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPIn</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPEq</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPFuzzyEq</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPNeq</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPLt</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPGt</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPLe</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPGe</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPLike</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">string</span> -&gt; <span class="id">sqlpp_expr</span> <br/>
&nbsp;&nbsp;| <span class="id">SPAnd</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPOr</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;<br/>
<div class="doc">Finally, the ternery BETWEEN operator </div>
<br/>
&nbsp;&nbsp;| <span class="id">SPBetween</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span>                                         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;| <span class="id">SPSimpleCase</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">list</span> <span class="id">sqlpp_when_then</span> -&gt; <span class="id">option</span> <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPSearchedCase</span> : <span class="id">list</span> <span class="id">sqlpp_when_then</span> -&gt; <span class="id">option</span> <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;| <span class="id">SPSome</span> : <span class="id">list</span> (<span class="id">string</span> * <span class="id">sqlpp_expr</span>) -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPEvery</span> : <span class="id">list</span> (<span class="id">string</span> * <span class="id">sqlpp_expr</span>) -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;| <span class="id">SPDot</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">string</span> -&gt; <span class="id">sqlpp_expr</span>                                                            <br/>
<br/>
<br/>
&nbsp;&nbsp;| <span class="id">SPIndex</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;| <span class="id">SPIndexAny</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
<br/>
<br/>
&nbsp;&nbsp;| <span class="id">SPLiteral</span> : <span class="id">data</span> -&gt; <span class="id">sqlpp_expr</span> <br/>
&nbsp;&nbsp;| <span class="id">SPNull</span> | <span class="id">SPMissing</span><br/>
<br/>
<br/>
&nbsp;&nbsp;| <span class="id">SPVarRef</span> : <span class="id">string</span> -&gt; <span class="id">sqlpp_expr</span>                                   <br/>
<br/>
<br/>
&nbsp;&nbsp;| <span class="id">SPFunctionCall</span> : <span class="id">string</span> -&gt; <span class="id">list</span> <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;| <span class="id">SPArray</span> : <span class="id">list</span> <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span>                                                   <br/>
<br/>
<br/>
&nbsp;&nbsp;| <span class="id">SPBag</span> : <span class="id">list</span> <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span>                                  <br/>
<br/>
<br/>
&nbsp;&nbsp;| <span class="id">SPObject</span> : <span class="id">list</span> (<span class="id">string</span> * <span class="id">sqlpp_expr</span>) -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;| <span class="id">SPQuery</span> : <span class="id">sqlpp_select_statement</span> -&gt; <span class="id">sqlpp_expr</span><br/>
&nbsp;&nbsp;<br/>
<span class="kwd">with</span> <span class="id">sqlpp_select_statement</span> : <span class="kwd">Set</span> :=<br/>
&nbsp;<span class="id">SPSelectStmt</span> :<br/>
&nbsp;&nbsp;<span class="id">list</span> (<span class="id">string</span> * <span class="id">sqlpp_expr</span>)     <br/>
&nbsp;&nbsp;-&gt; <span class="id">sqlpp_select_block</span>  <br/>
&nbsp;&nbsp;-&gt; <span class="id">list</span> <span class="id">sqlpp_union_element</span>  <br/>
&nbsp;&nbsp;-&gt; <span class="id">sqlpp_order_by</span>  <br/>
&nbsp;&nbsp;-&gt; <span class="id">sqlpp_select_statement</span><br/>
<br/>
<br/>
<span class="kwd">with</span> <span class="id">sqlpp_select_block</span> : <span class="kwd">Set</span> :=<br/>
&nbsp;<span class="id">SPSelectBlock</span> : <span class="id">sqlpp_select</span> -&gt; <span class="id">list</span> <span class="id">sqlpp_from</span>   <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id">list</span> (<span class="id">string</span> * <span class="id">sqlpp_expr</span>)  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id">sqlpp_where</span> -&gt; <span class="id">sqlpp_group_by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id">list</span> (<span class="id">string</span> * <span class="id">sqlpp_expr</span>)  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id">option</span> <span class="id">sqlpp_expr</span>   <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id">sqlpp_select_block</span><br/>
<br/>
<span class="kwd">with</span> <span class="id">sqlpp_union_element</span> : <span class="kwd">Set</span> :=<br/>
&nbsp;&nbsp;| <span class="id">SPBlock</span> : <span class="id">sqlpp_select_block</span> -&gt; <span class="id">sqlpp_union_element</span><br/>
&nbsp;&nbsp;| <span class="id">SPSubquery</span> : <span class="id">sqlpp_select_statement</span> -&gt; <span class="id">sqlpp_union_element</span>        <br/>
<br/>
<br/>
<span class="kwd">with</span> <span class="id">sqlpp_select</span> : <span class="kwd">Set</span> :=<br/>
&nbsp;&nbsp;| <span class="id">SPSelectSQL</span> : <span class="id">sqlpp_distinct</span> -&gt; <span class="id">list</span> <span class="id">sqlpp_project</span> -&gt; <span class="id">sqlpp_select</span><br/>
&nbsp;&nbsp;| <span class="id">SPSelectValue</span>: <span class="id">sqlpp_distinct</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_select</span><br/>
&nbsp;&nbsp;<br/>
<span class="kwd">with</span> <span class="id">sqlpp_project</span> : <span class="kwd">Set</span> :=<br/>
&nbsp;&nbsp;| <span class="id">SPProject</span> : (<span class="id">sqlpp_expr</span> * <span class="id">option</span> <span class="id">string</span>) -&gt; <span class="id">sqlpp_project</span><br/>
&nbsp;&nbsp;| <span class="id">SPProjectStar</span><br/>
&nbsp;&nbsp;<br/>
<br/>
<span class="kwd">with</span> <span class="id">sqlpp_from</span> : <span class="kwd">Set</span> :=<br/>
&nbsp;&nbsp;| <span class="id">SPFrom</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">option</span> <span class="id">string</span> -&gt; <span class="id">list</span> <span class="id">sqlpp_join_clause</span> -&gt; <span class="id">sqlpp_from</span><br/>
<br/>
<span class="kwd">with</span> <span class="id">sqlpp_join_clause</span> : <span class="kwd">Set</span> :=<br/>
&nbsp;&nbsp;| <span class="id">SPJoin</span> : <span class="id">sqlpp_join_type</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">option</span> <span class="id">string</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_join_clause</span><br/>
&nbsp;&nbsp;| <span class="id">SPUnnest</span> : <span class="id">sqlpp_join_type</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">option</span> <span class="id">string</span> -&gt; <span class="id">option</span> <span class="id">string</span> -&gt; <span class="id">sqlpp_join_clause</span>  <br/>
<br/>
<br/>
<span class="kwd">with</span> <span class="id">sqlpp_where</span> : <span class="kwd">Set</span> :=<br/>
&nbsp;&nbsp;| <span class="id">SPWhere</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_where</span><br/>
&nbsp;&nbsp;| <span class="id">SPNoWhere</span><br/>
<br/>
<br/>
<span class="kwd">with</span> <span class="id">sqlpp_group_by</span> : <span class="kwd">Set</span> :=<br/>
&nbsp;| <span class="id">SPGroupBy</span> : <span class="id">list</span> (<span class="id">sqlpp_expr</span> * <span class="id">option</span> <span class="id">string</span>)   <br/>
&nbsp;&nbsp;-&gt; <span class="id">option</span> (<span class="id">string</span> * <span class="id">list</span> (<span class="id">string</span> * <span class="id">string</span>))  <br/>
&nbsp;&nbsp;-&gt; <span class="id">sqlpp_group_by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">SPNoGroupBy</span><br/>
<br/>
&nbsp;<br/>
<span class="kwd">with</span> <span class="id">sqlpp_order_by</span> : <span class="kwd">Set</span> :=<br/>
&nbsp;| <span class="id">SPOrderBy</span> : <span class="id">list</span> (<span class="id">sqlpp_expr</span> * <span class="id">sqlpp_order_spec</span>) -&gt; <span class="id">sqlpp_order_by</span><br/>
&nbsp;| <span class="id">SPNoOrderBy</span><br/>
&nbsp;<br/>
<span class="kwd">with</span> <span class="id">sqlpp_when_then</span> : <span class="kwd">Set</span>:=<br/>
&nbsp;| <span class="id">SPWhenThen</span> : <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_expr</span> -&gt; <span class="id">sqlpp_when_then</span>	<br/>
.	<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">sqlpp</span> : <span class="kwd">Set</span> := <span class="id">sqlpp_expr</span>.<br/>
<br/>
&nbsp;&nbsp;<br/>
<span class="kwd">End</span> <span class="id">SQLPP</span>.<br/>
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
