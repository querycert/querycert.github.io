
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Qcert.Basic.Util.RUtil</title>
<meta name="description" content="Documentation of Coq module Qcert.Basic.Util.RUtil" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Qcert.Basic.Util.RUtil</h1>
<div class="coq">
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">List</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Sumbool</span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Permutation</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Equivalence</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Morphisms</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Setoid</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">EquivDec</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Peano_dec</span>.<br/>
<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">dest_eqdec</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;| [|- <span class="id">context</span> [<span class="id">eq_nat_dec</span> ?<span class="id">x</span> ?<span class="id">y</span>]] =&gt; <span class="tactic">destruct</span> (<span class="id">eq_nat_dec</span> <span class="id">x</span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id">context</span> [<span class="id">eq_nat_dec</span> ?<span class="id">x</span> ?<span class="id">y</span>] |- <span class="id">_</span>] =&gt; <span class="tactic">destruct</span> (<span class="id">eq_nat_dec</span> <span class="id">x</span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| [|- <span class="id">context</span> [@<span class="id">equiv_dec</span> ?<span class="id">a</span> ?<span class="id">b</span> ?<span class="id">c</span> ?<span class="id">d</span> ?<span class="id">x</span> ?<span class="id">y</span>]] =&gt; <span class="tactic">destruct</span> (@<span class="id">equiv_dec</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">d</span> <span class="id">x</span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id">context</span> [@<span class="id">equiv_dec</span> ?<span class="id">a</span> ?<span class="id">b</span> ?<span class="id">c</span> ?<span class="id">d</span> ?<span class="id">x</span> ?<span class="id">y</span>] |- <span class="id">_</span>] =&gt; <span class="tactic">destruct</span> (@<span class="id">equiv_dec</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">d</span> <span class="id">x</span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">unfold</span> <span class="id">Equivalence.equiv</span>, <span class="id">RelationClasses.complement</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">subst</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">RUtil</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id">bools</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Bool</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">andb_true_inversion</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b1</span> <span class="id">b2</span> : <span class="id">bool</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andb</span> <span class="id">b1</span> <span class="id">b2</span> = <span class="id">true</span> &lt;-&gt; <span class="id">b1</span> = <span class="id">true</span> /\ <span class="id">b2</span> = <span class="id">true</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof68')">Proof.</div>
<div class="proofscript" id="proof68">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">case_eq</span> <span class="id">b1</span>; <span class="id">case_eq</span> <span class="id">b2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">andb_true_intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">four_cases</span> {<span class="id">A</span>:<span class="kwd">Type</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">p1</span> <span class="id">p2</span>: <span class="id">A</span> -&gt; <span class="id">bool</span>) (<span class="id">a</span>:<span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((((<span class="id">p1</span> <span class="id">a</span>) = <span class="id">true</span>) /\ ((<span class="id">p2</span> <span class="id">a</span>) = <span class="id">true</span>)) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(((<span class="id">p1</span> <span class="id">a</span>) = <span class="id">true</span>) /\ ((<span class="id">p2</span> <span class="id">a</span>) = <span class="id">false</span>))) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((((<span class="id">p1</span> <span class="id">a</span>) = <span class="id">false</span>) /\ ((<span class="id">p2</span> <span class="id">a</span>) = <span class="id">true</span>)) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(((<span class="id">p1</span> <span class="id">a</span>) = <span class="id">false</span>) /\ ((<span class="id">p2</span> <span class="id">a</span>) = <span class="id">false</span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof69')">Proof.</div>
<div class="proofscript" id="proof69">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">case</span> (<span class="id">p1</span> <span class="id">a</span>); <span class="tactic">case</span> (<span class="id">p2</span> <span class="id">a</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">two_cases</span> {<span class="id">A</span>:<span class="kwd">Type</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">p</span>: <span class="id">A</span> -&gt; <span class="id">bool</span>) (<span class="id">a</span>:<span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">p</span> <span class="id">a</span>) = <span class="id">true</span>) \/ ((<span class="id">p</span> <span class="id">a</span>) = <span class="id">false</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof70')">Proof.</div>
<div class="proofscript" id="proof70">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">case</span> (<span class="id">p</span> <span class="id">a</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">notand</span> <span class="id">p</span> <span class="id">q</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~(<span class="id">p</span> \/ <span class="id">q</span>) -&gt; ~<span class="id">p</span> /\ ~<span class="id">q</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof71')">Proof.</div>
<div class="proofscript" id="proof71">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">not</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intro</span>. <span class="tactic">elim</span> <span class="id">H</span>. <span class="id">left</span>. <span class="tactic">assumption</span>. <span class="tactic">elim</span> <span class="id">H</span>. <span class="id">right</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">eq_implies_pred</span> {<span class="id">A</span>:<span class="kwd">Type</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">p</span>:<span class="id">A</span> -&gt; <span class="id">bool</span>), <span class="kwd">forall</span> (<span class="id">x1</span> <span class="id">x2</span>:<span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x1</span> = <span class="id">x2</span> -&gt; (<span class="id">p</span> <span class="id">x1</span>) = (<span class="id">p</span> <span class="id">x2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof72')">Proof.</div>
<div class="proofscript" id="proof72">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">not_pred_implies_neq</span> {<span class="id">A</span>:<span class="kwd">Type</span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">p</span>:<span class="id">A</span> -&gt; <span class="id">bool</span>), <span class="kwd">forall</span> (<span class="id">x1</span> <span class="id">x2</span>:<span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">p</span> <span class="id">x1</span>) &lt;&gt; (<span class="id">p</span> <span class="id">x2</span>) -&gt; <span class="id">x1</span> &lt;&gt; <span class="id">x2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof73')">Proof.</div>
<div class="proofscript" id="proof73">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">not</span> <span class="kwd">in</span> *; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">apply</span> <span class="id">eq_implies_pred</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id">bools</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id">In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span>:<span class="kwd">Type</span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">In_app</span> (<span class="id">x</span>:<span class="id">A</span>) (<span class="id">l1</span> <span class="id">l2</span>:<span class="id">list</span> <span class="id">A</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> (<span class="id">l1</span> ++ <span class="id">l2</span>) -&gt; <span class="id">In</span> <span class="id">x</span> <span class="id">l1</span> \/ <span class="id">In</span> <span class="id">x</span> <span class="id">l2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof74')">Proof.</div>
<div class="proofscript" id="proof74">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">induction</span> <span class="id">l1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="id">left</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">IHl1</span> <span class="id">H0</span>); <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">IHl1</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">In_app_comm</span> (<span class="id">v</span>:<span class="id">A</span>) (<span class="id">l1</span> <span class="id">l2</span>:<span class="id">list</span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">v</span> (<span class="id">l1</span>++<span class="id">l2</span>) -&gt; <span class="id">In</span> <span class="id">v</span> (<span class="id">l2</span>++<span class="id">l1</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof75')">Proof.</div>
<div class="proofscript" id="proof75">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Permutation_in</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Permutation_app_comm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">In_app_iff</span> (<span class="id">v</span>:<span class="id">A</span>) (<span class="id">l1</span> <span class="id">l2</span>:<span class="id">list</span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">v</span> (<span class="id">l1</span>++<span class="id">l2</span>) &lt;-&gt; <span class="id">In</span> <span class="id">v</span> (<span class="id">l2</span>++<span class="id">l1</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof76')">Proof.</div>
<div class="proofscript" id="proof76">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">apply</span> <span class="id">In_app_comm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">find_In</span> {<span class="id">f</span> <span class="id">l</span>} {<span class="id">b</span>:<span class="id">A</span>} : <span class="id">find</span> <span class="id">f</span> <span class="id">l</span> = <span class="id">Some</span> <span class="id">b</span> -&gt; <span class="id">In</span> <span class="id">b</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof77')">Proof.</div>
<div class="proofscript" id="proof77">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">b</span>; <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">a</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 1; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">find_correct</span> {<span class="id">f</span> <span class="id">l</span>} {<span class="id">b</span>:<span class="id">A</span>} : <span class="id">find</span> <span class="id">f</span> <span class="id">l</span> = <span class="id">Some</span> <span class="id">b</span> -&gt; <span class="id">f</span> <span class="id">b</span> = <span class="id">true</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof78')">Proof.</div>
<div class="proofscript" id="proof78">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">b</span>; <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">f</span> <span class="id">a</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 2; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">app_or_in</span> (<span class="id">x</span>:<span class="id">A</span>) (<span class="id">l1</span> <span class="id">l2</span>: <span class="id">list</span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> (<span class="id">l1</span> ++ <span class="id">l2</span>) -&gt; <span class="id">In</span> <span class="id">x</span> <span class="id">l1</span> \/ <span class="id">In</span> <span class="id">x</span> <span class="id">l2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof79')">Proof.</div>
<div class="proofscript" id="proof79">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="id">left</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">IHl1</span> <span class="id">H</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">app_or_in_iff</span> (<span class="id">x</span>:<span class="id">A</span>) (<span class="id">l1</span> <span class="id">l2</span>: <span class="id">list</span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> (<span class="id">l1</span> ++ <span class="id">l2</span>) &lt;-&gt; <span class="id">In</span> <span class="id">x</span> <span class="id">l1</span> \/ <span class="id">In</span> <span class="id">x</span> <span class="id">l2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof80')">Proof.</div>
<div class="proofscript" id="proof80">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">app_or_in</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">in_or_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">in_or_not</span> (<span class="id">eqd</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">a</span>':<span class="id">A</span>, {<span class="id">a</span>=<span class="id">a</span>'} + {<span class="id">a</span>&lt;&gt;<span class="id">a</span>'}) (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) <span class="id">a</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">In</span> <span class="id">a</span> <span class="id">l</span>) \/ ~(<span class="id">In</span> <span class="id">a</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof81')">Proof.</div>
<div class="proofscript" id="proof81">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">intro</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">eqd</span> <span class="id">a0</span> <span class="id">a</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">a1</span> <span class="kwd">in</span> *; <span class="id">left</span>; <span class="id">left</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">IHl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>; <span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>; <span class="tactic">unfold</span> <span class="id">not</span> <span class="kwd">in</span> *; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H0</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">b</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">nin_app_or</span> (<span class="id">x</span>:<span class="id">A</span>) <span class="id">a</span> <span class="id">b</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(~ <span class="id">In</span> <span class="id">x</span> (<span class="id">a</span> ++ <span class="id">b</span>)) &lt;-&gt; (~ <span class="id">In</span> <span class="id">x</span> <span class="id">a</span> /\ ~ <span class="id">In</span> <span class="id">x</span> <span class="id">b</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof82')">Proof.</div>
<div class="proofscript" id="proof82">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>. <span class="tactic">apply</span> <span class="id">in_app_or</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">in_in_app_false</span> {<span class="id">l</span> <span class="id">l1</span> <span class="id">l2</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>:<span class="id">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> (<span class="id">l1</span> ++ <span class="id">l2</span>) -&gt; <span class="id">False</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l1</span> -&gt; <span class="id">False</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l2</span> -&gt; <span class="id">False</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof83')">Proof.</div>
<div class="proofscript" id="proof83">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intuition</span>; <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>; <span class="tactic">apply</span> <span class="id">in_app_iff</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">in_in_cons_app_false</span> {<span class="id">v</span> <span class="id">l</span> <span class="id">l1</span> <span class="id">l2</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>:<span class="id">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">v</span> = <span class="id">x</span> \/ <span class="id">In</span> <span class="id">x</span> (<span class="id">l1</span> ++ <span class="id">l2</span>) -&gt; <span class="id">False</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> (<span class="id">l1</span>) -&gt; <span class="id">False</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> (<span class="id">l2</span>) -&gt; <span class="id">False</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ (<span class="id">In</span> <span class="id">v</span> <span class="id">l</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof84')">Proof.</div>
<div class="proofscript" id="proof84">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intuition</span>; <span class="tactic">try</span> <span class="id">solve</span>[<span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">in_app_iff</span>; <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">in_in_cons_cons_app_app_false</span> {<span class="id">v</span> <span class="id">v0</span> <span class="id">l</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">l3</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>:<span class="id">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">v</span> = <span class="id">x</span> \/ <span class="id">v0</span> = <span class="id">x</span> \/ <span class="id">In</span> <span class="id">x</span> (<span class="id">l1</span> ++ <span class="id">l2</span> ++ <span class="id">l3</span>) -&gt; <span class="id">False</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l1</span> -&gt; <span class="id">False</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l2</span> -&gt; <span class="id">False</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l3</span> -&gt; <span class="id">False</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ (<span class="id">In</span> <span class="id">v</span> <span class="id">l</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ (<span class="id">In</span> <span class="id">v0</span> <span class="id">l</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof85')">Proof.</div>
<div class="proofscript" id="proof85">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intuition</span>; <span class="tactic">try</span> <span class="id">solve</span>[<span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">in_app_iff</span>; <span class="tactic">auto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id">In</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id">forallt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id">Forallt</span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">P</span> : <span class="id">A</span> -&gt; <span class="kwd">Type</span>) : <span class="id">list</span> <span class="id">A</span> -&gt; <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forallt_nil</span> : <span class="id">Forallt</span> <span class="id">P</span> <span class="id">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Forallt_cons</span> : <span class="kwd">forall</span> (<span class="id">x</span> : <span class="id">A</span>) (<span class="id">l</span> : <span class="id">list</span> <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id">x</span> -&gt; <span class="id">Forallt</span> <span class="id">P</span> <span class="id">l</span> -&gt; <span class="id">Forallt</span> <span class="id">P</span> (<span class="id">x</span> :: <span class="id">l</span>).<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">list_Forallt_eq_dec</span> {<span class="id">A</span>:<span class="kwd">Type</span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">c</span> <span class="id">l</span>: <span class="id">list</span> <span class="id">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forallt</span> (<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">A</span> =&gt; <span class="kwd">forall</span> <span class="id">y</span> : <span class="id">A</span>, {<span class="id">x</span> = <span class="id">y</span>} + {<span class="id">x</span> &lt;&gt; <span class="id">y</span>}) <span class="id">c</span> -&gt; {<span class="id">c</span> = <span class="id">l</span>} + {<span class="id">c</span> &lt;&gt; <span class="id">l</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof86')">Proof.</div>
<div class="proofscript" id="proof86">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">revert</span> <span class="id">l</span>; <span class="tactic">induction</span> <span class="id">c</span>; <span class="tactic">intros</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>;<span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">inversion</span> <span class="id">X</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">X0</span> <span class="id">a0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> (<span class="id">IHc</span> <span class="id">X1</span> <span class="id">l</span>);<span class="tactic">subst</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">inversion</span> 1; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>; <span class="tactic">inversion</span> 1; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">forallt_impl</span> {<span class="id">A</span>} {<span class="id">P1</span> <span class="id">P2</span>:<span class="id">A</span>-&gt;<span class="kwd">Type</span>} {<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forallt</span> <span class="id">P1</span> <span class="id">l</span> -&gt; <span class="id">Forallt</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">P1</span> <span class="id">x</span> -&gt; <span class="id">P2</span> <span class="id">x</span>) <span class="id">l</span> -&gt; <span class="id">Forallt</span> <span class="id">P2</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof87')">Proof.</div>
<div class="proofscript" id="proof87">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id">Forallt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 1; <span class="tactic">inversion</span> 1; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">forallt_weaken</span> {<span class="id">A</span>} <span class="id">P</span> : (<span class="kwd">forall</span> <span class="id">x</span>:<span class="id">A</span>, <span class="id">P</span> <span class="id">x</span>) -&gt; <span class="kwd">forall</span> <span class="id">l</span>, <span class="id">Forallt</span> <span class="id">P</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof88')">Proof.</div>
<div class="proofscript" id="proof88">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id">Forallt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>. <span class="tactic">apply</span> <span class="id">Forallt_nil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Forallt_cons</span>. <span class="tactic">apply</span> (<span class="id">X</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Forallt_inv</span>: <span class="kwd">forall</span> <span class="id">A</span> <span class="id">P</span> (<span class="id">a</span>:<span class="id">A</span>) <span class="id">l</span>, <span class="id">Forallt</span> <span class="id">P</span> (<span class="id">a</span> :: <span class="id">l</span>) -&gt; <span class="id">P</span> <span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof89')">Proof.</div>
<div class="proofscript" id="proof89">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">inversion</span> <span class="id">X</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Forallt_inv2</span>: <span class="kwd">forall</span> <span class="id">A</span> <span class="id">P</span> (<span class="id">a</span>:<span class="id">A</span>) <span class="id">l</span>, <span class="id">Forallt</span> <span class="id">P</span> (<span class="id">a</span> :: <span class="id">l</span>) -&gt; <span class="id">Forallt</span> <span class="id">P</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof90')">Proof.</div>
<div class="proofscript" id="proof90">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">inversion</span> <span class="id">X</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">RelationClasses</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">EquivDec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Equivalence</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Forallt_In</span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">P</span>:<span class="id">A</span>-&gt;<span class="kwd">Type</span>} {<span class="id">r</span>} {<span class="id">eq</span>:<span class="id">EqDec</span> <span class="id">A</span> <span class="id">eq</span>}: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forallt</span> <span class="id">P</span> <span class="id">r</span> -&gt; <span class="kwd">forall</span> <span class="id">a</span>, <span class="id">In</span> <span class="id">a</span> <span class="id">r</span> -&gt; <span class="id">P</span> <span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof91')">Proof.</div>
<div class="proofscript" id="proof91">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;Since&nbsp;equality&nbsp;is&nbsp;decidable,&nbsp;we&nbsp;can&nbsp;"rediscover"&nbsp;the&nbsp;components&nbsp;of&nbsp;the&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In&nbsp;relation&nbsp;(the&nbsp;‌\/&nbsp;lives&nbsp;in&nbsp;Prop)&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">x</span>==<span class="id">a</span>); <span class="tactic">unfold</span> <span class="id">equiv</span>, <span class="id">complement</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">In_dec</span> <span class="id">eq</span> <span class="id">a</span> <span class="id">l</span>); <span class="tactic">unfold</span> <span class="id">equiv</span>, <span class="id">complement</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> <span class="id">False</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Forall_app</span> {<span class="id">A</span>} (<span class="id">P</span>:<span class="id">A</span>-&gt;<span class="kwd">Prop</span>) (<span class="id">l1</span> <span class="id">l2</span>:<span class="id">list</span> <span class="id">A</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forall</span> <span class="id">P</span> <span class="id">l1</span> -&gt; <span class="id">Forall</span> <span class="id">P</span> <span class="id">l2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forall</span> <span class="id">P</span> (<span class="id">l1</span> ++ <span class="id">l2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof92')">Proof.</div>
<div class="proofscript" id="proof92">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Forall_forall</span> <span class="kwd">in</span> *; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">In</span> <span class="id">x</span> <span class="id">l1</span> \/ <span class="id">In</span> <span class="id">x</span> <span class="id">l2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">In_app</span>; <span class="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H2</span>; <span class="tactic">intros</span>; <span class="tactic">clear</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">H0</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Forall_app_inv</span> {<span class="id">A</span> : <span class="kwd">Type</span>} {<span class="id">P</span> : <span class="id">A</span> -&gt; <span class="kwd">Prop</span>} (<span class="id">l1</span> <span class="id">l2</span> : <span class="id">list</span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forall</span> <span class="id">P</span> (<span class="id">l1</span> ++ <span class="id">l2</span>) -&gt;   <span class="id">Forall</span> <span class="id">P</span> <span class="id">l1</span> /\ <span class="id">Forall</span> <span class="id">P</span> <span class="id">l2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof93')">Proof.</div>
<div class="proofscript" id="proof93">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Forall_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Finn</span>; <span class="tactic">split</span>; <span class="tactic">intros</span> ? <span class="id">inn</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">apply</span> <span class="id">Finn</span>; <span class="tactic">rewrite</span> <span class="id">in_app_iff</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Forall_map</span> {<span class="id">A</span> <span class="id">B</span>} <span class="id">P</span> (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">B</span>) <span class="id">l</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forall</span> <span class="id">P</span> (<span class="id">map</span> <span class="id">f</span> <span class="id">l</span>) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forall</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">P</span> (<span class="id">f</span> <span class="id">x</span>)) <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof94')">Proof.</div>
<div class="proofscript" id="proof94">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Forall_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">in_map_iff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">in_map_iff</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [? [??]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Forall_impl_in</span> {<span class="id">A</span>} {<span class="id">P</span> <span class="id">Q</span> : <span class="id">A</span> -&gt; <span class="kwd">Prop</span>} {<span class="id">l</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span>, <span class="id">In</span> <span class="id">a</span> <span class="id">l</span> -&gt; <span class="id">P</span> <span class="id">a</span> -&gt; <span class="id">Q</span> <span class="id">a</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forall</span> <span class="id">P</span> <span class="id">l</span> -&gt; <span class="id">Forall</span> <span class="id">Q</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof95')">Proof.</div>
<div class="proofscript" id="proof95">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">trivial</span>; <span class="tactic">simpl</span>; <span class="tactic">inversion</span> 2; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Forallt_Forall</span> {<span class="id">A</span>:<span class="kwd">Prop</span>} (<span class="id">P</span>:<span class="id">A</span>-&gt;<span class="kwd">Prop</span>) (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forallt</span> <span class="id">P</span> <span class="id">l</span> -&gt; <span class="id">Forall</span> <span class="id">P</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof96')">Proof.</div>
<div class="proofscript" id="proof96">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id">forallt</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id">forallb</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">forallb_ext</span> {<span class="id">A</span>} <span class="id">f1</span> <span class="id">f2</span> (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt; <span class="id">f1</span> <span class="id">x</span> = <span class="id">f2</span> <span class="id">x</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forallb</span> <span class="id">f1</span> <span class="id">l</span> = <span class="id">forallb</span> <span class="id">f2</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof97')">Proof.</div>
<div class="proofscript" id="proof97">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">forallb_incl</span> {<span class="id">A</span>} <span class="id">f</span> (<span class="id">l1</span> <span class="id">l2</span> : <span class="id">list</span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">incl</span> <span class="id">l1</span> <span class="id">l2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forallb</span> <span class="id">f</span> <span class="id">l2</span> = <span class="id">true</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forallb</span> <span class="id">f</span> <span class="id">l1</span> = <span class="id">true</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof98')">Proof.</div>
<div class="proofscript" id="proof98">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">incl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">forallb_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">forallb_app</span> {<span class="id">A</span>} (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">bool</span>) <span class="id">l1</span> <span class="id">l2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forallb</span> <span class="id">f</span> (<span class="id">l1</span> ++ <span class="id">l2</span>) = <span class="id">true</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">forallb</span> <span class="id">f</span> <span class="id">l1</span> = <span class="id">true</span> /\ <span class="id">forallb</span> <span class="id">f</span> <span class="id">l2</span> = <span class="id">true</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof99')">Proof.</div>
<div class="proofscript" id="proof99">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">forallb_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>; <span class="tactic">rewrite</span> <span class="id">in_app_iff</span> <span class="kwd">in</span> *; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">forallb_map</span> {<span class="id">A</span> <span class="id">B</span>} <span class="id">f</span> (<span class="id">mf</span>:<span class="id">A</span>-&gt;<span class="id">B</span>) <span class="id">m</span> : <span class="id">forallb</span> <span class="id">f</span> (<span class="id">map</span> <span class="id">mf</span> <span class="id">m</span>) = <span class="id">forallb</span> ((<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> (<span class="id">mf</span> <span class="id">x</span>))) <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof100')">Proof.</div>
<div class="proofscript" id="proof100">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">existsb_not_forallb</span> {<span class="id">A</span>} <span class="id">f</span> (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id">existsb</span> <span class="id">f</span> <span class="id">l</span> = <span class="id">negb</span> (<span class="id">forallb</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">negb</span> (<span class="id">f</span> <span class="id">x</span>)) <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof101')">Proof.</div>
<div class="proofscript" id="proof101">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">a</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">forallb_not_existb</span> {<span class="id">A</span>} <span class="id">f</span> (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id">forallb</span> <span class="id">f</span> <span class="id">l</span> = <span class="id">negb</span> (<span class="id">existsb</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">negb</span> (<span class="id">f</span> <span class="id">x</span>)) <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof102')">Proof.</div>
<div class="proofscript" id="proof102">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">a</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">map_eq</span> {<span class="id">A</span> <span class="id">B</span>} {<span class="id">f</span> <span class="id">g</span>:<span class="id">A</span>-&gt;<span class="id">B</span>} {<span class="id">l</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forall</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> <span class="id">x</span> = <span class="id">g</span> <span class="id">x</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span> <span class="id">f</span> <span class="id">l</span> = <span class="id">map</span> <span class="id">g</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof103')">Proof.</div>
<div class="proofscript" id="proof103">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 1; <span class="tactic">simpl</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">map_cons</span> {<span class="id">A</span> <span class="id">B</span>:<span class="kwd">Type</span>} (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">B</span>) (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) (<span class="id">a</span>:<span class="id">A</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span> <span class="id">f</span> (<span class="id">a</span>::<span class="id">l</span>) = (<span class="id">f</span> <span class="id">a</span>)::<span class="id">map</span> <span class="id">f</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof104')">Proof.</div>
<div class="proofscript" id="proof104">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">map_eq_cons</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>) (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) <span class="id">b</span> <span class="id">l</span>' :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span> <span class="id">f</span> <span class="id">l</span> = <span class="id">b</span>::<span class="id">l</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">a</span> : <span class="id">A</span> &amp; {<span class="id">ls</span>:<span class="id">list</span> <span class="id">A</span> | <span class="id">l</span> = <span class="id">a</span>::<span class="id">ls</span> /\<span class="id">f</span> <span class="id">a</span> = <span class="id">b</span> /\ <span class="id">map</span> <span class="id">f</span> <span class="id">ls</span> = <span class="id">l</span>'}}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof105')">Proof.</div>
<div class="proofscript" id="proof105">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id">forallb</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id">pairs</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">pair_eq_dec</span> {<span class="id">A</span> <span class="id">B</span>:<span class="kwd">Type</span>} (<span class="id">a1</span>:<span class="id">A</span>) (<span class="id">b1</span>:<span class="id">B</span>) (<span class="id">a2</span>:<span class="id">A</span>) (<span class="id">b2</span>:<span class="id">B</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">a1</span> = <span class="id">a2</span>} + {<span class="id">a1</span> &lt;&gt; <span class="id">a2</span>} -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">b1</span> = <span class="id">b2</span>} + {<span class="id">b1</span> &lt;&gt; <span class="id">b2</span>} -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{(<span class="id">a1</span>, <span class="id">b1</span>) = (<span class="id">a2</span>, <span class="id">b2</span>)} + {(<span class="id">a1</span>, <span class="id">b1</span>) &lt;&gt; (<span class="id">a2</span>, <span class="id">b2</span>)}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof106')">Proof.</div>
<div class="proofscript" id="proof106">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> 1; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> 1; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">inversion</span> 1; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>; <span class="tactic">inversion</span> 1; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Require</span> <span class="id">String</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id">string_eqdec</span> : <span class="id">EqDec</span> <span class="id">String.string</span> <span class="id">eq</span> := <span class="id">String.string_dec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id">pair_eqdec</span> {<span class="id">A</span> <span class="id">B</span>} `{<span class="id">EqDec</span> <span class="id">A</span> <span class="id">eq</span>} `{<span class="id">EqDec</span> <span class="id">B</span> <span class="id">eq</span>} : <span class="id">EqDec</span> (<span class="id">prod</span> <span class="id">A</span> <span class="id">B</span>) <span class="id">eq</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof107')">Proof.</div>
<div class="proofscript" id="proof107">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">complement</span>, <span class="id">equiv</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">pair_eq_dec</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id">option_eqdec</span> {<span class="id">A</span>:<span class="kwd">Type</span>} `{<span class="id">EqDec</span> <span class="id">A</span> <span class="id">eq</span>}: <span class="id">EqDec</span> (<span class="id">option</span> <span class="id">A</span>) <span class="id">eq</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof108')">Proof.</div>
<div class="proofscript" id="proof108">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">unfold</span> <span class="id">equiv</span>, <span class="id">complement</span>; <span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">try</span> <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">a</span> == <span class="id">a0</span>); <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id">pairs</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Omega</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id">arith</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">min_zero</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">n1</span> <span class="id">n2</span>:<span class="id">nat</span>), <span class="id">min</span> <span class="id">n1</span> (<span class="id">S</span> <span class="id">n2</span>) = 0 -&gt; <span class="id">n1</span> = 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof109')">Proof.</div>
<div class="proofscript" id="proof109">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> (<span class="id">n3</span>:<span class="id">nat</span>), <span class="id">min</span> (<span class="id">S</span> <span class="id">n1</span>) (<span class="id">S</span> <span class="id">n2</span>) = (<span class="id">S</span> <span class="id">n3</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">min</span> <span class="id">n1</span> <span class="id">n2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Min.succ_min_distr</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H0</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">min_against_one</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">n</span>:<span class="id">nat</span>), <span class="id">min</span> <span class="id">n</span> 1 = 0 \/ <span class="id">min</span> <span class="id">n</span> 1 = 1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof110')">Proof.</div>
<div class="proofscript" id="proof110">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">IHn</span>; <span class="tactic">intro</span>; <span class="tactic">clear</span> <span class="id">IHn</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">compare_either</span> (<span class="id">n1</span> <span class="id">n2</span>:<span class="id">nat</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">n1</span> &lt;= <span class="id">n2</span>) \/ (<span class="id">n2</span> &lt;= <span class="id">n1</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof111')">Proof.</div>
<div class="proofscript" id="proof111">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">min_one_yields_one</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>:<span class="id">nat</span>, <span class="id">min</span> <span class="id">n</span> 1 = 1 -&gt; 1 &lt;= <span class="id">n</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof112')">Proof.</div>
<div class="proofscript" id="proof112">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">fold_left_arith_dist1</span> {<span class="id">A</span>} (<span class="id">x0</span>:<span class="id">nat</span>) (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) (<span class="id">f</span>:<span class="id">A</span> -&gt; <span class="id">nat</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fold_left</span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id">nat</span>) (<span class="id">y</span>:<span class="id">A</span>) =&gt; (<span class="id">f</span> <span class="id">y</span>) + <span class="id">x</span>) <span class="id">l</span> <span class="id">x0</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fold_left</span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id">nat</span>) (<span class="id">y</span>:<span class="id">A</span>) =&gt; (<span class="id">f</span> <span class="id">y</span>) + <span class="id">x</span>) <span class="id">l</span> 0) + <span class="id">x0</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof113')">Proof.</div>
<div class="proofscript" id="proof113">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">x0</span>; <span class="tactic">simpl</span>; <span class="tactic">induction</span> <span class="id">l</span>; [<span class="tactic">reflexivity</span>|<span class="id">idtac</span>]; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">IHl</span> (<span class="id">f</span> <span class="id">a</span> + 0)); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">IHl</span> (<span class="id">f</span> <span class="id">a</span> + <span class="id">x0</span>)); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">fold_left_arith_dist2</span> {<span class="id">A</span>} (<span class="id">x0</span> <span class="id">n0</span>:<span class="id">nat</span>) (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) (<span class="id">f</span>:<span class="id">A</span> -&gt; <span class="id">nat</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fold_left</span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id">nat</span>) (<span class="id">y</span>:<span class="id">A</span>) =&gt; <span class="id">n0</span> * (<span class="id">f</span> <span class="id">y</span>) + <span class="id">x</span>) <span class="id">l</span> <span class="id">x0</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n0</span> * (<span class="id">fold_left</span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id">nat</span>) (<span class="id">y</span>:<span class="id">A</span>) =&gt; (<span class="id">f</span> <span class="id">y</span>) + <span class="id">x</span>) <span class="id">l</span> 0) + <span class="id">x0</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof114')">Proof.</div>
<div class="proofscript" id="proof114">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">x0</span>; <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">IHl</span> (<span class="id">n0</span> * <span class="id">f</span> <span class="id">a</span> + <span class="id">x0</span>)); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">fold_left_arith_dist1</span> (<span class="id">f</span> <span class="id">a</span> + 0)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">mult_plus_distr_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">mult_plus_distr_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">fold_left_arith_dist3</span> {<span class="id">A</span>} (<span class="id">x0</span> <span class="id">n0</span>:<span class="id">nat</span>) (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) (<span class="id">f</span>:<span class="id">A</span> -&gt; <span class="id">nat</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n0</span> * (<span class="id">fold_left</span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id">nat</span>) (<span class="id">y</span>:<span class="id">A</span>) =&gt; (<span class="id">f</span> <span class="id">y</span>) + <span class="id">x</span>) <span class="id">l</span> 0) + <span class="id">x0</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n0</span> * (<span class="id">fold_left</span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id">nat</span>) (<span class="id">y</span>:<span class="id">A</span>) =&gt; <span class="id">x</span> + (<span class="id">f</span> <span class="id">y</span>)) <span class="id">l</span> 0) + <span class="id">x0</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof115')">Proof.</div>
<div class="proofscript" id="proof115">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">x0</span>; <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">f</span> <span class="id">a</span> + <span class="id">n</span> = <span class="id">n</span> + <span class="id">f</span> <span class="id">a</span>) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id">plus_comm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">IHl</span> <span class="id">x0</span> (<span class="id">n</span> + <span class="id">f</span> <span class="id">a</span>)); <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">fold_left_arith_dist4</span> {<span class="id">A</span>} (<span class="id">x0</span> <span class="id">n0</span>:<span class="id">nat</span>) (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) (<span class="id">f</span>:<span class="id">A</span> -&gt; <span class="id">nat</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fold_left</span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id">nat</span>) (<span class="id">y</span>:<span class="id">A</span>) =&gt; <span class="id">n0</span> * (<span class="id">f</span> <span class="id">y</span>) + <span class="id">x</span>) <span class="id">l</span> <span class="id">x0</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n0</span> * (<span class="id">fold_left</span> (<span class="kwd">fun</span> (<span class="id">x</span>:<span class="id">nat</span>) (<span class="id">y</span>:<span class="id">A</span>) =&gt; <span class="id">x</span> + (<span class="id">f</span> <span class="id">y</span>)) <span class="id">l</span> 0) + <span class="id">x0</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof116')">Proof.</div>
<div class="proofscript" id="proof116">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">fold_left_arith_dist3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">fold_left_arith_dist2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id">arith</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id">Zutil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">ZArith</span> <span class="id">Zdigits</span> <span class="id">Znat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">Z_scope</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">ZToSignedNat</span> (<span class="id">z</span>:<span class="id">Z</span>) : (<span class="id">bool</span>*<span class="id">nat</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> (<span class="id">Z.sgn</span> <span class="id">z</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| -1 =&gt; (<span class="id">false</span>,(<span class="id">Z.to_nat</span> <span class="id">z</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; (<span class="id">true</span>, (<span class="id">Z.to_nat</span> <span class="id">z</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">pos_succ_inv</span> (<span class="id">n1</span> <span class="id">n2</span>:<span class="id">positive</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Pos.succ</span> <span class="id">n1</span> = <span class="id">Pos.succ</span> <span class="id">n2</span> -&gt; <span class="id">n1</span> = <span class="id">n2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof117')">Proof.</div>
<div class="proofscript" id="proof117">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Pos.succ_inj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Pos_of_nat_inv</span> (<span class="id">n1</span> <span class="id">n2</span>:<span class="id">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Pos.of_nat</span> (<span class="id">S</span> <span class="id">n1</span>) = <span class="id">Pos.of_nat</span> (<span class="id">S</span> <span class="id">n2</span>) -&gt; <span class="id">n1</span> = <span class="id">n2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof118')">Proof.</div>
<div class="proofscript" id="proof118">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">of_nat_succ</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">n2</span> <span class="id">H</span>; <span class="tactic">induction</span> <span class="id">n1</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n2</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> <span class="id">False</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">Pos.succ_not_1</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">not</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H0</span> (<span class="id">Pos.succ</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n2</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0%<span class="id">nat</span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">S</span> <span class="id">_</span> =&gt; <span class="id">Pos.succ</span> (<span class="id">Pos.of_nat</span> <span class="id">n2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)). <span class="tactic">rewrite</span> &lt;- <span class="id">H</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHn1</span> (<span class="id">pred</span> <span class="id">n2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n1</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> <span class="id">False</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">Pos.succ_not_1</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">not</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H0</span> (<span class="id">Pos.succ</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">n1</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0%<span class="id">nat</span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">S</span> <span class="id">_</span> =&gt; <span class="id">Pos.succ</span> (<span class="id">Pos.of_nat</span> <span class="id">n1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>)). <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHn1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">pos_succ_inv</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">of_nat_inv</span> (<span class="id">n1</span> <span class="id">n2</span>:<span class="id">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Z.of_nat</span> <span class="id">n1</span> = <span class="id">Z.of_nat</span> <span class="id">n2</span> -&gt; <span class="id">n1</span> = <span class="id">n2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof119')">Proof.</div>
<div class="proofscript" id="proof119">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Z.of_nat</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n1</span>; <span class="tactic">destruct</span> <span class="id">n2</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Pos.of_nat_succ</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Pos.of_nat_succ</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">Pos_of_nat_inv</span> <span class="id">n1</span> <span class="id">n2</span> <span class="id">H1</span>); <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">pos_succ_nat_inv</span> (<span class="id">n1</span> <span class="id">n2</span>:<span class="id">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Pos.of_succ_nat</span> <span class="id">n1</span> = <span class="id">Pos.of_succ_nat</span> <span class="id">n2</span> -&gt; <span class="id">n1</span> = <span class="id">n2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof120')">Proof.</div>
<div class="proofscript" id="proof120">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Pos.of_nat_succ</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Pos_of_nat_inv</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id">Z_eqdec</span> : <span class="id">EqDec</span> <span class="id">Z</span> <span class="id">eq</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof121')">Proof.</div>
<div class="proofscript" id="proof121">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Z.eq_dec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id">Zutil</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id">iter</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">repeat_plus</span> {<span class="id">A</span>} (<span class="id">x</span>:<span class="id">A</span>) (<span class="id">n1</span> <span class="id">n2</span>:<span class="id">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">x</span> (<span class="id">n1</span>+<span class="id">n2</span>) = <span class="tactic">repeat</span> <span class="id">x</span> <span class="id">n1</span> ++ <span class="tactic">repeat</span> <span class="id">x</span> <span class="id">n2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof122')">Proof.</div>
<div class="proofscript" id="proof122">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">n1</span>; <span class="tactic">simpl</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id">iter</span> {<span class="id">A</span>} (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">iterations</span>:<span class="id">nat</span>) (<span class="id">a</span>:<span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">iterations</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">S</span> <span class="id">n</span> =&gt; <span class="id">iter</span> <span class="id">f</span> <span class="id">n</span> (<span class="id">f</span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">iter_fold_left_list</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">l</span>:<span class="id">list</span> <span class="id">B</span>) (<span class="id">a</span>:<span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id">iter</span> <span class="id">f</span> (<span class="id">length</span> <span class="id">l</span>) <span class="id">a</span> = <span class="id">fold_left</span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id">f</span> <span class="id">x</span>) <span class="id">l</span> <span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof123')">Proof.</div>
<div class="proofscript" id="proof123">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">iter_fold_left_repeat</span> {<span class="id">A</span>} (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">iterations</span>:<span class="id">nat</span>) (<span class="id">a</span>:<span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id">iter</span> <span class="id">f</span> <span class="id">iterations</span> <span class="id">a</span> = <span class="id">fold_left</span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id">f</span> <span class="id">x</span>) (<span class="tactic">repeat</span> 0 <span class="id">iterations</span>) <span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof124')">Proof.</div>
<div class="proofscript" id="proof124">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">iter_fold_left_list</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">repeat_length</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">iter_fold_right_list</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">l</span>:<span class="id">list</span> <span class="id">B</span>) (<span class="id">a</span>:<span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id">iter</span> <span class="id">f</span> (<span class="id">length</span> <span class="id">l</span>) <span class="id">a</span> = <span class="id">fold_right</span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id">f</span> <span class="id">y</span>) <span class="id">a</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof125')">Proof.</div>
<div class="proofscript" id="proof125">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id">rev_involutive</span> <span class="id">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">fold_left_rev_right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">rev_length</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">iter_fold_left_list</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">iter_plus</span> {<span class="id">A</span>} (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">A</span>) (<span class="id">iterations1</span> <span class="id">iterations2</span>:<span class="id">nat</span>) (<span class="id">a</span>:<span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">iter</span> <span class="id">f</span> (<span class="id">iterations1</span>+<span class="id">iterations2</span>) <span class="id">a</span> = <span class="id">iter</span> <span class="id">f</span> <span class="id">iterations2</span> (<span class="id">iter</span> <span class="id">f</span> <span class="id">iterations1</span> <span class="id">a</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof126')">Proof.</div>
<div class="proofscript" id="proof126">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">iter_fold_left_repeat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">repeat_plus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">fold_left_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">iter_trans</span> {<span class="id">A</span>} (<span class="id">R</span>:<span class="id">relation</span> <span class="id">A</span>) {<span class="id">pre</span>:<span class="id">PreOrder</span> <span class="id">R</span>} <span class="id">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">pf</span>:<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">R</span> <span class="id">x</span> (<span class="id">f</span> <span class="id">x</span>)) (<span class="id">iterations</span>:<span class="id">nat</span>) <span class="id">a</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">R</span> <span class="id">a</span> (<span class="id">iter</span> <span class="id">f</span> <span class="id">iterations</span> <span class="id">a</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof127')">Proof.</div>
<div class="proofscript" id="proof127">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">iterations</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">etransitivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id">iter</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id">cost</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Recdef</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Compare_dec</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span>:<span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Function</span> <span class="id">iter_cost</span> (<span class="id">optim</span>: <span class="id">A</span> -&gt; <span class="id">A</span>) (<span class="id">cost</span>: <span class="id">A</span> -&gt; <span class="id">nat</span>) (<span class="id">p</span>: <span class="id">A</span>) { <span class="kwd">measure</span> <span class="id">cost</span> <span class="id">p</span> } :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">p</span>' := <span class="id">optim</span> <span class="id">p</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">lt_dec</span> (<span class="id">cost</span> <span class="id">p</span>') (<span class="id">cost</span> <span class="id">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id">iter_cost</span> <span class="id">optim</span> <span class="id">cost</span> <span class="id">p</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id">p</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof128')">Proof.</div>
<div class="proofscript" id="proof128">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">optim</span> <span class="id">cost</span> <span class="id">p</span> <span class="id">Hcmp</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">iter_cost_trans</span> (<span class="id">R</span>:<span class="id">relation</span> <span class="id">A</span>) {<span class="id">pre</span>:<span class="id">PreOrder</span> <span class="id">R</span>} <span class="id">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">pf</span>:<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">R</span> <span class="id">x</span> (<span class="id">f</span> <span class="id">x</span>)) (<span class="id">cost</span>:<span class="id">A</span>-&gt;<span class="id">nat</span>) <span class="id">a</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">R</span> <span class="id">a</span> (<span class="id">iter_cost</span> <span class="id">f</span> <span class="id">cost</span> <span class="id">a</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof129')">Proof.</div>
<div class="proofscript" id="proof129">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">iter_cost_ind</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">etransitivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id">cost</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id">vm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">is_true</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">x</span>:{<span class="id">A</span>}+{<span class="id">B</span>}) : <span class="id">bool</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Eval</span> <span class="id">vm_compute</span> <span class="kwd">in</span> (<span class="kwd">if</span> <span class="id">x</span> <span class="kwd">then</span> <span class="id">true</span> <span class="kwd">else</span> <span class="id">false</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">holds</span> {<span class="id">A</span> <span class="id">B</span>} (<span class="id">x</span>:{<span class="id">A</span>}+{<span class="id">B</span>}) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">is_true</span> <span class="id">x</span> = <span class="id">true</span>.<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id">vm</span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id">RUtil</span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="id">String</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">move_to_top</span> <span class="id">x</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">reverse</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">H</span> : <span class="id">_</span> |- <span class="id">_</span> =&gt; <span class="tactic">try</span> <span class="tactic">move</span> <span class="id">x</span> <span class="id">after</span> <span class="id">H</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">assert_eq</span>" <span class="id">ident</span>(<span class="id">x</span>) <span class="id">constr</span>(<span class="id">v</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">H</span> := <span class="tactic">fresh</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">x</span> = <span class="id">v</span>) <span class="kwd">as</span> <span class="id">H</span> <span class="tactic">by</span> <span class="tactic">reflexivity</span>;<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H</span>.<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">Case_aux</span>" <span class="id">ident</span>(<span class="id">x</span>) <span class="id">constr</span>(<span class="id">name</span>) :=<br/>
&nbsp;&nbsp;<span class="id">first</span> [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">x</span> := <span class="id">name</span>); <span class="id">move_to_top</span> <span class="id">x</span><br/>
&nbsp;&nbsp;| <span class="id">assert_eq</span> <span class="id">x</span> <span class="id">name</span>; <span class="id">move_to_top</span> <span class="id">x</span><br/>
&nbsp;&nbsp;| <span class="tactic">fail</span> 1 "<span class="id">because</span> <span class="id">we</span> <span class="id">are</span> <span class="id">working</span> <span class="id">on</span> <span class="id">a</span> <span class="id">different</span> <span class="tactic">case</span>" ].<br/>
<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">Case</span>" <span class="id">constr</span>(<span class="id">name</span>) := <span class="id">Case_aux</span> <span class="id">Case</span> <span class="id">name</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">SCase</span>" <span class="id">constr</span>(<span class="id">name</span>) := <span class="id">Case_aux</span> <span class="id">SCase</span> <span class="id">name</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">SSCase</span>" <span class="id">constr</span>(<span class="id">name</span>) := <span class="id">Case_aux</span> <span class="id">SSCase</span> <span class="id">name</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">SSSCase</span>" <span class="id">constr</span>(<span class="id">name</span>) := <span class="id">Case_aux</span> <span class="id">SSSCase</span> <span class="id">name</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">SSSSCase</span>" <span class="id">constr</span>(<span class="id">name</span>) := <span class="id">Case_aux</span> <span class="id">SSSSCase</span> <span class="id">name</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">SSSSSCase</span>" <span class="id">constr</span>(<span class="id">name</span>) := <span class="id">Case_aux</span> <span class="id">SSSSSCase</span> <span class="id">name</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">SSSSSSCase</span>" <span class="id">constr</span>(<span class="id">name</span>) := <span class="id">Case_aux</span> <span class="id">SSSSSSCase</span> <span class="id">name</span>.<br/>
<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">SSSSSSSCase</span>" <span class="id">constr</span>(<span class="id">name</span>) := <span class="id">Case_aux</span> <span class="id">SSSSSSSCase</span> <span class="id">name</span>.<br/>
<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">notHyp</span> <span class="id">P</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id">_</span> : <span class="id">P</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">extend</span> <span class="id">P</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">t</span> := <span class="id">type</span> <span class="id">of</span> <span class="id">P</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">notHyp</span> <span class="id">t</span>; <span class="tactic">generalize</span> <span class="id">P</span>; <span class="tactic">intro</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">match_destr</span><br/>
&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> [|- <span class="id">context</span> [<span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span>]] =&gt; <span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">end</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">match_destr_in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span> <span class="id">context</span> [<span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span>] =&gt; <span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">end</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">match_case</span><br/>
&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> [|- <span class="id">context</span> [<span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span>]] =&gt; <span class="id">case_eq</span> <span class="id">x</span> <span class="kwd">end</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">match_case_in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span> <span class="id">context</span> [<span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span>] =&gt; <span class="id">case_eq</span> <span class="id">x</span> <span class="kwd">end</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">cut_to</span> <span class="id">H</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> -&gt; <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> -&gt; ?<span class="id">b</span> =&gt; <span class="tactic">cut</span> (<span class="id">b</span>); [<span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">H</span>|<span class="tactic">apply</span> <span class="id">H</span>]<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">invcs</span> <span class="id">H</span> := <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">subst</span>.<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">String</span>.<br/>
<span class="kwd">Definition</span> <span class="id">brand</span> := <span class="id">string</span>.<br/>
<br/>
<span class="kwd">Class</span> <span class="id">ToString</span> (<span class="id">A</span>:<span class="kwd">Type</span>)<br/>
&nbsp;&nbsp;:= {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">toString</span> (<span class="id">a</span>:<span class="id">A</span>) : <span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
