
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Qcert.Basic.TypeSystem.RType</title>
<meta name="description" content="Documentation of Coq module Qcert.Basic.TypeSystem.RType" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Qcert.Basic.TypeSystem.RType</h1>
<div class="coq">
<br/>
<span class="kwd">Section</span> <span class="id">RType</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">String</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">List</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Sorting</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Eqdep_dec</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Bool</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">EquivDec</span> <span class="id">Morphisms</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">BrandRelation</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">ForeignType</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Utils</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id">record_kind</span> : <span class="kwd">Set</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
<div class="doc">open records allow width subtyping: they can have additional fields not in the type description </div>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="kwd">Open</span><br/>
<div class="doc">closed records do not allow width subtyping.  They must have exactly the specified fields. </div>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Closed</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id">record_kind_eqdec</span> : <span class="id">EqDec</span> <span class="id">record_kind</span> <span class="id">eq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> ({<span class="id">x</span>=<span class="id">y</span>} + {<span class="id">x</span>&lt;&gt;<span class="id">y</span>}).<br/>
&nbsp;&nbsp;<span class="id">decide</span> <span class="id">equality</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id">rtypes</span>₀.<br/>
<br/>
<div class="doc">Syntax of types. Note that there is no guarantee yet that records are well formed. i.e., having distinct fields. </div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">ftype</span>:<span class="id">foreign_type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Unset</span> <span class="id">Elimination</span> <span class="id">Schemes</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id">rtype</span>₀ : <span class="kwd">Set</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Bottom</span>₀ : <span class="id">rtype</span>₀<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Top</span>₀ : <span class="id">rtype</span>₀<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Unit</span>₀ : <span class="id">rtype</span>₀<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Nat</span>₀ : <span class="id">rtype</span>₀<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Bool</span>₀ : <span class="id">rtype</span>₀<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span>₀ : <span class="id">rtype</span>₀<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Coll</span>₀ (<span class="id">r</span>:<span class="id">rtype</span>₀) : <span class="id">rtype</span>₀<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Rec</span>₀ (<span class="id">k</span>:<span class="id">record_kind</span>) (<span class="id">srl</span>:<span class="id">list</span> (<span class="id">string</span>* <span class="id">rtype</span>₀)) : <span class="id">rtype</span>₀<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Either</span>₀ (<span class="id">tl</span> <span class="id">tr</span>:<span class="id">rtype</span>₀) : <span class="id">rtype</span>₀<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Arrow</span>₀ (<span class="id">tin</span> <span class="id">tout</span> : <span class="id">rtype</span>₀) : <span class="id">rtype</span>₀<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Brand</span>₀ : <span class="id">brands</span> -&gt; <span class="id">rtype</span>₀<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Foreign</span>₀ (<span class="id">ft</span>:<span class="id">foreign_type_type</span>) : <span class="id">rtype</span>₀.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Set</span> <span class="id">Elimination</span> <span class="id">Schemes</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Notation</span> "⊥₀" := <span class="id">Bottom</span>₀.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Notation</span> "⊤₀" := <span class="id">Top</span>₀.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">rtype</span>₀<span class="id">_rect</span> (<span class="id">P</span> : <span class="id">rtype</span>₀ -&gt; <span class="kwd">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ftop</span> : <span class="id">P</span> ⊤₀)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fbottom</span> : <span class="id">P</span> ⊥₀)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">funit</span> : <span class="id">P</span> <span class="id">Unit</span>₀)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fnat</span> : <span class="id">P</span> <span class="id">Nat</span>₀)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fbool</span> : <span class="id">P</span> <span class="id">Bool</span>₀)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fstring</span> : <span class="id">P</span> <span class="id">String</span>₀)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fcol</span> : <span class="kwd">forall</span> <span class="id">t</span> : <span class="id">rtype</span>₀, <span class="id">P</span> <span class="id">t</span> -&gt; <span class="id">P</span> (<span class="id">Coll</span>₀ <span class="id">t</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">frec</span> : <span class="kwd">forall</span> (<span class="id">k</span>:<span class="id">record_kind</span>) (<span class="id">r</span> : <span class="id">list</span> (<span class="id">string</span> * <span class="id">rtype</span>₀)), <span class="id">Forallt</span> (<span class="kwd">fun</span> <span class="id">ab</span> =&gt; <span class="id">P</span> (<span class="id">snd</span> <span class="id">ab</span>)) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id">Rec</span>₀ <span class="id">k</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">feither</span> : <span class="kwd">forall</span> <span class="id">l</span> <span class="id">r</span>, <span class="id">P</span> <span class="id">l</span> -&gt; <span class="id">P</span> <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id">Either</span>₀ <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">farrow</span> : <span class="kwd">forall</span> <span class="id">tin</span> <span class="id">tout</span>, <span class="id">P</span> <span class="id">tin</span> -&gt; <span class="id">P</span> <span class="id">tout</span> -&gt; <span class="id">P</span> (<span class="id">Arrow</span>₀ <span class="id">tin</span> <span class="id">tout</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fbrand</span> : <span class="kwd">forall</span> <span class="id">b</span>, <span class="id">P</span> (<span class="id">Brand</span>₀ <span class="id">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fforeign</span> : <span class="kwd">forall</span> <span class="id">ft</span>, <span class="id">P</span> (<span class="id">Foreign</span>₀ <span class="id">ft</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fix</span> <span class="id">F</span> (<span class="id">t</span> : <span class="id">rtype</span>₀) : <span class="id">P</span> <span class="id">t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">t</span> <span class="kwd">as</span> <span class="id">t0</span> <span class="kwd">return</span> (<span class="id">P</span> <span class="id">t0</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ⊤₀ =&gt; <span class="id">ftop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ⊥₀ =&gt; <span class="id">fbottom</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Unit</span>₀ =&gt; <span class="id">funit</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Nat</span>₀ =&gt; <span class="id">fnat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Bool</span>₀ =&gt; <span class="id">fbool</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span>₀ =&gt; <span class="id">fstring</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Coll</span>₀ <span class="id">x</span> =&gt; <span class="id">fcol</span> <span class="id">x</span> (<span class="id">F</span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Rec</span>₀ <span class="id">k</span> <span class="id">x</span> =&gt; <span class="id">frec</span> <span class="id">k</span> <span class="id">x</span> ((<span class="id">fix</span> <span class="id">Frec</span> (<span class="id">r</span> : <span class="id">list</span> (<span class="id">string</span> * <span class="id">rtype</span>₀)) : <span class="id">Forallt</span> (<span class="kwd">fun</span> <span class="id">ab</span> =&gt; <span class="id">P</span> (<span class="id">snd</span> <span class="id">ab</span>)) <span class="id">r</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">r</span> <span class="kwd">as</span> <span class="id">c0</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">nil</span> =&gt; <span class="id">Forallt_nil</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">cons</span> <span class="id">sd</span> <span class="id">c0</span> =&gt; @<span class="id">Forallt_cons</span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">ab</span> =&gt; <span class="id">P</span> (<span class="id">snd</span> <span class="id">ab</span>)) <span class="id">sd</span> <span class="id">c0</span> (<span class="id">F</span> (<span class="id">snd</span> <span class="id">sd</span>)) (<span class="id">Frec</span> <span class="id">c0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Either</span>₀ <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">feither</span> <span class="id">l</span> <span class="id">r</span> (<span class="id">F</span> <span class="id">l</span>) (<span class="id">F</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Arrow</span>₀ <span class="id">tin</span> <span class="id">tout</span> =&gt; <span class="id">farrow</span> <span class="id">tin</span> <span class="id">tout</span> (<span class="id">F</span> <span class="id">tin</span>) (<span class="id">F</span> <span class="id">tout</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Brand</span>₀ <span class="id">b</span> =&gt; <span class="id">fbrand</span> <span class="id">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Foreign</span>₀ <span class="id">ft</span> =&gt; <span class="id">fforeign</span> <span class="id">ft</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">rtype</span>₀<span class="id">_ind</span> (<span class="id">P</span> : <span class="id">rtype</span>₀ -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ftop</span> : <span class="id">P</span> ⊤₀)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fbottom</span> : <span class="id">P</span> ⊥₀)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">funit</span> : <span class="id">P</span> <span class="id">Unit</span>₀)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fnat</span> : <span class="id">P</span> <span class="id">Nat</span>₀)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fbool</span> : <span class="id">P</span> <span class="id">Bool</span>₀)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fstring</span> : <span class="id">P</span> <span class="id">String</span>₀)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fcol</span> : <span class="kwd">forall</span> <span class="id">t</span> : <span class="id">rtype</span>₀, <span class="id">P</span> <span class="id">t</span> -&gt; <span class="id">P</span> (<span class="id">Coll</span>₀ <span class="id">t</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">frec</span> : <span class="kwd">forall</span> (<span class="id">k</span>:<span class="id">record_kind</span>) (<span class="id">r</span> : <span class="id">list</span> (<span class="id">string</span> * <span class="id">rtype</span>₀)), <span class="id">Forall</span> (<span class="kwd">fun</span> <span class="id">ab</span> =&gt; <span class="id">P</span> (<span class="id">snd</span> <span class="id">ab</span>)) <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id">Rec</span>₀ <span class="id">k</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">feither</span> : <span class="kwd">forall</span> <span class="id">l</span> <span class="id">r</span>, <span class="id">P</span> <span class="id">l</span> -&gt; <span class="id">P</span> <span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id">Either</span>₀ <span class="id">l</span> <span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">farrow</span> : <span class="kwd">forall</span> <span class="id">tin</span> <span class="id">tout</span>, <span class="id">P</span> <span class="id">tin</span> -&gt; <span class="id">P</span> <span class="id">tout</span> -&gt; <span class="id">P</span> (<span class="id">Arrow</span>₀ <span class="id">tin</span> <span class="id">tout</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fbrand</span> : <span class="kwd">forall</span> <span class="id">b</span>, <span class="id">P</span> (<span class="id">Brand</span>₀ <span class="id">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fforeign</span> : <span class="kwd">forall</span> <span class="id">ft</span>, <span class="id">P</span> (<span class="id">Foreign</span>₀ <span class="id">ft</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fix</span> <span class="id">F</span> (<span class="id">t</span> : <span class="id">rtype</span>₀) : <span class="id">P</span> <span class="id">t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">t</span> <span class="kwd">as</span> <span class="id">t0</span> <span class="kwd">return</span> (<span class="id">P</span> <span class="id">t0</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ⊤₀ =&gt; <span class="id">ftop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ⊥₀ =&gt; <span class="id">fbottom</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Unit</span>₀ =&gt; <span class="id">funit</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Nat</span>₀ =&gt; <span class="id">fnat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Bool</span>₀ =&gt; <span class="id">fbool</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span>₀ =&gt; <span class="id">fstring</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Coll</span>₀ <span class="id">x</span> =&gt; <span class="id">fcol</span> <span class="id">x</span> (<span class="id">F</span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Rec</span>₀ <span class="id">k</span> <span class="id">x</span> =&gt; <span class="id">frec</span> <span class="id">k</span> <span class="id">x</span> ((<span class="id">fix</span> <span class="id">Frec</span> (<span class="id">r</span> : <span class="id">list</span> (<span class="id">string</span> * <span class="id">rtype</span>₀)) : <span class="id">Forall</span> (<span class="kwd">fun</span> <span class="id">ab</span> =&gt; <span class="id">P</span> (<span class="id">snd</span> <span class="id">ab</span>)) <span class="id">r</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">r</span> <span class="kwd">as</span> <span class="id">c0</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">nil</span> =&gt; <span class="id">Forall_nil</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">cons</span> <span class="id">sd</span> <span class="id">c0</span> =&gt; @<span class="id">Forall_cons</span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">ab</span> =&gt; <span class="id">P</span> (<span class="id">snd</span> <span class="id">ab</span>)) <span class="id">sd</span> <span class="id">c0</span> (<span class="id">F</span> (<span class="id">snd</span> <span class="id">sd</span>)) (<span class="id">Frec</span> <span class="id">c0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Either</span>₀ <span class="id">l</span> <span class="id">r</span> =&gt; <span class="id">feither</span> <span class="id">l</span> <span class="id">r</span> (<span class="id">F</span> <span class="id">l</span>) (<span class="id">F</span> <span class="id">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Arrow</span>₀ <span class="id">tin</span> <span class="id">tout</span> =&gt; <span class="id">farrow</span> <span class="id">tin</span> <span class="id">tout</span> (<span class="id">F</span> <span class="id">tin</span>) (<span class="id">F</span> <span class="id">tout</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Brand</span>₀ <span class="id">b</span> =&gt; <span class="id">fbrand</span> <span class="id">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Foreign</span>₀ <span class="id">ft</span> =&gt; <span class="id">fforeign</span> <span class="id">ft</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">rtype</span>₀<span class="id">_rec</span> (<span class="id">P</span>:<span class="id">rtype</span>₀-&gt;<span class="kwd">Set</span>) := <span class="id">rtype</span>₀<span class="id">_rect</span> <span class="id">P</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id">rtype</span>₀<span class="id">_eqdec</span> : <span class="id">EqDec</span> <span class="id">rtype</span>₀ <span class="id">eq</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1036')">Proof.</div>
<div class="proofscript" id="proof1036">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">unfold</span> <span class="id">equiv</span>, <span class="id">complement</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">x</span>; <span class="tactic">destruct</span> <span class="id">y</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span>[<span class="id">right</span>; <span class="tactic">inversion</span> 1]; <span class="tactic">try</span> <span class="id">solve</span>[<span class="id">left</span>; <span class="tactic">trivial</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Col&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">IHx</span> <span class="id">y</span>) <span class="kwd">as</span> [<span class="id">e</span>|<span class="id">e</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>; <span class="tactic">f_equal</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>; <span class="tactic">intro</span> <span class="id">n</span>. <span class="tactic">apply</span> <span class="id">e</span>;<span class="tactic">inversion</span> <span class="id">n</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;Rec&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">k</span> == <span class="id">k0</span>); <span class="tactic">unfold</span> <span class="id">equiv</span>, <span class="id">complement</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">list_Forallt_eq_dec</span> <span class="id">r</span> <span class="id">srl</span>); <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> (<span class="id">forallt_impl</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">forallt_weaken</span>; <span class="tactic">clear</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">pair_eq_dec</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">string_dec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>; <span class="tactic">inversion</span> 1; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>; <span class="tactic">inversion</span> 1; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">IHx1</span> <span class="id">y1</span>); <span class="tactic">unfold</span> <span class="id">equiv</span>, <span class="id">complement</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">IHx2</span> <span class="id">y2</span>); <span class="tactic">unfold</span> <span class="id">equiv</span>, <span class="id">complement</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">left</span>; <span class="tactic">subst</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>; <span class="tactic">inversion</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+  <span class="id">right</span>; <span class="tactic">inversion</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">IHx1</span> <span class="id">y1</span>); <span class="tactic">unfold</span> <span class="id">equiv</span>, <span class="id">complement</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">IHx2</span> <span class="id">y2</span>); <span class="tactic">unfold</span> <span class="id">equiv</span>, <span class="id">complement</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">left</span>; <span class="tactic">subst</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>; <span class="tactic">inversion</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+  <span class="id">right</span>; <span class="tactic">inversion</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">b</span> == <span class="id">b0</span>); <span class="tactic">unfold</span> <span class="id">equiv</span>, <span class="id">complement</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">left</span> | <span class="id">right</span>]; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">foreign_type_dec</span> <span class="id">ft</span> <span class="id">ft0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>; <span class="tactic">f_equal</span>; <span class="tactic">apply</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>; <span class="tactic">inversion</span> 1; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id">rtypes</span>₀.<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "⊥₀" := <span class="id">Bottom</span>₀.<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "⊤₀" := <span class="id">Top</span>₀.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id">well_formed_rtypes</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">ftype</span>:<span class="id">foreign_type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">br</span>:<span class="id">brand_relation</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id">wf_rtype</span>₀ (τ:<span class="id">rtype</span>₀): <span class="id">bool</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> τ <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Coll</span>₀ τ' =&gt; <span class="id">wf_rtype</span>₀ τ'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Rec</span>₀ <span class="id">oc</span> <span class="id">srl</span> =&gt; <span class="id">is_list_sorted</span> <span class="id">ODT_lt_dec</span> (<span class="id">domain</span> <span class="id">srl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; <span class="id">forallb</span> (<span class="kwd">fun</span> <span class="id">ab</span> =&gt; <span class="id">wf_rtype</span>₀ (<span class="id">snd</span> <span class="id">ab</span>)) <span class="id">srl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Either</span>₀ τ<span class="id">l</span> τ<span class="id">r</span> =&gt; <span class="id">wf_rtype</span>₀ τ<span class="id">l</span> &amp;&amp; <span class="id">wf_rtype</span>₀ τ<span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Arrow</span>₀ τ<span class="kwd">in</span> τ<span class="id">out</span> =&gt; <span class="id">wf_rtype</span>₀ τ<span class="kwd">in</span> &amp;&amp; <span class="id">wf_rtype</span>₀ τ<span class="id">out</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Brand</span>₀ <span class="id">b</span> =&gt; <span class="kwd">if</span> <span class="id">is_canon_brands_dec</span> <span class="id">brand_relation_brands</span> <span class="id">b</span> <span class="kwd">then</span> <span class="id">true</span> <span class="kwd">else</span> <span class="id">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">rtype</span> : <span class="kwd">Set</span> := {τ₀:<span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">wf_rtype</span>₀<span class="id">_ext</span> {τ₀:<span class="id">rtype</span>₀} (<span class="id">pf1</span> <span class="id">pf2</span>:<span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) : <span class="id">pf1</span> = <span class="id">pf2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1037')">Proof.</div>
<div class="proofscript" id="proof1037">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">UIP_dec</span>; <span class="tactic">apply</span> <span class="id">bool_dec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">rtype_ext</span> {τ₀} (<span class="kwd">wf</span>τ1 <span class="kwd">wf</span>τ2:<span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exist</span> (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) τ₀ <span class="kwd">wf</span>τ1) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exist</span> (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) τ₀ <span class="kwd">wf</span>τ2).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1038')">Proof.</div>
<div class="proofscript" id="proof1038">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">apply</span> <span class="id">wf_rtype</span>₀<span class="id">_ext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">rtype_fequal</span> {τ₁ τ₂:<span class="id">rtype</span>} : <span class="id">proj1_sig</span> τ₁ = <span class="id">proj1_sig</span> τ₂ -&gt; τ₁ = τ₂.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1039')">Proof.</div>
<div class="proofscript" id="proof1039">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> τ₁; <span class="tactic">destruct</span> τ₂; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">rtype_ext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">rtype_nequal</span> {τ₁ τ₂:<span class="id">rtype</span>} : τ₁ &lt;&gt; τ₂ -&gt; <span class="id">proj1_sig</span> τ₁ &lt;&gt; <span class="id">proj1_sig</span> τ₂.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1040')">Proof.</div>
<div class="proofscript" id="proof1040">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">a</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">a</span>. <span class="tactic">apply</span> <span class="id">rtype_fequal</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">map_rtype_fequal</span> <span class="id">r1</span> <span class="id">r2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">string</span> * {τ₀ : <span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fst</span> <span class="id">x</span>, <span class="id">proj1_sig</span> (<span class="id">snd</span> <span class="id">x</span>))) <span class="id">r1</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">string</span> * {τ₀ : <span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fst</span> <span class="id">x</span>, <span class="id">proj1_sig</span> (<span class="id">snd</span> <span class="id">x</span>))) <span class="id">r2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">r1</span> = <span class="id">r2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1041')">Proof.</div>
<div class="proofscript" id="proof1041">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">r2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">r1</span>; <span class="tactic">destruct</span> <span class="id">r2</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">destruct</span> <span class="id">p</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">rtype_fequal</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">map_rtype_single_rec_fequal</span> <span class="id">a</span> τ <span class="id">r</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span>, <span class="id">proj1_sig</span> τ)::<span class="id">nil</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">string</span> * {τ₀ : <span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fst</span> <span class="id">x</span>, <span class="id">proj1_sig</span> (<span class="id">snd</span> <span class="id">x</span>))) <span class="id">r</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">a</span>, τ)::<span class="id">nil</span>) = <span class="id">r</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1042')">Proof.</div>
<div class="proofscript" id="proof1042">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id">a</span>, <span class="id">proj1_sig</span> τ)::<span class="id">nil</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span> (<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">string</span> * {τ₀ : <span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fst</span> <span class="id">x</span>, <span class="id">proj1_sig</span> (<span class="id">snd</span> <span class="id">x</span>))) ((<span class="id">a</span>, τ)::<span class="id">nil</span>)) <span class="tactic">by</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">map_rtype_fequal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id">rtype_eq_dec</span> : <span class="id">EqDec</span> <span class="id">rtype</span> <span class="id">eq</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1043')">Proof.</div>
<div class="proofscript" id="proof1043">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">unfold</span> <span class="id">equiv</span>, <span class="id">complement</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">x</span>₀ <span class="id">xwf</span>] [<span class="id">y</span>₀ <span class="id">ywf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">x</span>₀ == <span class="id">y</span>₀); <span class="tactic">unfold</span> <span class="id">equiv</span>, <span class="id">complement</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>. <span class="tactic">apply</span> <span class="id">rtype_fequal</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
<div class="doc">Lifted versions of the type constructors </div>
<div class="doc">This is the main type system, and always carries a proofs that the records are well formed </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id">Bottom</span> : <span class="id">rtype</span> := <span class="id">Bottom</span>₀.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id">Top</span> : <span class="id">rtype</span> := <span class="id">Top</span>₀.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id">Unit</span> : <span class="id">rtype</span> := <span class="id">Unit</span>₀.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id">Nat</span> : <span class="id">rtype</span> := <span class="id">Nat</span>₀.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id">Bool</span> : <span class="id">rtype</span> := <span class="id">Bool</span>₀.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id">String</span> : <span class="id">rtype</span> := <span class="id">String</span>₀.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">Coll</span> (τ:<span class="id">rtype</span>): <span class="id">rtype</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exist</span> <span class="id">_</span> (<span class="id">Coll</span>₀ (<span class="id">proj1_sig</span> τ)) (<span class="id">proj2_sig</span> τ).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id">Either</span> (τ<span class="id">l</span> τ<span class="id">r</span>:<span class="id">rtype</span>) : <span class="id">rtype</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exist</span> <span class="id">_</span> (<span class="id">Either</span>₀ (<span class="id">proj1_sig</span> τ<span class="id">l</span>) (<span class="id">proj1_sig</span> τ<span class="id">r</span>)) <span class="id">_</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1044')">Next Obligation.</div>
<div class="proofscript" id="proof1044">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">proj2_sig</span> τ<span class="id">l</span>), (<span class="id">proj2_sig</span> τ<span class="id">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id">Arrow</span> (τ<span class="id">l</span> τ<span class="id">r</span>:<span class="id">rtype</span>) : <span class="id">rtype</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exist</span> <span class="id">_</span> (<span class="id">Arrow</span>₀ (<span class="id">proj1_sig</span> τ<span class="id">l</span>) (<span class="id">proj1_sig</span> τ<span class="id">r</span>)) <span class="id">_</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1045')">Next Obligation.</div>
<div class="proofscript" id="proof1045">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">proj2_sig</span> τ<span class="id">l</span>), (<span class="id">proj2_sig</span> τ<span class="id">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id">Foreign</span> (<span class="id">ft</span>:<span class="id">foreign_type_type</span>) : <span class="id">rtype</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id">Foreign</span>₀ <span class="id">ft</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id">Rec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k</span>:<span class="id">record_kind</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">srl</span>:<span class="id">list</span> (<span class="id">string</span>* <span class="id">rtype</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">pf_sorted</span>:<span class="id">is_list_sorted</span> <span class="id">ODT_lt_dec</span> (<span class="id">domain</span> <span class="id">srl</span>) = <span class="id">true</span>) : <span class="id">rtype</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id">Rec</span>₀ <span class="id">k</span> (<span class="id">map</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; (<span class="id">fst</span> <span class="id">x</span>, <span class="id">proj1_sig</span> (<span class="id">snd</span> <span class="id">x</span>))) <span class="id">srl</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1046')">Next Obligation.</div>
<div class="proofscript" id="proof1046">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">domain</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">map_map</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">map_eq</span> (<span class="id">g</span>:=<span class="id">fst</span>)) <span class="tactic">by</span> (<span class="tactic">rewrite</span> <span class="id">Forall_forall</span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">andb_true_iff</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">pf_sorted</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">forallb_map</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">forallb_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [? [??]] ?; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id">Brand</span> <span class="id">b</span> : <span class="id">rtype</span> := <span class="id">Brand</span>₀ (<span class="id">canon_brands</span> <span class="id">brand_relation_brands</span> <span class="id">b</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1047')">Next Obligation.</div>
<div class="proofscript" id="proof1047">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">canon_brands_is_canon_brands</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id">Brand_equiv_proper</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Proper</span> (<span class="id">equiv_brands</span> <span class="id">brand_relation_brands</span> ==&gt; <span class="id">eq</span>) (<span class="id">Brand</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1048')">Proof.</div>
<div class="proofscript" id="proof1048">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Proper</span>, <span class="id">respectful</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">rtype_fequal</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Notation</span> "⊥" := <span class="id">Bottom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Notation</span> "⊤" := <span class="id">Top</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">Option</span> τ := <span class="id">Either</span> τ <span class="id">Unit</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id">rtype_rect</span> (<span class="id">P</span> : <span class="id">rtype</span> -&gt; <span class="kwd">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ftop</span> : <span class="id">P</span> ⊤)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fbottom</span> : <span class="id">P</span> ⊥)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">funit</span> : <span class="id">P</span> <span class="id">Unit</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fnat</span> : <span class="id">P</span> <span class="id">Nat</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fbool</span> : <span class="id">P</span> <span class="id">Bool</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fstring</span> : <span class="id">P</span> <span class="id">String</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fcol</span> : <span class="kwd">forall</span> <span class="id">t</span> : <span class="id">rtype</span>, <span class="id">P</span> <span class="id">t</span> -&gt; <span class="id">P</span> (<span class="id">Coll</span> <span class="id">t</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">frec</span> : <span class="kwd">forall</span> (<span class="id">k</span>:<span class="id">record_kind</span>) (<span class="id">srl</span> : <span class="id">list</span> (<span class="id">string</span> * <span class="id">rtype</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">pf</span>:<span class="id">is_list_sorted</span> <span class="id">ODT_lt_dec</span> (<span class="id">domain</span> <span class="id">srl</span>) = <span class="id">true</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forallt</span> (<span class="kwd">fun</span> <span class="id">ab</span> =&gt; <span class="id">P</span> (<span class="id">snd</span> <span class="id">ab</span>)) <span class="id">srl</span> -&gt; <span class="id">P</span> (<span class="id">Rec</span> <span class="id">k</span> <span class="id">srl</span> <span class="id">pf</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">feither</span> : <span class="kwd">forall</span> (τ<span class="id">l</span> τ<span class="id">r</span>:<span class="id">rtype</span>), <span class="id">P</span> τ<span class="id">l</span> -&gt; <span class="id">P</span> τ<span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id">Either</span> τ<span class="id">l</span> τ<span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">farrow</span> : <span class="kwd">forall</span> (τ<span class="kwd">in</span> τ<span class="id">out</span>:<span class="id">rtype</span>), <span class="id">P</span> τ<span class="kwd">in</span> -&gt; <span class="id">P</span> τ<span class="id">out</span> -&gt; <span class="id">P</span> (<span class="id">Arrow</span> τ<span class="kwd">in</span> τ<span class="id">out</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fbrand</span> : <span class="kwd">forall</span> <span class="id">b</span>, <span class="id">P</span> (<span class="id">Brand</span> <span class="id">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fforeign</span> : <span class="kwd">forall</span> <span class="id">ft</span>, <span class="id">P</span> (<span class="id">Foreign</span> <span class="id">ft</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (τ:<span class="id">rtype</span>), <span class="id">P</span> τ.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1049')">Proof.</div>
<div class="proofscript" id="proof1049">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id">Forallt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> τ <span class="kwd">as</span> [τ₀ <span class="kwd">wf</span>τ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="kwd">wf</span>τ. <span class="comment">(*&nbsp;ftop&nbsp;fbottom&nbsp;funit&nbsp;fnat&nbsp;fbool&nbsp;fstring&nbsp;fcol&nbsp;frec.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Top</span>, <span class="id">Bottom</span>, <span class="id">Unit</span>, <span class="id">Nat</span>, <span class="id">Bool</span>, <span class="id">String</span>, <span class="id">Coll</span>, <span class="id">Rec</span>, <span class="id">Either</span>, <span class="id">Arrow</span> <span class="kwd">in</span> *.<br/>
&nbsp;Ltac&nbsp;r_ext&nbsp;:=&nbsp;solve&nbsp;[erewrite&nbsp;(rtype_ext);&nbsp;eauto].&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> τ₀; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">rtype_ext</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">rtype_ext</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">rtype_ext</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">rtype_ext</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">rtype_ext</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">rtype_ext</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">specialize</span> (<span class="id">fcol</span> <span class="id">_</span> (<span class="id">IH</span>τ₀ <span class="kwd">wf</span>τ)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">rtype_ext</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">frec</span> <span class="kwd">wf</span>τ <span class="id">X</span>; <span class="tactic">clear</span>. <span class="tactic">intros</span> <span class="id">frec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">srlpf</span>:{<span class="id">srl</span>: <span class="id">list</span> (<span class="id">string</span> * <span class="id">rtype</span>) | (<span class="id">map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">string</span> * {τ₀ : <span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fst</span> <span class="id">x</span>, <span class="id">proj1_sig</span> (<span class="id">snd</span> <span class="id">x</span>))) <span class="id">srl</span>) = <span class="id">r</span>}).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">clear</span> <span class="id">P</span> <span class="id">X</span> <span class="id">frec</span>. <span class="tactic">rewrite</span> <span class="id">andb_true_iff</span>, <span class="id">forallb_forall</span> <span class="kwd">in</span> <span class="kwd">wf</span>τ.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="kwd">wf</span>τ <span class="kwd">as</span> [<span class="id">iss</span> <span class="id">fb</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">iss</span> <span class="id">fb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">r</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exists</span> <span class="id">nil</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">domain_cons</span>, <span class="id">is_list_sorted_cons</span> <span class="kwd">in</span> <span class="id">iss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">iss</span> <span class="kwd">as</span> [<span class="id">iss</span> <span class="id">isa</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHr</span> <span class="kwd">as</span> [<span class="id">srl</span> <span class="id">srlpf</span>]; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">fb</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">fb</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> ((<span class="id">fst</span> <span class="id">a</span> ,(<span class="id">exist</span> <span class="id">_</span> (<span class="id">snd</span> <span class="id">a</span>) <span class="id">H1</span>))::<span class="id">srl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span>. <span class="tactic">congruence</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">srlpf</span> <span class="kwd">as</span> [<span class="id">srl</span> <span class="id">srleq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">dreq</span>:<span class="id">domain</span> <span class="id">srl</span> = <span class="id">domain</span> <span class="id">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">srleq</span>; <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id">domain</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">map_map</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">map_eq</span>; <span class="tactic">apply</span> <span class="id">Forall_forall</span>; <span class="tactic">auto</span>.     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">pfs</span>:<span class="id">is_list_sorted</span> <span class="id">ODT_lt_dec</span> (<span class="id">domain</span> <span class="id">srl</span>) = <span class="id">true</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">dreq</span>; <span class="tactic">rewrite</span> <span class="id">andb_true_iff</span> <span class="kwd">in</span> <span class="kwd">wf</span>τ; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">pff</span>:<span class="id">Forallt</span> (<span class="kwd">fun</span> <span class="id">ab</span> : <span class="id">string</span> * <span class="id">rtype</span> =&gt; <span class="id">P</span> (<span class="id">snd</span> <span class="id">ab</span>)) <span class="id">srl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">X</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">srleq</span>. <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">srl</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">destruct</span> <span class="id">r</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 1; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">frec</span> <span class="id">k</span> <span class="id">srl</span> <span class="id">pfs</span> <span class="id">pff</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">srleq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> (<span class="id">rtype_ext</span>); <span class="tactic">eapply</span> <span class="id">frec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">generalize</span> <span class="kwd">wf</span>τ; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">andb_true_iff</span> <span class="kwd">in</span> <span class="kwd">wf</span>τ. <span class="tactic">destruct</span> <span class="kwd">wf</span>τ <span class="kwd">as</span> [<span class="kwd">wf</span>τ1 <span class="kwd">wf</span>τ2].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">feither</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">IH</span>τ₀1 <span class="kwd">wf</span>τ1) (<span class="id">IH</span>τ₀2 <span class="kwd">wf</span>τ2)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">rtype_ext</span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">generalize</span> <span class="kwd">wf</span>τ; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">andb_true_iff</span> <span class="kwd">in</span> <span class="kwd">wf</span>τ. <span class="tactic">destruct</span> <span class="kwd">wf</span>τ <span class="kwd">as</span> [<span class="kwd">wf</span>τ1 <span class="kwd">wf</span>τ2].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">farrow</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">IH</span>τ₀1 <span class="kwd">wf</span>τ1) (<span class="id">IH</span>τ₀2 <span class="kwd">wf</span>τ2)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">rtype_ext</span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">fbrand</span> <span class="id">b</span> <span class="kwd">wf</span>τ. <span class="tactic">clear</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">isc</span>:<span class="id">is_canon_brands</span> <span class="id">brand_relation_brands</span> <span class="id">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="id">match_destr_in</span> <span class="kwd">wf</span>τ.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">exist</span> (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) (<span class="id">Brand</span>₀ <span class="id">b</span>) <span class="kwd">wf</span>τ) <span class="kwd">with</span> (<span class="id">Brand</span> <span class="id">b</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">rtype_fequal</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">is_canon_brands_canon_brands</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">specialize</span> (<span class="id">fforeign</span> <span class="id">ft</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">rtype_ext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id">rtype_ind</span> (<span class="id">P</span> : <span class="id">rtype</span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ftop</span> : <span class="id">P</span> ⊤)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fbottom</span> : <span class="id">P</span> ⊥)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">funit</span> : <span class="id">P</span> <span class="id">Unit</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fnat</span> : <span class="id">P</span> <span class="id">Nat</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fbool</span> : <span class="id">P</span> <span class="id">Bool</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fstring</span> : <span class="id">P</span> <span class="id">String</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fcol</span> : <span class="kwd">forall</span> <span class="id">t</span> : <span class="id">rtype</span>, <span class="id">P</span> <span class="id">t</span> -&gt; <span class="id">P</span> (<span class="id">Coll</span> <span class="id">t</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">frec</span> : <span class="kwd">forall</span> (<span class="id">k</span>:<span class="id">record_kind</span>) (<span class="id">srl</span> : <span class="id">list</span> (<span class="id">string</span> * <span class="id">rtype</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">pf</span>:<span class="id">is_list_sorted</span> <span class="id">ODT_lt_dec</span> (<span class="id">domain</span> <span class="id">srl</span>) = <span class="id">true</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forall</span> (<span class="kwd">fun</span> <span class="id">ab</span> =&gt; <span class="id">P</span> (<span class="id">snd</span> <span class="id">ab</span>)) <span class="id">srl</span> -&gt; <span class="id">P</span> (<span class="id">Rec</span> <span class="id">k</span> <span class="id">srl</span> <span class="id">pf</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">feither</span> : <span class="kwd">forall</span> (τ<span class="id">l</span> τ<span class="id">r</span>:<span class="id">rtype</span>), <span class="id">P</span> τ<span class="id">l</span> -&gt; <span class="id">P</span> τ<span class="id">r</span> -&gt; <span class="id">P</span> (<span class="id">Either</span> τ<span class="id">l</span> τ<span class="id">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">farrow</span> : <span class="kwd">forall</span> (τ<span class="kwd">in</span> τ<span class="id">out</span>:<span class="id">rtype</span>), <span class="id">P</span> τ<span class="kwd">in</span> -&gt; <span class="id">P</span> τ<span class="id">out</span> -&gt; <span class="id">P</span> (<span class="id">Arrow</span> τ<span class="kwd">in</span> τ<span class="id">out</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fbrand</span> : <span class="kwd">forall</span> <span class="id">b</span>, <span class="id">P</span> (<span class="id">Brand</span> <span class="id">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fforeign</span> : <span class="kwd">forall</span> <span class="id">ft</span>, <span class="id">P</span> (<span class="id">Foreign</span> <span class="id">ft</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (τ:<span class="id">rtype</span>), <span class="id">P</span> τ.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1050')">Proof.</div>
<div class="proofscript" id="proof1050">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id">Forallt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> τ <span class="kwd">as</span> [τ₀ <span class="kwd">wf</span>τ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="kwd">wf</span>τ. <span class="comment">(*&nbsp;ftop&nbsp;fbottom&nbsp;funit&nbsp;fnat&nbsp;fbool&nbsp;fstring&nbsp;fcol&nbsp;frec.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Top</span>, <span class="id">Bottom</span>, <span class="id">Unit</span>, <span class="id">Nat</span>, <span class="id">Bool</span>, <span class="id">String</span>, <span class="id">Coll</span>, <span class="id">Rec</span> <span class="kwd">in</span> *.<br/>
&nbsp;Ltac&nbsp;r_ext&nbsp;:=&nbsp;solve&nbsp;[erewrite&nbsp;(rtype_ext);&nbsp;eauto].&nbsp;*)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> τ₀; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">rtype_ext</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">rtype_ext</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">rtype_ext</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">rtype_ext</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">rtype_ext</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id">rtype_ext</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">specialize</span> (<span class="id">fcol</span> <span class="id">_</span> (<span class="id">IH</span>τ₀ <span class="kwd">wf</span>τ)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">rtype_ext</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">frec</span> <span class="kwd">wf</span>τ <span class="id">H</span>; <span class="tactic">clear</span>. <span class="tactic">intros</span> <span class="id">frec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">srlpf</span>:{<span class="id">srl</span>: <span class="id">list</span> (<span class="id">string</span> * <span class="id">rtype</span>) | (<span class="id">map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">string</span> * {τ₀ : <span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fst</span> <span class="id">x</span>, <span class="id">proj1_sig</span> (<span class="id">snd</span> <span class="id">x</span>))) <span class="id">srl</span>) = <span class="id">r</span>}).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">clear</span> <span class="id">P</span> <span class="id">H</span> <span class="id">frec</span>. <span class="tactic">rewrite</span> <span class="id">andb_true_iff</span>, <span class="id">forallb_forall</span> <span class="kwd">in</span> <span class="kwd">wf</span>τ.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="kwd">wf</span>τ <span class="kwd">as</span> [<span class="id">iss</span> <span class="id">fb</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">iss</span> <span class="id">fb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">r</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exists</span> <span class="id">nil</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">domain_cons</span>, <span class="id">is_list_sorted_cons</span> <span class="kwd">in</span> <span class="id">iss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">iss</span> <span class="kwd">as</span> [<span class="id">iss</span> <span class="id">isa</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHr</span> <span class="kwd">as</span> [<span class="id">srl</span> <span class="id">srlpf</span>]; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">fb</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">fb</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> ((<span class="id">fst</span> <span class="id">a</span> ,(<span class="id">exist</span> <span class="id">_</span> (<span class="id">snd</span> <span class="id">a</span>) <span class="id">H1</span>))::<span class="id">srl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span>. <span class="tactic">congruence</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">srlpf</span> <span class="kwd">as</span> [<span class="id">srl</span> <span class="id">srleq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">dreq</span>:<span class="id">domain</span> <span class="id">srl</span> = <span class="id">domain</span> <span class="id">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">srleq</span>; <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id">domain</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">map_map</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">map_eq</span>; <span class="tactic">apply</span> <span class="id">Forall_forall</span>; <span class="tactic">auto</span>.     <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">pfs</span>:<span class="id">is_list_sorted</span> <span class="id">ODT_lt_dec</span> (<span class="id">domain</span> <span class="id">srl</span>) = <span class="id">true</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">dreq</span>; <span class="tactic">rewrite</span> <span class="id">andb_true_iff</span> <span class="kwd">in</span> <span class="kwd">wf</span>τ; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">pff</span>:<span class="id">Forall</span> (<span class="kwd">fun</span> <span class="id">ab</span> : <span class="id">string</span> * <span class="id">rtype</span> =&gt; <span class="id">P</span> (<span class="id">snd</span> <span class="id">ab</span>)) <span class="id">srl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">srleq</span>. <span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">srl</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">destruct</span> <span class="id">r</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 1; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">frec</span> <span class="id">k</span> <span class="id">srl</span> <span class="id">pfs</span> <span class="id">pff</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">srleq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> (<span class="id">rtype_ext</span>); <span class="tactic">eapply</span> <span class="id">frec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">generalize</span> <span class="kwd">wf</span>τ; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">andb_true_iff</span> <span class="kwd">in</span> <span class="kwd">wf</span>τ. <span class="tactic">destruct</span> <span class="kwd">wf</span>τ <span class="kwd">as</span> [<span class="kwd">wf</span>τ1 <span class="kwd">wf</span>τ2].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">feither</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">IH</span>τ₀1 <span class="kwd">wf</span>τ1) (<span class="id">IH</span>τ₀2 <span class="kwd">wf</span>τ2)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">rtype_ext</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">generalize</span> <span class="kwd">wf</span>τ; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">andb_true_iff</span> <span class="kwd">in</span> <span class="kwd">wf</span>τ. <span class="tactic">destruct</span> <span class="kwd">wf</span>τ <span class="kwd">as</span> [<span class="kwd">wf</span>τ1 <span class="kwd">wf</span>τ2].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">farrow</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">IH</span>τ₀1 <span class="kwd">wf</span>τ1) (<span class="id">IH</span>τ₀2 <span class="kwd">wf</span>τ2)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">rtype_ext</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">revert</span> <span class="id">fbrand</span> <span class="id">b</span> <span class="kwd">wf</span>τ. <span class="tactic">clear</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">isc</span>:<span class="id">is_canon_brands</span> <span class="id">brand_relation_brands</span> <span class="id">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="id">match_destr_in</span> <span class="kwd">wf</span>τ.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">exist</span> (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) (<span class="id">Brand</span>₀ <span class="id">b</span>) <span class="kwd">wf</span>τ) <span class="kwd">with</span> (<span class="id">Brand</span> <span class="id">b</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">rtype_fequal</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">is_canon_brands_canon_brands</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">specialize</span> (<span class="id">fforeign</span> <span class="id">ft</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">rtype_ext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">rtype_rec</span> (<span class="id">P</span>:<span class="id">rtype</span>-&gt;<span class="kwd">Set</span>) := <span class="id">rtype_rect</span> <span class="id">P</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">wf_rtype</span>₀<span class="id">_kind_irrel</span> <span class="id">k</span>₁ <span class="id">k</span>₂ <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wf_rtype</span>₀ (<span class="id">Rec</span>₀ <span class="id">k</span>₁ <span class="id">l</span>) = <span class="id">wf_rtype</span>₀ (<span class="id">Rec</span>₀ <span class="id">k</span>₂ <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1051')">Proof.</div>
<div class="proofscript" id="proof1051">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">wf_rtype</span>₀<span class="id">_Brand</span>₀ <span class="id">b</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wf_rtype</span>₀ (<span class="id">Brand</span>₀ <span class="id">b</span>) = <span class="id">true</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">is_canon_brands</span> <span class="id">brand_relation_brands</span> <span class="id">b</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1052')">Proof.</div>
<div class="proofscript" id="proof1052">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">brand_ext</span> <span class="id">b</span> <span class="id">pf</span> : <span class="id">exist</span> <span class="id">_</span> (<span class="id">Brand</span>₀ <span class="id">b</span>) <span class="id">pf</span> = <span class="id">Brand</span> <span class="id">b</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1053')">Proof.</div>
<div class="proofscript" id="proof1053">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">rtype_fequal</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr_in</span> <span class="id">pf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">is_canon_brands_canon_brands</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">wf_rtype</span>₀<span class="id">_cons_tail</span> {<span class="id">k</span>} {<span class="id">a</span> <span class="id">r</span>} : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wf_rtype</span>₀ (<span class="id">Rec</span>₀ <span class="id">k</span> (<span class="id">a</span>::<span class="id">r</span>)) = <span class="id">true</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wf_rtype</span>₀ (<span class="id">Rec</span>₀ <span class="id">k</span> <span class="id">r</span>) = <span class="id">true</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1054')">Proof.</div>
<div class="proofscript" id="proof1054">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">andb_true_iff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">domain</span> <span class="id">r</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">StringOrder.lt_dec</span> (<span class="id">fst</span> <span class="id">a</span>) <span class="id">s</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">wf_rtype</span>₀<span class="id">_cons_lt</span> {<span class="id">k</span> <span class="id">s</span> <span class="id">r</span> <span class="id">srl</span> <span class="id">s</span>' <span class="id">r</span>'} : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wf_rtype</span>₀ (<span class="id">Rec</span>₀ <span class="id">k</span> ((<span class="id">s</span>, <span class="id">r</span>) :: <span class="id">srl</span>)) = <span class="id">true</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lookup</span> <span class="id">string_dec</span> <span class="id">srl</span> <span class="id">s</span>' = <span class="id">Some</span> <span class="id">r</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ODT_lt</span> <span class="id">s</span> <span class="id">s</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1055')">Proof.</div>
<div class="proofscript" id="proof1055">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">wf_rtype</span>₀. <span class="tactic">rewrite</span> <span class="id">andb_true_iff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">isl</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_list_sorted_Sorted_iff</span> <span class="kwd">in</span> <span class="id">isl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Sorted_StronglySorted</span> <span class="kwd">in</span> <span class="id">isl</span>; [|<span class="tactic">eapply</span> <span class="id">StringOrder.lt_strorder</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">isl</span>. <span class="tactic">inversion</span> <span class="id">isl</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Forall_forall</span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">s</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">los</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">lookup_in</span> <span class="kwd">in</span> <span class="id">los</span>. <span class="tactic">apply</span> <span class="id">in_dom</span> <span class="kwd">in</span> <span class="id">los</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">wf_rtype</span>₀<span class="id">_cons_nin</span> {<span class="id">k</span> <span class="id">s</span> <span class="id">r</span> <span class="id">srl</span>} : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wf_rtype</span>₀ (<span class="id">Rec</span>₀ <span class="id">k</span> ((<span class="id">s</span>, <span class="id">r</span>) :: <span class="id">srl</span>)) = <span class="id">true</span> -&gt; <span class="id">lookup</span> <span class="id">string_dec</span> <span class="id">srl</span> <span class="id">s</span> = <span class="id">None</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1056')">Proof.</div>
<div class="proofscript" id="proof1056">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">wf_rtype</span>₀. <span class="tactic">rewrite</span> <span class="id">andb_true_iff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">isl</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_list_sorted_NoDup</span> <span class="kwd">in</span> <span class="id">isl</span>; [|<span class="tactic">eapply</span> <span class="id">StringOrder.lt_strorder</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">isl</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">lookup_nin_none</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">wf_rtype</span>₀<span class="id">_cons_wf</span> {<span class="id">k</span> <span class="id">s</span> <span class="id">r</span> <span class="id">srl</span>} : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wf_rtype</span>₀ (<span class="id">Rec</span>₀ <span class="id">k</span> ((<span class="id">s</span>, <span class="id">r</span>) :: <span class="id">srl</span>)) = <span class="id">true</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wf_rtype</span>₀ <span class="id">r</span> = <span class="id">true</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1057')">Proof.</div>
<div class="proofscript" id="proof1057">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">andb_true_iff</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id">well_formed_rtypes</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "⊥" := <span class="id">Bottom</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Notation</span> "⊤" := <span class="id">Top</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">equalizer</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>:(@<span class="id">eq</span> <span class="id">rtype</span>₀ (<span class="id">proj1_sig</span> <span class="id">_</span>) (<span class="id">proj1_sig</span> <span class="id">_</span>)) |- <span class="id">_</span>] =&gt; <span class="tactic">apply</span> <span class="id">rtype_fequal</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id">map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">string</span> * {τ₀ : <span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fst</span> <span class="id">x</span>, <span class="id">proj1_sig</span> (<span class="id">snd</span> <span class="id">x</span>))) <span class="id">_</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span>' : <span class="id">string</span> * {τ₀' : <span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀' = <span class="id">true</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fst</span> <span class="id">x</span>', <span class="id">proj1_sig</span> (<span class="id">snd</span> <span class="id">x</span>'))) <span class="id">_</span> |- <span class="id">_</span>] =&gt; <span class="tactic">apply</span> <span class="id">map_rtype_fequal</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">to_Rec</span> {<span class="id">ftype</span>:<span class="id">foreign_type</span>} {<span class="id">br</span>:<span class="id">brand_relation</span>} <span class="id">k</span> <span class="id">l</span> <span class="id">pf</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pf2</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exist</span> (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Rec</span>₀<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> (<span class="id">map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">string</span> * {τ₀ : <span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fst</span> <span class="id">x</span>, <span class="id">proj1_sig</span> (<span class="id">snd</span> <span class="id">x</span>))) <span class="id">l</span>)) <span class="id">pf</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id">Rec</span> <span class="id">k</span> <span class="id">l</span> <span class="id">pf2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1058')">Proof.</div>
<div class="proofscript" id="proof1058">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Rec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">pf</span>. <span class="tactic">intros</span> <span class="id">pf</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">pf</span>. <span class="tactic">rewrite</span> <span class="id">andb_true_iff</span> <span class="kwd">in</span> <span class="id">pf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">domain</span> <span class="kwd">in</span> <span class="id">pf</span>; <span class="tactic">rewrite</span> <span class="id">map_map</span> <span class="kwd">in</span> <span class="id">pf</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">pf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">pf</span> <span class="kwd">as</span> [<span class="id">isl</span> ?].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">isl</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">rtype_ext</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">from_Rec</span>₀ {<span class="id">ftype</span>:<span class="id">foreign_type</span>} {<span class="id">br</span>:<span class="id">brand_relation</span>} {<span class="id">k</span>} (<span class="id">l</span>:<span class="id">list</span> (<span class="id">string</span> * <span class="id">rtype</span>₀)) (<span class="id">pf</span> : <span class="id">wf_rtype</span>₀ (<span class="id">Rec</span>₀ <span class="id">k</span> <span class="id">l</span>) = <span class="id">true</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">l</span>' | <span class="id">exists</span> <span class="id">pf</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l</span> = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">string</span> * {τ₀ : <span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fst</span> <span class="id">x</span>, <span class="id">proj1_sig</span> (<span class="id">snd</span> <span class="id">x</span>))) <span class="id">l</span>') <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">Rec</span> <span class="id">k</span> <span class="id">l</span>' <span class="id">pf</span>' = <span class="id">exist</span>  (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) (<span class="id">Rec</span>₀ <span class="id">k</span> <span class="id">l</span>) <span class="id">pf</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1059')">Proof.</div>
<div class="proofscript" id="proof1059">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">pf</span>. <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">unfold</span> <span class="id">Rec</span>; <span class="tactic">intros</span> <span class="id">pf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exists</span> <span class="id">nil</span>; <span class="tactic">simpl</span>. <span class="id">exists</span> <span class="id">eq_refl</span>; <span class="tactic">intuition</span>. <span class="tactic">apply</span> <span class="id">rtype_ext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">generalize</span> (<span class="id">wf_rtype</span>₀<span class="id">_cons_tail</span> <span class="id">pf</span>); <span class="tactic">intros</span> <span class="id">pf</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">IHl</span> <span class="id">pf</span>') <span class="kwd">as</span> [<span class="id">l</span>' <span class="id">l</span>'<span class="id">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> ((<span class="id">s</span>, (<span class="id">exist</span> <span class="id">_</span> <span class="id">r</span> (<span class="id">wf_rtype</span>₀<span class="id">_cons_wf</span> <span class="id">pf</span>)))::<span class="id">l</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>'<span class="id">H</span> <span class="kwd">as</span> [<span class="id">pf</span>'' [<span class="id">eq1</span> <span class="id">eq2</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">pf</span>; <span class="tactic">intros</span> <span class="id">pf_</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">pf</span>. <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">andb_true_iff</span> <span class="kwd">in</span> <span class="id">pf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">pf</span> <span class="kwd">as</span> [<span class="id">isl</span> [<span class="id">wfr</span> <span class="id">wfb</span>]]. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">pf</span>'0 : <span class="id">is_list_sorted</span> <span class="id">ODT_lt_dec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">domain</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">s</span>, <span class="id">exist</span> (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) <span class="id">r</span> <span class="id">wfr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id">l</span>')) = <span class="id">true</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">domain_cons</span>, <span class="id">is_list_sorted_cons</span>. <span class="tactic">simpl</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">unfold</span> <span class="id">domain</span> <span class="kwd">in</span> <span class="id">isl</span>; <span class="tactic">rewrite</span> <span class="id">map_map</span> <span class="kwd">in</span> <span class="id">isl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">isl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">map_eq</span> (<span class="id">g</span>:=<span class="id">fst</span>)) <span class="kwd">in</span> <span class="id">isl</span> <span class="tactic">by</span> (<span class="tactic">rewrite</span> <span class="id">Forall_forall</span>; <span class="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">domain</span>. <span class="tactic">destruct</span> (<span class="id">map</span> <span class="id">fst</span> <span class="id">l</span>'); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">StringOrder.lt_dec</span> <span class="id">s</span> <span class="id">s0</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pf</span>'0. <span class="tactic">subst</span>; <span class="tactic">simpl</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">rtype_ext</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">lookup_map_some</span> {<span class="id">ftype</span>:<span class="id">foreign_type</span>} {<span class="id">br</span>:<span class="id">brand_relation</span>} <span class="id">rl2</span> <span class="id">s</span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lookup</span> <span class="id">string_dec</span> <span class="id">rl2</span> <span class="id">s</span> = <span class="id">Some</span> <span class="id">x</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lookup</span> <span class="id">string_dec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">string</span> * {τ₀ : <span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fst</span> <span class="id">x</span>, <span class="id">proj1_sig</span> (<span class="id">snd</span> <span class="id">x</span>))) <span class="id">rl2</span>) <span class="id">s</span> = <span class="id">Some</span> (<span class="id">proj1_sig</span> <span class="id">x</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1060')">Proof.</div>
<div class="proofscript" id="proof1060">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl2</span>; <span class="tactic">simpl</span>; [<span class="tactic">split</span>; <span class="tactic">discriminate</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">string_dec</span> <span class="id">s</span> <span class="id">s0</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">inversion</span> 1; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">equalizer</span>. <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">lookup_map_some</span>' {<span class="id">ftype</span>:<span class="id">foreign_type</span>} {<span class="id">br</span>:<span class="id">brand_relation</span>} <span class="id">rl2</span> <span class="id">s</span> <span class="id">x</span> <span class="id">pf</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lookup</span> <span class="id">string_dec</span> <span class="id">rl2</span> <span class="id">s</span> = <span class="id">Some</span> (<span class="id">exist</span> <span class="id">_</span> <span class="id">x</span> <span class="id">pf</span>) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lookup</span> <span class="id">string_dec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">string</span> * {τ₀ : <span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fst</span> <span class="id">x</span>, <span class="id">proj1_sig</span> (<span class="id">snd</span> <span class="id">x</span>))) <span class="id">rl2</span>) <span class="id">s</span> = <span class="id">Some</span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1061')">Proof.</div>
<div class="proofscript" id="proof1061">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">lookup_map_some</span>; <span class="tactic">simpl</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span>  <span class="id">lookup_map_some_ex</span> {<span class="id">ftype</span>:<span class="id">foreign_type</span>} {<span class="id">br</span>:<span class="id">brand_relation</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">rl2</span> : <span class="id">list</span> (<span class="id">string</span> * {τ₀ : <span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>})) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id">string</span>) (<span class="id">x</span> : <span class="id">rtype</span>₀) :<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">pf</span>, <span class="id">lookup</span> <span class="id">string_dec</span> <span class="id">rl2</span> <span class="id">s</span> =<br/>
&nbsp;&nbsp;<span class="id">Some</span> (<span class="id">exist</span> (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) <span class="id">x</span> <span class="id">pf</span>)) &lt;-&gt;<br/>
&nbsp;&nbsp;<span class="id">lookup</span> <span class="id">string_dec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x0</span> : <span class="id">string</span> * {τ₀ : <span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fst</span> <span class="id">x0</span>, <span class="id">proj1_sig</span> (<span class="id">snd</span> <span class="id">x0</span>))) <span class="id">rl2</span>) <span class="id">s</span> = <span class="id">Some</span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1062')">Proof.</div>
<div class="proofscript" id="proof1062">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl2</span>; <span class="tactic">simpl</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span> [??]; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span> [??].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">string_dec</span> <span class="id">s</span> <span class="id">s0</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHrl2</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">string_dec</span> <span class="id">s</span> <span class="id">s0</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">destruct</span> <span class="id">s1</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">IHrl2</span>. <br/>
Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">lookup_map_none</span> {<span class="id">ftype</span>:<span class="id">foreign_type</span>} {<span class="id">br</span>:<span class="id">brand_relation</span>} <span class="id">rl2</span> <span class="id">s</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lookup</span> <span class="id">string_dec</span> <span class="id">rl2</span> <span class="id">s</span> = <span class="id">None</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lookup</span> <span class="id">string_dec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">string</span> * {τ₀ : <span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fst</span> <span class="id">x</span>, <span class="id">proj1_sig</span> (<span class="id">snd</span> <span class="id">x</span>))) <span class="id">rl2</span>) <span class="id">s</span> = <span class="id">None</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1063')">Proof.</div>
<div class="proofscript" id="proof1063">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl2</span>; <span class="tactic">simpl</span>; [<span class="tactic">intuition</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">string_dec</span> <span class="id">s</span> <span class="id">s0</span>); <span class="tactic">subst</span>; <span class="tactic">intuition</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">RType</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">recmaybe</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">ftype</span>:<span class="id">foreign_type</span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">br</span>:<span class="id">brand_relation</span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">RecMaybe</span> (<span class="id">k</span>:<span class="id">record_kind</span>) (<span class="id">lsr</span>:<span class="id">list</span> (<span class="id">string</span>*<span class="id">rtype</span>)) : <span class="id">option</span> <span class="id">rtype</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">is_list_sorted</span> <span class="id">ODT_lt_dec</span> (<span class="id">domain</span> <span class="id">lsr</span>)); <span class="tactic">intros</span> <span class="id">pf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">exact</span> (<span class="id">Some</span> (<span class="id">Rec</span> <span class="id">k</span> <span class="id">lsr</span> <span class="id">pf</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">exact</span> <span class="id">None</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">RecMaybe_some_pf_helper</span> (<span class="id">z</span>:<span class="id">bool</span>) τ <span class="id">f</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id">z</span> <span class="kwd">as</span> <span class="id">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">return</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">z</span> = <span class="id">b</span> -&gt; <span class="id">option</span> <span class="id">rtype</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">pf</span> : <span class="id">z</span> = <span class="id">true</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Some</span> (<span class="id">f</span> <span class="id">pf</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">_</span> : <span class="id">z</span> = <span class="id">false</span> =&gt; <span class="id">None</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eq_refl</span> = <span class="id">Some</span> τ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">pf</span> : <span class="id">z</span> = <span class="id">true</span> |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;τ = <span class="id">f</span> <span class="id">pf</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1064')">Proof.</div>
<div class="proofscript" id="proof1064">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">z</span>; <span class="tactic">inversion</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">RecMaybe_some_pf</span> {<span class="id">k</span> τ₀ τ} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">RecMaybe</span> <span class="id">k</span> τ₀ = <span class="id">Some</span> τ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">pf</span> | τ = <span class="id">Rec</span> <span class="id">k</span> τ₀ <span class="id">pf</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1065')">Proof.</div>
<div class="proofscript" id="proof1065">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">RecMaybe</span>. <span class="tactic">intros</span> <span class="id">eqs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">RecMaybe_some_pf_helper</span> <span class="kwd">in</span> <span class="id">eqs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">RecMaybe_pf_some_helper</span> (<span class="id">z</span>:<span class="id">bool</span>) <span class="id">f</span> <span class="id">pf</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">z</span> = <span class="id">true</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id">z</span> <span class="kwd">as</span> <span class="id">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">return</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">z</span> = <span class="id">b</span> -&gt; <span class="id">option</span> <span class="id">rtype</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">pf</span> : <span class="id">z</span> = <span class="id">true</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">pf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">_</span> : <span class="id">z</span> = <span class="id">false</span> =&gt; <span class="id">None</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eq_refl</span> = <span class="id">f</span> <span class="id">pf</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1066')">Proof.</div>
<div class="proofscript" id="proof1066">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">z</span>; <span class="tactic">inversion</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">apply</span> <span class="id">UIP_dec</span>. <span class="tactic">apply</span> <span class="id">bool_dec</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">RecMaybe_pf_some</span> <span class="id">k</span> <span class="id">l</span> <span class="id">pf</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">RecMaybe</span> <span class="id">k</span> <span class="id">l</span> = <span class="id">Some</span> (<span class="id">Rec</span> <span class="id">k</span> <span class="id">l</span> <span class="id">pf</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1067')">Proof.</div>
<div class="proofscript" id="proof1067">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">RecMaybe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (@<span class="id">RecMaybe_pf_some_helper</span> <span class="id">_</span> <span class="id">_</span> <span class="id">pf</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">RecMaybe_nil</span> <span class="id">k</span> : <span class="id">RecMaybe</span> <span class="id">k</span> <span class="id">nil</span> = <span class="id">Some</span> (<span class="id">Rec</span> <span class="id">k</span> <span class="id">nil</span> <span class="id">eq_refl</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1068')">Proof.</div>
<div class="proofscript" id="proof1068">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">RecMaybe_pf_some</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">recmaybe</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">other</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">ftype</span>:<span class="id">foreign_type</span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">br</span>:<span class="id">brand_relation</span>}.<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Rec_inv</span> {<span class="id">k</span> <span class="id">k</span>' <span class="id">x</span> <span class="id">pf1</span> <span class="id">y</span> <span class="id">pf2</span>} : <span class="id">Rec</span> <span class="id">k</span> <span class="id">x</span> <span class="id">pf1</span> = <span class="id">Rec</span> <span class="id">k</span>' <span class="id">y</span> <span class="id">pf2</span> -&gt; <span class="id">x</span> = <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1069')">Proof.</div>
<div class="proofscript" id="proof1069">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Rec</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">map_rtype_fequal</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Rec_kind_inv</span> {<span class="id">k</span> <span class="id">k</span>' <span class="id">x</span> <span class="id">pf1</span> <span class="id">y</span> <span class="id">pf2</span>} : <span class="id">Rec</span> <span class="id">k</span> <span class="id">x</span> <span class="id">pf1</span> = <span class="id">Rec</span> <span class="id">k</span>' <span class="id">y</span> <span class="id">pf2</span> -&gt; <span class="id">k</span> = <span class="id">k</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1070')">Proof.</div>
<div class="proofscript" id="proof1070">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Rec_pr_irrel</span> <span class="id">k</span> <span class="id">l1</span> <span class="id">pf1</span> <span class="id">pf2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Rec</span> <span class="id">k</span> <span class="id">l1</span> <span class="id">pf1</span> = <span class="id">Rec</span> <span class="id">k</span> <span class="id">l1</span> <span class="id">pf2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1071')">Proof.</div>
<div class="proofscript" id="proof1071">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">apply</span> <span class="id">UIP_dec</span>; <span class="tactic">apply</span> <span class="id">bool_dec</span>. <br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Rec_rewrite</span> {<span class="id">l1</span> <span class="id">l2</span>} <span class="id">k</span> <span class="id">pf1</span> <span class="id">pf2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">l1</span> = <span class="id">l2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Rec</span> <span class="id">k</span> <span class="id">l1</span> <span class="id">pf1</span> = <span class="id">Rec</span> <span class="id">k</span> <span class="id">l2</span> <span class="id">pf2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1072')">Proof.</div>
<div class="proofscript" id="proof1072">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eqs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">eqs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Rec_pr_irrel</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Rec_kind_rewrite</span> <span class="id">k1</span> <span class="id">k2</span> <span class="id">l</span> <span class="id">pf</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k1</span> = <span class="id">k2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Rec</span> <span class="id">k1</span> <span class="id">l</span> <span class="id">pf</span> = <span class="id">Rec</span> <span class="id">k2</span> <span class="id">l</span> <span class="id">pf</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1073')">Proof.</div>
<div class="proofscript" id="proof1073">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Coll_right_inv</span> (τ₁ τ₂:<span class="id">rtype</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">proj1_sig</span> τ₁) = <span class="id">Coll</span>₀ (<span class="id">proj1_sig</span> τ₂) &lt;-&gt; τ₁ = <span class="id">Coll</span> τ₂.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1074')">Proof.</div>
<div class="proofscript" id="proof1074">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> τ₁; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> τ₂; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Coll</span> (<span class="id">exist</span> (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) <span class="id">x0</span> <span class="id">e0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id">Coll</span> (<span class="id">exist</span> (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) <span class="id">x0</span> <span class="id">e</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">rtype_fequal</span>. <span class="tactic">simpl</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Coll_inside</span> (τ₁:<span class="id">rtype</span>) (τ₂₀:<span class="id">rtype</span>₀) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">proj1_sig</span> τ₁) = <span class="id">Coll</span>₀ τ₂₀ -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> τ₂:<span class="id">rtype</span>,  <span class="id">proj1_sig</span> τ₂ = τ₂₀.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1075')">Proof.</div>
<div class="proofscript" id="proof1075">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> τ₁. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">exist</span> (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) <span class="id">x</span> <span class="id">e</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">map_rtype_nil</span> <span class="id">x0</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span> (<span class="kwd">fun</span> <span class="id">x2</span> : <span class="id">string</span> * {τ₀ : <span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fst</span> <span class="id">x2</span>, <span class="id">proj1_sig</span> (<span class="id">snd</span> <span class="id">x2</span>))) <span class="id">x0</span> = <span class="id">nil</span> &lt;-&gt; <span class="id">x0</span> = <span class="id">nil</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1076')">Proof.</div>
<div class="proofscript" id="proof1076">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">induction</span> <span class="id">x0</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Rec</span>₀<span class="id">_eq_proj1_Rec</span> {τ <span class="id">k</span> <span class="id">l</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">proj1_sig</span> τ =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Rec</span>₀<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> (<span class="id">map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">string</span> * {τ₀ : <span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fst</span> <span class="id">x</span>, <span class="id">proj1_sig</span> (<span class="id">snd</span> <span class="id">x</span>))) <span class="id">l</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pf</span>, τ = <span class="id">Rec</span> <span class="id">k</span> <span class="id">l</span> <span class="id">pf</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1077')">Proof.</div>
<div class="proofscript" id="proof1077">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> τ; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">to_Rec</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span>  <span class="id">Nat_canon</span> <span class="id">pf</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exist</span> (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) <span class="id">Nat</span>₀ <span class="id">pf</span>) = <span class="id">Nat</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1078')">Proof.</div>
<div class="proofscript" id="proof1078">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">rtype_fequal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span>  <span class="id">String_canon</span> <span class="id">pf</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exist</span> (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) <span class="id">String</span>₀ <span class="id">pf</span>) = <span class="id">String</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1079')">Proof.</div>
<div class="proofscript" id="proof1079">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">rtype_fequal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span>  <span class="id">Coll_canon</span> <span class="id">x</span> <span class="id">pf</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exist</span> (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) (<span class="id">Coll</span>₀ <span class="id">x</span>) <span class="id">pf</span>) = <span class="id">Coll</span> (<span class="id">exist</span> <span class="id">_</span> <span class="id">x</span> <span class="id">pf</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1080')">Proof.</div>
<div class="proofscript" id="proof1080">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">rtype_fequal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span>  <span class="id">Brand_canon</span> <span class="id">x</span> <span class="id">pf</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exist</span> (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) (<span class="id">Brand</span>₀ <span class="id">x</span>) <span class="id">pf</span>) = <span class="id">Brand</span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1081')">Proof.</div>
<div class="proofscript" id="proof1081">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">rtype_fequal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr_in</span> <span class="id">pf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">is_canon_brands_canon_brands</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Foreign_canon</span> <span class="id">ft</span> <span class="id">pf</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exist</span> (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) (<span class="id">Foreign</span>₀ <span class="id">ft</span>) <span class="id">pf</span>) = <span class="id">Foreign</span> <span class="id">ft</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1082')">Proof.</div>
<div class="proofscript" id="proof1082">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">rtype_fequal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Either</span>₀<span class="id">_wf_inv</span> {<span class="id">l</span> <span class="id">r</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wf_rtype</span>₀ (<span class="id">Either</span>₀ <span class="id">l</span> <span class="id">r</span>) = <span class="id">true</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wf_rtype</span>₀ <span class="id">l</span> = <span class="id">true</span> /\ <span class="id">wf_rtype</span>₀ <span class="id">r</span> = <span class="id">true</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1083')">Proof.</div>
<div class="proofscript" id="proof1083">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">andb_true_iff</span>. <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span>  <span class="id">Either_canon</span> <span class="id">l</span> <span class="id">r</span> <span class="id">pf</span> <span class="id">pfl</span> <span class="id">pfr</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exist</span> (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) (<span class="id">Either</span>₀ <span class="id">l</span> <span class="id">r</span>) <span class="id">pf</span>) = <span class="id">Either</span> (<span class="id">exist</span> <span class="id">_</span> <span class="id">l</span> <span class="id">pfl</span>) (<span class="id">exist</span> <span class="id">_</span> <span class="id">r</span> <span class="id">pfr</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1084')">Proof.</div>
<div class="proofscript" id="proof1084">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">rtype_fequal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span>  <span class="id">Either_canon_ex</span> <span class="id">l</span> <span class="id">r</span> <span class="id">pf</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pfl</span> <span class="id">pfr</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exist</span> (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) (<span class="id">Either</span>₀ <span class="id">l</span> <span class="id">r</span>) <span class="id">pf</span>) = <span class="id">Either</span> (<span class="id">exist</span> <span class="id">_</span> <span class="id">l</span> <span class="id">pfl</span>) (<span class="id">exist</span> <span class="id">_</span> <span class="id">r</span> <span class="id">pfr</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1085')">Proof.</div>
<div class="proofscript" id="proof1085">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">pf</span>. <span class="tactic">destruct</span> (<span class="id">Either</span>₀<span class="id">_wf_inv</span> <span class="id">pf</span>) <span class="kwd">as</span> [<span class="id">pfl</span> <span class="id">pfr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pfl</span>; <span class="id">exists</span> <span class="id">pfr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Either_canon</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Arrow</span>₀<span class="id">_wf_inv</span> {<span class="id">l</span> <span class="id">r</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wf_rtype</span>₀ (<span class="id">Arrow</span>₀ <span class="id">l</span> <span class="id">r</span>) = <span class="id">true</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wf_rtype</span>₀ <span class="id">l</span> = <span class="id">true</span> /\ <span class="id">wf_rtype</span>₀ <span class="id">r</span> = <span class="id">true</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1086')">Proof.</div>
<div class="proofscript" id="proof1086">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">andb_true_iff</span>. <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span>  <span class="id">Arrow_canon</span> <span class="id">l</span> <span class="id">r</span> <span class="id">pf</span> <span class="id">pfl</span> <span class="id">pfr</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exist</span> (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) (<span class="id">Arrow</span>₀ <span class="id">l</span> <span class="id">r</span>) <span class="id">pf</span>) = <span class="id">Arrow</span> (<span class="id">exist</span> <span class="id">_</span> <span class="id">l</span> <span class="id">pfl</span>) (<span class="id">exist</span> <span class="id">_</span> <span class="id">r</span> <span class="id">pfr</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1087')">Proof.</div>
<div class="proofscript" id="proof1087">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">rtype_fequal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span>  <span class="id">Arrow_canon_ex</span> <span class="id">l</span> <span class="id">r</span> <span class="id">pf</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pfl</span> <span class="id">pfr</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exist</span> (<span class="kwd">fun</span> τ₀ : <span class="id">rtype</span>₀ =&gt; <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>) (<span class="id">Arrow</span>₀ <span class="id">l</span> <span class="id">r</span>) <span class="id">pf</span>) = <span class="id">Arrow</span> (<span class="id">exist</span> <span class="id">_</span> <span class="id">l</span> <span class="id">pfl</span>) (<span class="id">exist</span> <span class="id">_</span> <span class="id">r</span> <span class="id">pfr</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1088')">Proof.</div>
<div class="proofscript" id="proof1088">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">pf</span>. <span class="tactic">destruct</span> (<span class="id">Arrow</span>₀<span class="id">_wf_inv</span> <span class="id">pf</span>) <span class="kwd">as</span> [<span class="id">pfl</span> <span class="id">pfr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pfl</span>; <span class="id">exists</span> <span class="id">pfr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Arrow_canon</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">wf_rtype</span>₀<span class="id">_Rec_In</span> {<span class="id">k</span> <span class="id">srl</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">wf_rtype</span>₀ (<span class="id">Rec</span>₀ <span class="id">k</span> <span class="id">srl</span>) = <span class="id">true</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, <span class="id">In</span> (<span class="id">a</span>,<span class="id">b</span>) <span class="id">srl</span> -&gt; <span class="id">wf_rtype</span>₀ <span class="id">b</span> = <span class="id">true</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1089')">Proof.</div>
<div class="proofscript" id="proof1089">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="kwd">wf</span> <span class="id">a</span> <span class="id">b</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">andb_true_iff</span> <span class="kwd">in</span> <span class="kwd">wf</span>. <span class="tactic">destruct</span> <span class="kwd">wf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">forallb_forall</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H0</span> <span class="id">_</span> <span class="id">inn</span>).<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">wf_rec_pf_sublist</span> {<span class="id">B</span>} {<span class="id">l</span> <span class="id">l</span>'} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">is_list_sorted</span> <span class="id">ODT_lt_dec</span> (@<span class="id">domain</span> <span class="id">_</span> <span class="id">B</span> <span class="id">l</span>) = <span class="id">true</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sublist</span> <span class="id">l</span>' <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">is_list_sorted</span> <span class="id">ODT_lt_dec</span> (<span class="id">domain</span> <span class="id">l</span>') = <span class="id">true</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1090')">Proof.</div>
<div class="proofscript" id="proof1090">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">sl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">is_list_sorted_sublist</span>; <span class="tactic">eauto</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sublist_domain</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">lift_Rec</span>₀<span class="id">_injective</span> {<span class="id">k</span>₁ <span class="id">k</span>₂ <span class="id">l1</span> <span class="id">l2</span>} : <span class="id">lift</span> (<span class="id">Rec</span>₀ <span class="id">k</span>₁) <span class="id">l1</span> = <span class="id">lift</span> (<span class="id">Rec</span>₀ <span class="id">k</span>₂) <span class="id">l2</span> -&gt; <span class="id">l1</span> = <span class="id">l2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1091')">Proof.</div>
<div class="proofscript" id="proof1091">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l1</span>; <span class="tactic">destruct</span> <span class="id">l2</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">inversion</span> 1; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">some_lift_Rec</span>₀ {<span class="id">k</span>₁ <span class="id">k</span>₂ <span class="id">x</span> <span class="id">y</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lift</span> (<span class="id">Rec</span>₀ <span class="id">k</span>₁) <span class="id">x</span> = <span class="id">Some</span> (<span class="id">Rec</span>₀ <span class="id">k</span>₂ <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> = <span class="id">Some</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1092')">Proof.</div>
<div class="proofscript" id="proof1092">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eq</span>. <span class="tactic">apply</span> <span class="id">some_lift</span> <span class="kwd">in</span> <span class="id">eq</span>. <span class="tactic">destruct</span> <span class="id">eq</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">e0</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">lift_Coll</span>₀<span class="id">_injective</span> {<span class="id">l1</span> <span class="id">l2</span>} : <span class="id">lift</span> <span class="id">Coll</span>₀ <span class="id">l1</span> = <span class="id">lift</span> <span class="id">Coll</span>₀ <span class="id">l2</span> -&gt; <span class="id">l1</span> = <span class="id">l2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1093')">Proof.</div>
<div class="proofscript" id="proof1093">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">lift_injective</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 1; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">some_lift_Coll</span>₀ {<span class="id">x</span> <span class="id">y</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lift</span> <span class="id">Coll</span>₀ <span class="id">x</span> = <span class="id">Some</span> (<span class="id">Coll</span>₀ <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> = <span class="id">Some</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1094')">Proof.</div>
<div class="proofscript" id="proof1094">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eq</span>. <span class="tactic">apply</span> <span class="id">some_lift</span> <span class="kwd">in</span> <span class="id">eq</span>. <span class="tactic">destruct</span> <span class="id">eq</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">e0</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">lift_Coll_injective</span> {<span class="id">l1</span> <span class="id">l2</span>} : <span class="id">lift</span> <span class="id">Coll</span> <span class="id">l1</span> = <span class="id">lift</span> <span class="id">Coll</span> <span class="id">l2</span> -&gt; <span class="id">l1</span> = <span class="id">l2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1095')">Proof.</div>
<div class="proofscript" id="proof1095">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">lift_injective</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 1; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">rtype_fequal</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">some_lift_Coll</span> {<span class="id">x</span> <span class="id">y</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lift</span> <span class="id">Coll</span> <span class="id">x</span> = <span class="id">Some</span> (<span class="id">Coll</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> = <span class="id">Some</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1096')">Proof.</div>
<div class="proofscript" id="proof1096">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">eq</span>. <span class="tactic">apply</span> <span class="id">some_lift</span> <span class="kwd">in</span> <span class="id">eq</span>. <span class="tactic">destruct</span> <span class="id">eq</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">e0</span>. <span class="tactic">f_equal</span>. <span class="tactic">apply</span> <span class="id">rtype_fequal</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">lift_col</span>₀<span class="id">_some_col</span>₀ {<span class="id">x</span> <span class="id">y</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lift</span> <span class="id">Coll</span>₀ <span class="id">x</span> = <span class="id">Some</span> <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">z</span> | <span class="id">y</span> = <span class="id">Coll</span>₀ <span class="id">z</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1097')">Proof.</div>
<div class="proofscript" id="proof1097">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">simpl</span>; <span class="tactic">inversion</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">lift_col_some_col</span> {<span class="id">x</span> <span class="id">y</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lift</span> <span class="id">Coll</span> <span class="id">x</span> = <span class="id">Some</span> <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">z</span> | <span class="id">y</span> = <span class="id">Coll</span> <span class="id">z</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1098')">Proof.</div>
<div class="proofscript" id="proof1098">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">simpl</span>; <span class="tactic">inversion</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">lift_rec</span>₀<span class="id">_some_rec</span>₀ {<span class="id">k</span> <span class="id">x</span> <span class="id">y</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lift</span> (<span class="id">Rec</span>₀ <span class="id">k</span>) <span class="id">x</span> = <span class="id">Some</span> <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">z</span> | <span class="id">y</span> = <span class="id">Rec</span>₀ <span class="id">k</span> <span class="id">z</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1099')">Proof.</div>
<div class="proofscript" id="proof1099">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">simpl</span>; <span class="tactic">inversion</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">isTop</span> (τ:<span class="id">rtype</span>) : <span class="id">bool</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> τ. <span class="tactic">destruct</span> <span class="id">x</span>; [ | <span class="tactic">exact</span> <span class="id">true</span> | .. ]; <span class="tactic">exact</span> <span class="id">false</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">istop</span> τ :  {τ = <span class="id">Top</span>} + {<span class="id">isTop</span> τ = <span class="id">false</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1100')">Proof.</div>
<div class="proofscript" id="proof1100">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> τ <span class="kwd">using</span> <span class="id">rtype_rect</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">other</span>.<br/>
<br/>
<span class="kwd">Notation</span> "⊥₀" := <span class="id">Bottom</span>₀.<br/>
<span class="kwd">Notation</span> "⊤₀" := <span class="id">Top</span>₀.<br/>
<span class="kwd">Notation</span> "<span class="id">a</span> ~~&gt;₀ <span class="id">b</span>" := (<span class="id">Arrow</span>₀ <span class="id">a</span> <span class="id">b</span>) (<span class="tactic">at</span> <span class="id">level</span> 99, <span class="id">right</span> <span class="id">associativity</span>).<br/>
<br/>
<span class="kwd">Notation</span> "⊥" := <span class="id">Bottom</span>.<br/>
<span class="kwd">Notation</span> "⊤" := <span class="id">Top</span>.<br/>
<span class="kwd">Notation</span> "<span class="id">a</span> ~~&gt; <span class="id">b</span>" := (<span class="id">Arrow</span> <span class="id">a</span> <span class="id">b</span>) (<span class="tactic">at</span> <span class="id">level</span> 99, <span class="id">right</span> <span class="id">associativity</span>).<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">rtype_equalizer</span> := <br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>:(@<span class="id">eq</span> <span class="id">rtype</span>₀ (<span class="id">proj1_sig</span> <span class="id">_</span>) (<span class="id">proj1_sig</span> <span class="id">_</span>)) |- <span class="id">_</span>] =&gt; <span class="tactic">apply</span> <span class="id">rtype_fequal</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id">map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">string</span> * {τ₀ : <span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀ = <span class="id">true</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fst</span> <span class="id">x</span>, <span class="id">proj1_sig</span> (<span class="id">snd</span> <span class="id">x</span>))) <span class="id">_</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span>' : <span class="id">string</span> * {τ₀' : <span class="id">rtype</span>₀ | <span class="id">wf_rtype</span>₀ τ₀' = <span class="id">true</span>} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fst</span> <span class="id">x</span>', <span class="id">proj1_sig</span> (<span class="id">snd</span> <span class="id">x</span>'))) <span class="id">_</span> |- <span class="id">_</span>] =&gt; <span class="tactic">apply</span> <span class="id">map_rtype_fequal</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">r_ext</span> := <span class="id">solve</span> [<span class="id">erewrite</span> (<span class="id">rtype_ext</span>); <span class="tactic">eauto</span>].<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">rtype_lift_simpler</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id">lift</span> ?<span class="id">f</span> ?<span class="id">x</span> = <span class="id">Some</span> (?<span class="id">f</span> ?<span class="id">y</span>)] =&gt; <span class="tactic">apply</span> (<span class="id">lift_some</span> <span class="id">y</span>); [|<span class="tactic">reflexivity</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id">lift</span> ?<span class="id">f</span> ?<span class="id">x</span> = <span class="id">None</span>] =&gt; <span class="tactic">apply</span> <span class="id">lift_none</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>:<span class="id">lift</span> ?<span class="id">f</span> ?<span class="id">x</span> = <span class="id">None</span> |- <span class="id">_</span>] =&gt; <span class="tactic">apply</span> <span class="id">none_lift</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id">lift</span> (<span class="id">Rec</span>₀ <span class="id">_</span>) ?<span class="id">l1</span> = <span class="id">Some</span> (<span class="id">Rec</span>₀ <span class="id">_</span> ?<span class="id">l2</span>) |- <span class="id">_</span> ] =&gt; <span class="tactic">apply</span> <span class="id">some_lift_Rec</span>₀ <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id">lift</span> (<span class="id">Rec</span>₀ <span class="id">_</span>) ?<span class="id">l1</span> = <span class="id">lift</span> (<span class="id">Rec</span>₀ <span class="id">_</span>) ?<span class="id">l2</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">apply</span> <span class="id">lift_Rec</span>₀<span class="id">_injective</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id">lift</span> <span class="id">Coll</span>₀ ?<span class="id">l1</span> = <span class="id">Some</span> (<span class="id">Coll</span>₀ ?<span class="id">l2</span>) |- <span class="id">_</span> ] =&gt; <span class="tactic">apply</span> <span class="id">some_lift_Coll</span>₀ <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id">lift</span> <span class="id">Coll</span>₀ ?<span class="id">l1</span> = <span class="id">lift</span> <span class="id">Coll</span>₀ ?<span class="id">l2</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">apply</span> <span class="id">lift_Coll</span>₀<span class="id">_injective</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id">lift</span> <span class="id">Coll</span> ?<span class="id">l1</span> = <span class="id">Some</span> (<span class="id">Coll</span> ?<span class="id">l2</span>) |- <span class="id">_</span> ] =&gt; <span class="tactic">apply</span> <span class="id">some_lift_Coll</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id">lift</span> <span class="id">Coll</span> ?<span class="id">l1</span> = <span class="id">lift</span> <span class="id">Coll</span> ?<span class="id">l2</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">apply</span> <span class="id">lift_Coll_injective</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Cases tactic for use with the derived rtypeRectt induction principle </div>
&nbsp;&nbsp;<span class="kwd">Tactic</span> <span class="kwd">Notation</span> "<span class="id">rtype_rect_cases</span>" <span class="id">tactic</span>(<span class="id">first</span>) <span class="id">ident</span>(<span class="id">c</span>) :=<br/>
&nbsp;&nbsp;<span class="id">first</span>;<br/>
&nbsp;&nbsp;[ <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Top</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Bottom</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Unit</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Nat</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Bool</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">String</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Coll</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Rec</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Either</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Arrow</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Brand</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;| <span class="id">Case_aux</span> <span class="id">c</span> "<span class="id">Foreign</span>"%<span class="id">string</span><br/>
&nbsp;&nbsp;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
