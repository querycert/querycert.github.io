
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Qcert.Translation.TOQLtoNRAEnv</title>
<meta name="description" content="Documentation of Coq module Qcert.Translation.TOQLtoNRAEnv" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Qcert.Translation.TOQLtoNRAEnv</h1>
<div class="coq">
<br/>
<span class="kwd">Section</span> <span class="id">TOQLtoNRAEnv</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">String</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">List</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Arith</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Omega</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">EquivDec</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Morphisms</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">BasicSystem</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">OQLSystem</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">NRAEnvSystem</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">OQLtoNRAEnv</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">m</span>:<span class="id">basic_model</span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">oql_to_nraenv_expr_type_preserve_f</span> τ<span class="id">constant</span> τ<span class="id">defls</span> <span class="id">pfd</span> τ<span class="id">env</span> <span class="id">pfe</span> <span class="id">e</span> τ<span class="id">out</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">oql_expr_type</span> (<span class="id">rec_concat_sort</span> τ<span class="id">constant</span> τ<span class="id">defls</span>) τ<span class="id">env</span> <span class="id">e</span> τ<span class="id">out</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nraenv_type</span> τ<span class="id">constant</span> (<span class="id">oql_to_nraenv_expr</span> (<span class="id">domain</span> τ<span class="id">defls</span>) <span class="id">e</span>) (<span class="id">Rec</span> <span class="id">Closed</span> τ<span class="id">defls</span> <span class="id">pfd</span>) (<span class="id">Rec</span> <span class="id">Closed</span> τ<span class="id">env</span> <span class="id">pfe</span>) τ<span class="id">out</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3023')">Proof.</div>
<div class="proofscript" id="proof3023">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">nraenv_type</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id">nraenv_core_type</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> τ<span class="id">constant</span> τ<span class="id">defls</span> <span class="id">pfd</span> τ<span class="id">env</span> <span class="id">pfe</span> τ<span class="id">out</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">e</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> τ<span class="id">constant</span> τ<span class="id">defls</span> <span class="id">pfd</span> τ<span class="id">env</span> <span class="id">pfe</span> τ<span class="id">out</span> <span class="id">ot</span>; <span class="id">invcs</span> <span class="id">ot</span>; <span class="tactic">eauto</span> 4.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">lookup_table</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">tdot</span>, <span class="id">edot</span>, <span class="id">rec_concat_sort</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">assoc_lookupr_drec_sort</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">assoc_lookupr_app</span> τ<span class="id">constant</span> τ<span class="id">defls</span> <span class="id">_</span> <span class="id">ODT_eqdec</span>) <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">econstructor</span>; [ | <span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">in_dom_lookupr</span> <span class="kwd">with</span> (<span class="id">dec</span>:=<span class="id">ODT_eqdec</span>) <span class="kwd">in</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span> <span class="kwd">as</span> [? ?].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case_in</span> <span class="id">H1</span>; [<span class="tactic">intros</span> ? <span class="id">eqq</span> | <span class="tactic">intros</span> <span class="id">eqq</span>]; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">invcs</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">assoc_lookupr_nin_none</span> <span class="kwd">with</span> (<span class="id">dec</span>:=<span class="id">ODT_eqdec</span>) <span class="kwd">in</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">n</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">oql_to_nraenv_query_program_type_preserve_f</span> τ<span class="id">constant</span> τ<span class="id">defls</span> <span class="id">pfd</span> τ<span class="id">env</span> <span class="id">pfe</span> <span class="id">oq</span> τ<span class="id">out</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">oql_query_program_type</span> τ<span class="id">constant</span> τ<span class="id">defls</span> τ<span class="id">env</span> <span class="id">oq</span> τ<span class="id">out</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nraenv_type</span> τ<span class="id">constant</span> (<span class="id">oql_to_nraenv_query_program</span> (<span class="id">domain</span> τ<span class="id">defls</span>) <span class="id">oq</span>) (<span class="id">Rec</span> <span class="id">Closed</span> τ<span class="id">defls</span> <span class="id">pfd</span>) (<span class="id">Rec</span> <span class="id">Closed</span> τ<span class="id">env</span> <span class="id">pfe</span>) τ<span class="id">out</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3024')">Proof.</div>
<div class="proofscript" id="proof3024">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">nraenv_type</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id">nraenv_core_type</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> τ<span class="id">defls</span> <span class="id">pfd</span> τ<span class="id">env</span> <span class="id">pfe</span> τ<span class="id">out</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">oq</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> τ<span class="id">defls</span> <span class="id">pfd</span> τ<span class="id">env</span> <span class="id">pfe</span> τ<span class="id">out</span> <span class="id">ot</span>; <span class="id">invcs</span> <span class="id">ot</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">oql_to_nraenv_expr_type_preserve_f</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHoq</span> (<span class="id">rec_concat_sort</span> τ<span class="id">defls</span> ((<span class="id">s</span>, τ₁) :: <span class="id">nil</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">eqls</span>:<span class="id">equivlist</span> (<span class="id">s</span> :: <span class="id">domain</span> τ<span class="id">defls</span>) (<span class="id">domain</span> (<span class="id">rec_concat_sort</span> τ<span class="id">defls</span> ((<span class="id">s</span>, τ₁) :: <span class="id">nil</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">rewrite</span> <span class="id">rec_concat_sort_domain_app_commutatuve_equiv</span>; <span class="tactic">simpl</span>; <span class="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">eqls</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHoq</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">domain_rremove</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">oql_to_nraenv_expr_type_preserve_f</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Grab</span> <span class="id">Existential</span> <span class="kwd">Variables</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve</span>[<span class="tactic">apply</span> <span class="id">is_sorted_rremove</span>; <span class="tactic">trivial</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve</span>[<span class="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve</span>[<span class="tactic">simpl</span>; <span class="tactic">trivial</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Theorem</span> <span class="id">oql_to_nraenv_type_preserve_f</span> τ<span class="id">constant</span> <span class="id">oq</span> τ<span class="id">out</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">oql_type</span> τ<span class="id">constant</span> <span class="id">oq</span> τ<span class="id">out</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> τ<span class="id">env</span> τ<span class="id">data</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nraenv_type</span> τ<span class="id">constant</span> (<span class="id">oql_to_nraenv</span> <span class="id">oq</span>) τ<span class="id">env</span> τ<span class="id">data</span> τ<span class="id">out</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3025')">Proof.</div>
<div class="proofscript" id="proof3025">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">ot</span> τ<span class="id">env</span> τ<span class="id">data</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">oql_to_nraenv</span>, <span class="id">nraenv_type</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">oql_to_nraenv_query_program_type_preserve_f</span> τ<span class="id">constant</span> <span class="id">nil</span> <span class="id">sorted_rec_nil</span> <span class="id">nil</span> <span class="id">sorted_rec_nil</span> <span class="id">oq</span> τ<span class="id">out</span> <span class="id">ot</span>); <span class="tactic">intros</span> <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">nraenv_type</span> <span class="kwd">in</span> <span class="id">et</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="id">econstructor</span>; <span class="tactic">try</span> <span class="id">eassumption</span>; <span class="tactic">repeat</span> <span class="id">econstructor</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">sorted_rec_nil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
<span class="kwd">End</span> <span class="id">TOQLtoNRAEnv</span>.<br/>
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
