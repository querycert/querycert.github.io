
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Qcert.Basic.Util.RFresh</title>
<meta name="description" content="Documentation of Coq module Qcert.Basic.Util.RFresh" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Qcert.Basic.Util.RFresh</h1>
<div class="coq">
<br/>
<span class="kwd">Section</span> <span class="id">RFresh</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">String</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">List</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Arith</span> <span class="id">Min</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">EquivDec</span> <span class="id">Omega</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Digits</span> <span class="id">RLift</span> <span class="id">RUtil</span> <span class="id">RList</span> <span class="id">RSublist</span> <span class="id">RString</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id">finder</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span>:<span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> (<span class="id">incr</span>:<span class="id">A</span>-&gt;<span class="id">A</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> (<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">bool</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id">find_bounded</span> (<span class="id">bound</span>:<span class="id">nat</span>) (<span class="id">init</span>:<span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">bound</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">O</span> =&gt; <span class="id">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">S</span> <span class="id">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">f</span> <span class="id">init</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id">Some</span> <span class="id">init</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id">find_bounded</span> <span class="id">n</span> (<span class="id">incr</span> <span class="id">init</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">find_bounded_correct</span> <span class="id">bound</span> <span class="id">init</span> <span class="id">y</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_bounded</span> <span class="id">bound</span> <span class="id">init</span> = <span class="id">Some</span> <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">y</span> = <span class="id">true</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof491')">Proof.</div>
<div class="proofscript" id="proof491">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">init</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">match_case_in</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">eqq</span>; <span class="tactic">rewrite</span> <span class="id">eqq</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id">finder</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">find_bounded_S_ge</span> <span class="id">f</span> <span class="id">bound</span> <span class="id">init</span> <span class="id">y</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_bounded</span> <span class="id">S</span> <span class="id">f</span> <span class="id">bound</span> <span class="id">init</span> = <span class="id">Some</span> <span class="id">y</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">y</span> &gt;= <span class="id">init</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof492')">Proof.</div>
<div class="proofscript" id="proof492">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">init</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">match_destr_in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">IHbound</span> (<span class="id">S</span> <span class="id">init</span>) <span class="id">_</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">find_bounded_S_seq</span> <span class="id">f</span> <span class="id">bound</span> <span class="id">init</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find_bounded</span> <span class="id">S</span> <span class="id">f</span> <span class="id">bound</span> <span class="id">init</span> = <span class="id">find</span> <span class="id">f</span> (<span class="id">seq</span> <span class="id">init</span> <span class="id">bound</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof493')">Proof.</div>
<div class="proofscript" id="proof493">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">init</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Permutation</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">incl_NoDup_sublist_perm</span> {<span class="id">A</span>} {<span class="id">dec</span>:<span class="id">EqDec</span> <span class="id">A</span> <span class="id">eq</span>} {<span class="id">l1</span> <span class="id">l2</span>:<span class="id">list</span> <span class="id">A</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">NoDup</span> <span class="id">l1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">incl</span> <span class="id">l1</span> <span class="id">l2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">l1</span>', <span class="id">Permutation</span> <span class="id">l1</span> <span class="id">l1</span>' /\ <span class="id">sublist</span> <span class="id">l1</span>' <span class="id">l2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof494')">Proof.</div>
<div class="proofscript" id="proof494">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">incl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">l1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l2</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">l1</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span> 3.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">inn</span> <span class="id">a</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">In_dec</span> <span class="id">dec</span> <span class="id">a</span> <span class="id">l1</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">in_split</span> <span class="id">_</span> <span class="id">_</span> <span class="id">i</span>) <span class="kwd">as</span> [<span class="id">x</span> [<span class="id">y</span> ?]]; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">perm</span>:<span class="id">Permutation</span> (<span class="id">x</span> ++ <span class="id">a</span> :: <span class="id">y</span>) (<span class="id">a</span>::<span class="id">x</span> ++ <span class="id">y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">rewrite</span> <span class="id">Permutation_middle</span>; <span class="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">perm</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">IHl2</span> (<span class="id">x</span>++<span class="id">y</span>)) <span class="kwd">as</span> [<span class="id">l1</span>' [<span class="id">l1</span>'<span class="id">perm</span> <span class="id">l1</span>'<span class="id">incl</span>]]; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span> ? <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id">H0</span> <span class="id">a0</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">perm</span>; <span class="tactic">simpl</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">subst</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exists</span> (<span class="id">a</span>::<span class="id">l1</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">perm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">sublist_cons</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">IHl2</span> <span class="id">l1</span> <span class="id">H</span>) <span class="kwd">as</span> [<span class="id">x</span> [<span class="id">perm</span> <span class="id">subl</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">intros</span> ? <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H0</span> <span class="id">_</span> <span class="id">inn</span>); <span class="tactic">subst</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exists</span> <span class="id">x</span>; <span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sublist_skip</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">incl_NoDup_length_le</span> {<span class="id">A</span>} {<span class="id">dec</span>:<span class="id">EqDec</span> <span class="id">A</span> <span class="id">eq</span>} {<span class="id">l1</span> <span class="id">l2</span>:<span class="id">list</span> <span class="id">A</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">NoDup</span> <span class="id">l1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">incl</span> <span class="id">l1</span> <span class="id">l2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">length</span> <span class="id">l1</span> &lt;= <span class="id">length</span> <span class="id">l2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof495')">Proof.</div>
<div class="proofscript" id="proof495">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">nd</span> <span class="id">inc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">incl_NoDup_sublist_perm</span> <span class="id">nd</span> <span class="id">inc</span>) <span class="kwd">as</span> [<span class="id">l1</span>' [<span class="id">perm</span> <span class="id">subl</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">Permutation_length</span> <span class="id">perm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">sublist_length</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">find_fresh_from</span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">dec</span>:<span class="id">EqDec</span> <span class="id">A</span> <span class="id">eq</span>} (<span class="id">bad</span> <span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">length</span> <span class="id">l</span> &gt; <span class="id">length</span> <span class="id">bad</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">NoDup</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">y</span> | <span class="id">find</span> (<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">A</span> =&gt; <span class="kwd">if</span> <span class="id">in_dec</span> <span class="id">equiv_dec</span> <span class="id">x</span> <span class="id">bad</span> <span class="kwd">then</span> <span class="id">false</span> <span class="kwd">else</span> <span class="id">true</span>) <span class="id">l</span> = <span class="id">Some</span> <span class="id">y</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof496')">Proof.</div>
<div class="proofscript" id="proof496">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">find_filter</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">hd_error</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>; <span class="tactic">eauto</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">filter_nil_implies_not_pred</span> <span class="id">_</span> <span class="id">l</span> <span class="id">H</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id">length</span> <span class="id">l</span> &lt;= <span class="id">length</span> <span class="id">bad</span>); [<span class="tactic">intuition</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">incl_NoDup_length_le</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">_</span> <span class="id">inn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr_in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">find_over_map</span> {<span class="id">A</span> <span class="id">B</span>} <span class="id">f</span> (<span class="id">g</span>:<span class="id">A</span>-&gt;<span class="id">B</span>) (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">find</span> <span class="id">f</span> (<span class="id">map</span> <span class="id">g</span> <span class="id">l</span>) = <span class="id">lift</span> <span class="id">g</span> (<span class="id">find</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> (<span class="id">g</span> <span class="id">x</span>)) <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof497')">Proof.</div>
<div class="proofscript" id="proof497">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">seq_ge</span> <span class="id">init</span> <span class="id">bound</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">In</span> <span class="id">x</span> (<span class="id">seq</span> <span class="id">init</span> <span class="id">bound</span>) -&gt; <span class="id">x</span> &gt;= <span class="id">init</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof498')">Proof.</div>
<div class="proofscript" id="proof498">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">init</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbound</span> (<span class="id">S</span> <span class="id">init</span>) <span class="id">x</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">seq_NoDup</span> <span class="id">init</span> <span class="id">bound</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">NoDup</span> (<span class="id">seq</span> <span class="id">init</span> <span class="id">bound</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof499')">Proof.</div>
<div class="proofscript" id="proof499">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">init</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">bound</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">seq_ge</span> <span class="kwd">in</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">find_bounded_S_nin_finds</span>' {<span class="id">A</span>:<span class="kwd">Type</span>} <span class="id">f</span> {<span class="id">dec</span>:<span class="id">EqDec</span> <span class="id">A</span> <span class="id">eq</span>} (<span class="id">dom</span>:<span class="id">list</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">bound</span>:<span class="id">nat</span>) (<span class="id">pf</span>:<span class="id">bound</span> &gt; <span class="id">length</span> <span class="id">dom</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">inj</span>:<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">f</span> <span class="id">x</span> = <span class="id">f</span> <span class="id">y</span> -&gt; <span class="id">x</span> = <span class="id">y</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">y</span>:<span class="id">A</span> | <span class="id">lift</span> <span class="id">f</span> (<span class="id">find_bounded</span> <span class="id">S</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">in_dec</span> <span class="id">equiv_dec</span> (<span class="id">f</span> <span class="id">x</span>) <span class="id">dom</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id">false</span> <span class="kwd">else</span> <span class="id">true</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bound</span> 0) = <span class="id">Some</span> <span class="id">y</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof500')">Proof.</div>
<div class="proofscript" id="proof500">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">find_bounded_S_seq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id">find_over_map</span> (<span class="kwd">fun</span> <span class="id">x</span>  =&gt; <span class="kwd">if</span> <span class="id">in_dec</span> <span class="id">equiv_dec</span> <span class="id">x</span> <span class="id">dom</span> <span class="kwd">then</span> <span class="id">false</span> <span class="kwd">else</span> <span class="id">true</span>) <span class="id">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">find_fresh_from</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">map_length</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">seq_length</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">map_inj_NoDup</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">seq_NoDup</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">find_bounded_S_nin_finds</span> {<span class="id">A</span>:<span class="kwd">Type</span>} <span class="id">f</span> {<span class="id">dec</span>:<span class="id">EqDec</span> <span class="id">A</span> <span class="id">eq</span>} (<span class="id">dom</span>:<span class="id">list</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">bound</span>:<span class="id">nat</span>) (<span class="id">pf</span>:<span class="id">bound</span> &gt; <span class="id">length</span> <span class="id">dom</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">inj</span>:<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">f</span> <span class="id">x</span> = <span class="id">f</span> <span class="id">y</span> -&gt; <span class="id">x</span> = <span class="id">y</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">y</span>:<span class="id">A</span> | <span class="id">lift</span> <span class="id">f</span> (<span class="id">find_bounded</span> <span class="id">S</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">in_dec</span> <span class="id">equiv_dec</span> (<span class="id">f</span> <span class="id">x</span>) <span class="id">dom</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id">false</span> <span class="kwd">else</span> <span class="id">true</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bound</span> 0) = <span class="id">Some</span> <span class="id">y</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof501')">Proof.</div>
<div class="proofscript" id="proof501">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">find_bounded</span> <span class="id">S</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> : <span class="id">nat</span> =&gt; <span class="kwd">if</span> <span class="id">in_dec</span> <span class="id">equiv_dec</span> (<span class="id">f</span> <span class="id">x</span>) <span class="id">dom</span> <span class="kwd">then</span> <span class="id">false</span> <span class="kwd">else</span> <span class="id">true</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bound</span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">f</span> <span class="id">n</span>); <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">find_bounded_S_nin_finds</span>' <span class="id">f</span> <span class="id">dom</span> <span class="id">bound</span> <span class="id">pf</span> <span class="id">inj</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">e</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;Defined.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">compose_inj</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">C</span>} (<span class="id">f</span>:<span class="id">B</span>-&gt;<span class="id">C</span>) (<span class="id">g</span>:<span class="id">A</span>-&gt;<span class="id">B</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">f</span> <span class="id">x</span> = <span class="id">f</span> <span class="id">y</span> -&gt; <span class="id">x</span> = <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">g</span> <span class="id">x</span> = <span class="id">g</span> <span class="id">y</span> -&gt; <span class="id">x</span> = <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">f</span> (<span class="id">g</span> <span class="id">x</span>) = <span class="id">f</span> (<span class="id">g</span> <span class="id">y</span>) -&gt; <span class="id">x</span> = <span class="id">y</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof502')">Proof.</div>
<div class="proofscript" id="proof502">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">find_fresh_inj_f</span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">dec</span>:<span class="id">EqDec</span> <span class="id">A</span> <span class="id">eq</span>} <span class="id">f</span> (<span class="id">inj</span>:<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">f</span> <span class="id">x</span> = <span class="id">f</span> <span class="id">y</span> -&gt; <span class="id">x</span> = <span class="id">y</span>) (<span class="id">dom</span>:<span class="id">list</span> <span class="id">A</span>) : <span class="id">A</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id">proj1_sig</span> (<span class="id">find_bounded_S_nin_finds</span> <span class="id">f</span> <span class="id">dom</span> (<span class="id">S</span> (<span class="id">length</span> <span class="id">dom</span>)) (<span class="id">gt_Sn_n</span> <span class="id">_</span>) <span class="id">inj</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">find_fresh_inj_f_fresh</span> {<span class="id">A</span>:<span class="kwd">Type</span>} {<span class="id">dec</span>:<span class="id">EqDec</span> <span class="id">A</span> <span class="id">eq</span>} <span class="id">f</span> (<span class="id">inj</span>:<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">f</span> <span class="id">x</span> = <span class="id">f</span> <span class="id">y</span> -&gt; <span class="id">x</span> = <span class="id">y</span>) (<span class="id">dom</span>:<span class="id">list</span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id">In</span> (<span class="id">find_fresh_inj_f</span> <span class="id">f</span> <span class="id">inj</span> <span class="id">dom</span>) <span class="id">dom</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof503')">Proof.</div>
<div class="proofscript" id="proof503">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">find_fresh_inj_f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id">context</span>[ <span class="id">proj1_sig</span> ?<span class="id">x</span> ]] =&gt; <span class="tactic">destruct</span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">some_lift</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span> <span class="kwd">as</span> [? <span class="id">e</span> ?]; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">find_bounded_correct</span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr_in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">find_fresh_string</span> (<span class="id">dom</span>:<span class="id">list</span> <span class="id">string</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id">find_fresh_inj_f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nat_to_string16</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nat_to_string16_inj</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dom</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">find_fresh_string_is_fresh</span> (<span class="id">dom</span>:<span class="id">list</span> <span class="id">string</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id">In</span> (<span class="id">find_fresh_string</span> <span class="id">dom</span>) <span class="id">dom</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof504')">Proof.</div>
<div class="proofscript" id="proof504">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">find_fresh_string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">find_fresh_inj_f_fresh</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">append_eq_inv1</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> : <span class="id">append</span> <span class="id">x</span> <span class="id">y</span> = <span class="id">append</span> <span class="id">x</span> <span class="id">z</span> -&gt; <span class="id">y</span> = <span class="id">z</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof505')">Proof.</div>
<div class="proofscript" id="proof505">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">y</span> <span class="id">z</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">x</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">prefix_refl</span> <span class="id">y</span> : <span class="id">prefix</span> <span class="id">y</span> <span class="id">y</span> = <span class="id">true</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof506')">Proof.</div>
<div class="proofscript" id="proof506">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">y</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">substring_append_cancel</span> <span class="id">x</span> <span class="id">y</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">substring</span> (<span class="id">String.length</span> <span class="id">x</span>) (<span class="id">String.length</span> <span class="id">y</span>) (<span class="id">append</span> <span class="id">x</span> <span class="id">y</span>) = <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof507')">Proof.</div>
<div class="proofscript" id="proof507">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">x</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">prefix_correct</span>. <span class="tactic">apply</span> <span class="id">prefix_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">string_length_append</span> <span class="id">x</span> <span class="id">y</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">String.length</span> (<span class="id">append</span> <span class="id">x</span> <span class="id">y</span>) = <span class="id">String.length</span> <span class="id">x</span> + <span class="id">String.length</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof508')">Proof.</div>
<div class="proofscript" id="proof508">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">x</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">prefix_nil</span> <span class="id">post</span> : <span class="id">prefix</span> ""%<span class="id">string</span> <span class="id">post</span> = <span class="id">true</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof509')">Proof.</div>
<div class="proofscript" id="proof509">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">post</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">prefix_app</span> <span class="id">pre</span> <span class="id">post</span> : <span class="id">prefix</span> <span class="id">pre</span> (<span class="id">append</span> <span class="id">pre</span> <span class="id">post</span>) = <span class="id">true</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof510')">Proof.</div>
<div class="proofscript" id="proof510">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">post</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">pre</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">prefix_nil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">match_destr</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">prefix_break</span> {<span class="id">pre</span> <span class="id">x</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prefix</span> <span class="id">pre</span> <span class="id">x</span> = <span class="id">true</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">y</span> | <span class="id">x</span> = <span class="id">append</span> <span class="id">pre</span> <span class="id">y</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof511')">Proof.</div>
<div class="proofscript" id="proof511">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">pre</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">intros</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">IHpre</span> <span class="id">_</span> <span class="id">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">substring_split</span> <span class="id">s</span> <span class="id">n</span> <span class="id">m</span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">append</span> (<span class="id">substring</span> <span class="id">s</span> <span class="id">n</span> <span class="id">l</span>) (<span class="id">substring</span> (<span class="id">s</span>+<span class="id">n</span>) <span class="id">m</span> <span class="id">l</span>) = <span class="id">substring</span> <span class="id">s</span> (<span class="id">n</span>+<span class="id">m</span>) <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof512')">Proof.</div>
<div class="proofscript" id="proof512">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">n</span> <span class="id">m</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">destruct</span> <span class="id">s</span>; <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">IHl</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">IHl</span>. <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">substring_all</span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">substring</span> 0 (<span class="id">String.length</span> <span class="id">l</span>) <span class="id">l</span> = <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof513')">Proof.</div>
<div class="proofscript" id="proof513">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">substring_bounded</span> <span class="id">s</span> <span class="id">n</span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">substring</span> <span class="id">s</span> <span class="id">n</span> <span class="id">l</span> = <span class="id">substring</span> <span class="id">s</span> (<span class="id">min</span> <span class="id">n</span> (<span class="id">String.length</span> <span class="id">l</span> - <span class="id">s</span>)) <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof514')">Proof.</div>
<div class="proofscript" id="proof514">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">s</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">destruct</span> <span class="id">s</span>; <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">IHl</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_case</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">substring_le_prefix</span> <span class="id">s</span> <span class="id">n</span> <span class="id">m</span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">n</span> &lt;= <span class="id">m</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prefix</span> (<span class="id">substring</span> <span class="id">s</span> <span class="id">n</span> <span class="id">l</span>) (<span class="id">substring</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span>) = <span class="id">true</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof515')">Proof.</div>
<div class="proofscript" id="proof515">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">s</span> <span class="id">n</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">destruct</span> <span class="id">s</span>; <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">destruct</span> <span class="id">m</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">omega</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">substring_prefix</span> <span class="id">n</span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prefix</span> (<span class="id">substring</span> 0 <span class="id">n</span> <span class="id">l</span>) <span class="id">l</span> = <span class="id">true</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof516')">Proof.</div>
<div class="proofscript" id="proof516">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">substring_bounded</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id">substring_all</span> <span class="id">l</span>) <span class="tactic">at</span> 3.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">substring_le_prefix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">String.length</span> <span class="id">l</span> - 0) <span class="kwd">with</span> (<span class="id">String.length</span> <span class="id">l</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">le_min_r</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">in_of_append</span> <span class="id">pre</span> <span class="id">y</span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> (<span class="id">append</span> <span class="id">pre</span> <span class="id">y</span>) <span class="id">l</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">y</span> (<span class="id">map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">substring</span> (<span class="id">String.length</span> <span class="id">pre</span>) (<span class="id">String.length</span> <span class="id">x</span> - <span class="id">String.length</span> <span class="id">pre</span>) <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">filter</span> (<span class="id">prefix</span> <span class="id">pre</span>) <span class="id">l</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof517')">Proof.</div>
<div class="proofscript" id="proof517">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">in_map_iff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exists</span> (<span class="id">append</span> <span class="id">pre</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">string_length_append</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> ((<span class="id">String.length</span> <span class="id">pre</span> + <span class="id">String.length</span> <span class="id">y</span> - <span class="id">String.length</span> <span class="id">pre</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">String.length</span> <span class="id">y</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">substring_append_cancel</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">filter_In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">prefix_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">x</span> [<span class="id">subx</span> <span class="id">inx</span>]]; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">filter_In</span> <span class="kwd">in</span> <span class="id">inx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">inx</span> <span class="kwd">as</span> [<span class="id">inx</span> <span class="id">prex</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">prefix_break</span> <span class="id">prex</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">string_length_append</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> ((<span class="id">String.length</span> <span class="id">pre</span> + <span class="id">String.length</span> <span class="id">x0</span> - <span class="id">String.length</span> <span class="id">pre</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">String.length</span> <span class="id">x0</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">substring_append_cancel</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">fresh_var</span> (<span class="id">pre</span>:<span class="id">string</span>) (<span class="id">dom</span>:<span class="id">list</span> <span class="id">string</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">problems</span>:=<span class="id">filter</span> (<span class="id">prefix</span> <span class="id">pre</span>) <span class="id">dom</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">problemEnds</span>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">substring</span> (<span class="id">String.length</span> <span class="id">pre</span>) (<span class="id">String.length</span> <span class="id">x</span> - <span class="id">String.length</span> <span class="id">pre</span>) <span class="id">x</span>) <span class="id">problems</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">append</span> <span class="id">pre</span> (<span class="id">find_fresh_string</span> <span class="id">problemEnds</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">fresh_var_fresh</span> <span class="id">pre</span> (<span class="id">dom</span>:<span class="id">list</span> <span class="id">string</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id">In</span> (<span class="id">fresh_var</span> <span class="id">pre</span> <span class="id">dom</span>) <span class="id">dom</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof518')">Proof.</div>
<div class="proofscript" id="proof518">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">fresh_var</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">in_of_append</span> <span class="kwd">in</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">find_fresh_string_is_fresh</span> <span class="kwd">in</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">fresh_var_fresh1</span> <span class="id">x1</span> <span class="id">pre</span> <span class="id">dom</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x1</span> &lt;&gt; <span class="id">fresh_var</span> <span class="id">pre</span> (<span class="id">x1</span>::<span class="id">dom</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof519')">Proof.</div>
<div class="proofscript" id="proof519">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">fresh_var_fresh</span> <span class="id">pre</span> (<span class="id">x1</span>::<span class="id">dom</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">fresh_var_fresh2</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">pre</span> <span class="id">dom</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x2</span> &lt;&gt; <span class="id">fresh_var</span> <span class="id">pre</span> (<span class="id">x1</span>::<span class="id">x2</span>::<span class="id">dom</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof520')">Proof.</div>
<div class="proofscript" id="proof520">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">fresh_var_fresh</span> <span class="id">pre</span> (<span class="id">x1</span>::<span class="id">x2</span>::<span class="id">dom</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">fresh_var_fresh3</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> <span class="id">pre</span> <span class="id">dom</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x3</span> &lt;&gt; <span class="id">fresh_var</span> <span class="id">pre</span> (<span class="id">x1</span>::<span class="id">x2</span>::<span class="id">x3</span>::<span class="id">dom</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof521')">Proof.</div>
<div class="proofscript" id="proof521">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">fresh_var_fresh</span> <span class="id">pre</span> (<span class="id">x1</span>::<span class="id">x2</span>::<span class="id">x3</span>::<span class="id">dom</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">fresh_var_fresh4</span> <span class="id">x1</span> <span class="id">x2</span> <span class="id">x3</span> <span class="id">x4</span> <span class="id">pre</span> <span class="id">dom</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x4</span> &lt;&gt; <span class="id">fresh_var</span> <span class="id">pre</span> (<span class="id">x1</span>::<span class="id">x2</span>::<span class="id">x3</span>::<span class="id">x4</span>::<span class="id">dom</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof522')">Proof.</div>
<div class="proofscript" id="proof522">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">fresh_var_fresh</span> <span class="id">pre</span> (<span class="id">x1</span>::<span class="id">x2</span>::<span class="id">x3</span>::<span class="id">x4</span>::<span class="id">dom</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">fresh_var2</span> <span class="id">pre1</span> <span class="id">pre2</span> (<span class="id">dom</span>:<span class="id">list</span> <span class="id">string</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">fresh_var1</span> := <span class="id">fresh_var</span> <span class="id">pre1</span> <span class="id">dom</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fresh_var1</span>, <span class="id">fresh_var</span> <span class="id">pre2</span> (<span class="id">fresh_var1</span>::<span class="id">dom</span>)).<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">fresh_var2_distinct</span> <span class="id">pre1</span> <span class="id">pre2</span> <span class="id">dom</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fst</span> (<span class="id">fresh_var2</span> <span class="id">pre1</span> <span class="id">pre2</span> <span class="id">dom</span>)) &lt;&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">snd</span> (<span class="id">fresh_var2</span> <span class="id">pre1</span> <span class="id">pre2</span> <span class="id">dom</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof523')">Proof.</div>
<div class="proofscript" id="proof523">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">fresh_var2</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">fresh_var_fresh1</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">get_var_base</span> (<span class="id">sep</span>:<span class="id">string</span>) (<span class="id">var</span>:<span class="id">string</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">index</span> 0 (<span class="id">string_reverse</span> <span class="id">sep</span>) (<span class="id">string_reverse</span> <span class="id">var</span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Some</span> <span class="id">n</span> =&gt; <span class="id">substring</span> 0 (<span class="id">String.length</span> <span class="id">var</span> - (<span class="id">S</span> <span class="id">n</span>)) <span class="id">var</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">None</span> =&gt; <span class="id">var</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">get_var_base_pre</span> <span class="id">sep</span> <span class="id">var</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prefix</span> (<span class="id">get_var_base</span> <span class="id">sep</span> <span class="id">var</span>) <span class="id">var</span> = <span class="id">true</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof524')">Proof.</div>
<div class="proofscript" id="proof524">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">get_var_base</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">substring_prefix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">prefix_refl</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">fresh_var_from</span> <span class="id">sep</span> (<span class="id">oldvar</span>:<span class="id">string</span>) (<span class="id">dom</span>:<span class="id">list</span> <span class="id">string</span>) : <span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">if</span> <span class="id">in_dec</span> <span class="id">string_dec</span> <span class="id">oldvar</span> <span class="id">dom</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id">fresh_var</span> (<span class="id">append</span> (<span class="id">get_var_base</span> <span class="id">sep</span> <span class="id">oldvar</span>) <span class="id">sep</span>) <span class="id">dom</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id">oldvar</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">fresh_var_from_fresh</span> <span class="id">sep</span> <span class="id">oldvar</span> (<span class="id">dom</span>:<span class="id">list</span> <span class="id">string</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id">In</span> (<span class="id">fresh_var_from</span> <span class="id">sep</span> <span class="id">oldvar</span> <span class="id">dom</span>) <span class="id">dom</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof525')">Proof.</div>
<div class="proofscript" id="proof525">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">fresh_var_from</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">fresh_var_fresh</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">append_ass</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">s3</span> : ((<span class="id">s1</span> ++ <span class="id">s2</span>) ++ <span class="id">s3</span> = <span class="id">s1</span> ++ <span class="id">s2</span> ++ <span class="id">s3</span>)%<span class="id">string</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof526')">Proof.</div>
<div class="proofscript" id="proof526">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">s2</span> <span class="id">s3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s1</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">IHs1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
<span class="kwd">End</span> <span class="id">RFresh</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">prove_fresh_nin</span><br/>
&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- ~ <span class="id">In</span> (<span class="id">fresh_var</span> ?<span class="id">pre</span> ?<span class="id">l</span>) <span class="id">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve</span>[<span class="tactic">generalize</span> (<span class="id">fresh_var_fresh</span> <span class="id">pre</span> <span class="id">l</span>); <span class="tactic">simpl</span>; <span class="tactic">intuition</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id">In</span> (<span class="id">fresh_var</span> ?<span class="id">pre</span> ?<span class="id">l</span>) <span class="id">_</span> -&gt; <span class="id">False</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve</span>[<span class="tactic">generalize</span> (<span class="id">fresh_var_fresh</span> <span class="id">pre</span> <span class="id">l</span>); <span class="tactic">simpl</span>; <span class="tactic">intuition</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- ~ (<span class="id">fresh_var</span> ?<span class="id">pre</span> ?<span class="id">l</span>) = <span class="id">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve</span>[<span class="tactic">generalize</span> (<span class="id">fresh_var_fresh</span> <span class="id">pre</span> <span class="id">l</span>); <span class="tactic">simpl</span>; <span class="tactic">intuition</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |-  (<span class="id">fresh_var</span> ?<span class="id">pre</span> ?<span class="id">l</span>) &lt;&gt; <span class="id">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve</span>[<span class="tactic">generalize</span> (<span class="id">fresh_var_fresh</span> <span class="id">pre</span> <span class="id">l</span>); <span class="tactic">simpl</span>; <span class="tactic">intuition</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id">H</span>:<span class="id">In</span> (<span class="id">fresh_var</span> ?<span class="id">pre</span> ?<span class="id">l</span>) <span class="id">_</span> |- <span class="id">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve</span>[<span class="tactic">generalize</span> (<span class="id">fresh_var_fresh</span> <span class="id">pre</span> <span class="id">l</span>); <span class="tactic">simpl</span>; <span class="tactic">intuition</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id">H</span>:(<span class="id">fresh_var</span> ?<span class="id">pre</span> ?<span class="id">l</span>) = <span class="id">_</span> |- <span class="id">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">solve</span>[<span class="tactic">generalize</span> (<span class="id">fresh_var_fresh</span> <span class="id">pre</span> <span class="id">l</span>); <span class="tactic">simpl</span>; <span class="tactic">intuition</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
