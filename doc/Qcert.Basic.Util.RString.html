
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Qcert.Basic.Util.RString</title>
<meta name="description" content="Documentation of Coq module Qcert.Basic.Util.RString" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Qcert.Basic.Util.RString</h1>
<div class="coq">
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Orders</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Ascii</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">String</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Equivalence</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">EquivDec</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Compare_dec</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Omega</span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id">AsciiOrder</span> &lt;: <span class="id">OrderedTypeFull</span> <span class="kwd">with</span> <span class="kwd">Definition</span> <span class="id">t</span>:=<span class="id">ascii</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">t</span>:= <span class="id">ascii</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">eq</span> := @<span class="id">eq</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">eq_equiv</span> : (<span class="id">Equivalence</span> <span class="id">eq</span>) := <span class="id">eq_equivalence</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">eq_dec</span> := <span class="id">ascii_dec</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">compare</span> (<span class="id">a</span> <span class="id">b</span>:<span class="id">ascii</span>) : <span class="id">comparison</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nat_compare</span> (<span class="id">nat_of_ascii</span> <span class="id">a</span>) (<span class="id">nat_of_ascii</span> <span class="id">b</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">lt</span> (<span class="id">a</span> <span class="id">b</span>:<span class="id">ascii</span>) := <span class="id">compare</span> <span class="id">a</span> <span class="id">b</span> = <span class="id">Lt</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">lt_strorder</span> : <span class="id">StrictOrder</span> <span class="id">lt</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof314')">Proof.</div>
<div class="proofscript" id="proof314">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">repeat</span> <span class="tactic">red</span>; <span class="tactic">unfold</span> <span class="id">lt</span>, <span class="id">compare</span>; <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>:<span class="id">nat_compare</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">Lt</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">apply</span> <span class="id">nat_compare_lt</span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id">nat_compare</span> <span class="id">_</span> <span class="id">_</span> = <span class="id">Lt</span> ] =&gt; <span class="tactic">apply</span> <span class="id">nat_compare_lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">lt_compat</span> : <span class="id">Proper</span> (<span class="id">eq</span> ==&gt; <span class="id">eq</span> ==&gt; <span class="id">iff</span>) <span class="id">lt</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof315')">Proof.</div>
<div class="proofscript" id="proof315">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Proper</span>, <span class="id">respectful</span>, <span class="id">eq</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">compare_eq_iff</span> <span class="id">a</span> <span class="id">b</span>: <span class="id">compare</span> <span class="id">a</span> <span class="id">b</span> = <span class="id">Eq</span> &lt;-&gt; <span class="id">a</span> = <span class="id">b</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof316')">Proof.</div>
<div class="proofscript" id="proof316">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">AsciiOrder.compare</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">nat_compare_eq_iff</span> (<span class="id">nat_of_ascii</span> <span class="id">a</span>) (<span class="id">nat_of_ascii</span> <span class="id">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> 1; <span class="tactic">split</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">specialize</span> (<span class="id">H</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="tactic">f_equal</span> <span class="id">ascii_of_nat</span>) <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">ascii_nat_embedding</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">compare_spec</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id">t</span>, <span class="id">CompareSpec</span> (<span class="id">eq</span> <span class="id">x</span> <span class="id">y</span>) (<span class="id">lt</span> <span class="id">x</span> <span class="id">y</span>) (<span class="id">lt</span> <span class="id">y</span> <span class="id">x</span>) (<span class="id">compare</span> <span class="id">x</span> <span class="id">y</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof317')">Proof.</div>
<div class="proofscript" id="proof317">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">eq</span>, <span class="id">lt</span>, <span class="id">compare</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">nat_compare_spec</span> (<span class="id">nat_of_ascii</span> <span class="id">x</span>) (<span class="id">nat_of_ascii</span> <span class="id">y</span>)); <span class="tactic">intros</span> <span class="id">nc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">nc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="tactic">f_equal</span> <span class="id">ascii_of_nat</span>) <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">ascii_nat_embedding</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">nat_compare_lt</span>. <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">trichotemy</span> <span class="id">a</span> <span class="id">b</span> : {<span class="id">lt</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">eq</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">lt</span> <span class="id">b</span> <span class="id">a</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof318')">Proof.</div>
<div class="proofscript" id="proof318">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">intros</span> <span class="id">nc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">compare</span> <span class="id">a</span> <span class="id">b</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">left</span>; <span class="id">right</span>|<span class="id">left</span>;<span class="id">left</span>|<span class="id">right</span>]; <span class="tactic">inversion</span> <span class="id">nc</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">le</span> (<span class="id">a</span> <span class="id">b</span>:<span class="id">ascii</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">compare</span> <span class="id">a</span> <span class="id">b</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Lt</span> =&gt; <span class="id">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Eq</span> =&gt; <span class="id">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Gt</span> =&gt; <span class="id">False</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">le_lteq</span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id">t</span>, <span class="id">le</span> <span class="id">x</span> <span class="id">y</span> &lt;-&gt; <span class="id">lt</span> <span class="id">x</span> <span class="id">y</span> \/ <span class="id">eq</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof319')">Proof.</div>
<div class="proofscript" id="proof319">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">x</span> <span class="id">y</span>); <span class="tactic">inversion</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">le</span>, <span class="id">lt</span>, <span class="id">eq</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">compare</span> <span class="id">x</span> <span class="id">y</span>); <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">compare_refl_eq</span> <span class="id">a</span>: <span class="id">compare</span> <span class="id">a</span> <span class="id">a</span> = <span class="id">Eq</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof320')">Proof.</div>
<div class="proofscript" id="proof320">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">AsciiOrder.compare</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">nat_compare_eq_iff</span> (<span class="id">nat_of_ascii</span> <span class="id">a</span>) (<span class="id">nat_of_ascii</span> <span class="id">a</span>)); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">AsciiOrder</span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id">StringOrder</span> &lt;: <span class="id">OrderedTypeFull</span> <span class="kwd">with</span> <span class="kwd">Definition</span> <span class="id">t</span>:=<span class="id">string</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">t</span>:= <span class="id">string</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">eq</span> := @<span class="id">eq</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">eq_equiv</span> : (<span class="id">Equivalence</span> <span class="id">eq</span>) := <span class="id">eq_equivalence</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">eq_dec</span> := <span class="id">string_dec</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id">compare</span> (<span class="id">a</span>:<span class="id">string</span>) (<span class="id">b</span>:<span class="id">string</span>) : <span class="id">comparison</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">a</span>, <span class="id">b</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">EmptyString</span>, <span class="id">EmptyString</span> =&gt; <span class="id">Eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">EmptyString</span>, <span class="id">String</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span> <span class="id">_</span> <span class="id">_</span>, <span class="id">EmptyString</span> =&gt; <span class="id">Gt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span> <span class="id">a</span>' <span class="id">a</span>'<span class="id">s</span>, <span class="id">String</span> <span class="id">b</span>' <span class="id">b</span>'<span class="id">s</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">AsciiOrder.compare</span> <span class="id">a</span>' <span class="id">b</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Lt</span> =&gt; <span class="id">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Eq</span> =&gt; <span class="id">compare</span> <span class="id">a</span>'<span class="id">s</span> <span class="id">b</span>'<span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Gt</span> =&gt; <span class="id">Gt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">lt</span> (<span class="id">a</span> <span class="id">b</span>:<span class="id">string</span>) := <span class="id">compare</span> <span class="id">a</span> <span class="id">b</span> = <span class="id">Lt</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">compare_spec</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id">t</span>, <span class="id">CompareSpec</span> (<span class="id">eq</span> <span class="id">x</span> <span class="id">y</span>) (<span class="id">lt</span> <span class="id">x</span> <span class="id">y</span>) (<span class="id">lt</span> <span class="id">y</span> <span class="id">x</span>) (<span class="id">compare</span> <span class="id">x</span> <span class="id">y</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof321')">Proof.</div>
<div class="proofscript" id="proof321">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">eq</span>, <span class="id">lt</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">x</span>; <span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHx</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">AsciiOrder.compare_spec</span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">AsciiOrder.eq</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">AsciiOrder.compare_refl_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHx</span>; <span class="tactic">simpl</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">AsciiOrder.lt</span> <span class="kwd">in</span> *; <span class="tactic">rewrite</span> <span class="id">l</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">trichotemy</span> <span class="id">a</span> <span class="id">b</span> : {<span class="id">lt</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">eq</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">lt</span> <span class="id">b</span> <span class="id">a</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof322')">Proof.</div>
<div class="proofscript" id="proof322">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">intros</span> <span class="id">nc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">compare</span> <span class="id">a</span> <span class="id">b</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">left</span>; <span class="id">right</span>|<span class="id">left</span>;<span class="id">left</span>|<span class="id">right</span>]; <span class="tactic">inversion</span> <span class="id">nc</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">compare_refl_eq</span> <span class="id">a</span>: <span class="id">compare</span> <span class="id">a</span> <span class="id">a</span> = <span class="id">Eq</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof323')">Proof.</div>
<div class="proofscript" id="proof323">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">a</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">AsciiOrder.compare_refl_eq</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">compare_eq_iff</span> <span class="id">a</span> <span class="id">b</span>: <span class="id">compare</span> <span class="id">a</span> <span class="id">b</span> = <span class="id">Eq</span> &lt;-&gt; <span class="id">a</span> = <span class="id">b</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof324')">Proof.</div>
<div class="proofscript" id="proof324">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [| <span class="tactic">intros</span>; <span class="tactic">subst</span>; <span class="tactic">apply</span> <span class="id">compare_refl_eq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">a</span>; <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">AsciiOrder.compare_eq_iff</span> <span class="id">a</span> <span class="id">a1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">specialize</span> (<span class="id">IHa</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">AsciiOrder.compare</span> <span class="id">a</span> <span class="id">a1</span>); <span class="tactic">intuition</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Instance</span> <span class="id">lt_strorder</span> : <span class="id">StrictOrder</span> <span class="id">lt</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof325')">Proof.</div>
<div class="proofscript" id="proof325">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">repeat</span> <span class="tactic">red</span>; <span class="tactic">unfold</span> <span class="id">lt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">a</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">compare_refl_eq</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">discriminate</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">induction</span> <span class="id">x</span>; <span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">destruct</span> <span class="id">z</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">specialize</span> (<span class="id">IHx</span> <span class="id">y</span> <span class="id">z</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (@<span class="id">StrictOrder_Transitive</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">AsciiOrder.lt_strorder</span>) <span class="id">a</span> <span class="id">a0</span> <span class="id">a1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">AsciiOrder.lt</span>. <span class="tactic">intros</span> <span class="id">AC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">AsciiOrder.compare</span> <span class="id">a</span> <span class="id">a0</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">re</span>; <span class="tactic">rewrite</span> <span class="id">re</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">congruence</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">AsciiOrder.compare</span> <span class="id">a0</span> <span class="id">a1</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">re2</span>; <span class="tactic">rewrite</span> <span class="id">re2</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">congruence</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">AsciiOrder.compare_eq_iff</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">re</span> <span class="kwd">in</span>*; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">re2</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">AC</span> <span class="tactic">by</span> <span class="tactic">trivial</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">AsciiOrder.compare_refl_eq</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">lt_compat</span> : <span class="id">Proper</span> (<span class="id">eq</span> ==&gt; <span class="id">eq</span> ==&gt; <span class="id">iff</span>) <span class="id">lt</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof326')">Proof.</div>
<div class="proofscript" id="proof326">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Proper</span>, <span class="id">respectful</span>, <span class="id">eq</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id">lt_dec</span> (<span class="id">a</span> <span class="id">b</span>:<span class="id">string</span>) : {<span class="id">lt</span> <span class="id">a</span> <span class="id">b</span>} + {~<span class="id">lt</span> <span class="id">a</span> <span class="id">b</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">compare</span> <span class="id">a</span> <span class="id">b</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Lt</span> =&gt; <span class="id">left</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Eq</span> =&gt; <span class="id">right</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Gt</span> =&gt; <span class="id">right</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof327')">Next Obligation.</div>
<div class="proofscript" id="proof327">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">rewrite</span> &lt;- <span class="id">Heq_anonymous</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof328')">Next Obligation.</div>
<div class="proofscript" id="proof328">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">rewrite</span> &lt;- <span class="id">Heq_anonymous</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">apply</span> <span class="id">irreflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof329')">Next Obligation.</div>
<div class="proofscript" id="proof329">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">rewrite</span> &lt;- <span class="id">Heq_anonymous</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">l2</span>. <span class="tactic">apply</span> (<span class="id">asymmetry</span> <span class="id">H0</span> <span class="id">l2</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">le</span> (<span class="id">a</span> <span class="id">b</span>:<span class="id">string</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">compare</span> <span class="id">a</span> <span class="id">b</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Lt</span> =&gt; <span class="id">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Eq</span> =&gt; <span class="id">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Gt</span> =&gt; <span class="id">False</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">le_lteq</span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id">t</span>, <span class="id">le</span> <span class="id">x</span> <span class="id">y</span> &lt;-&gt; <span class="id">lt</span> <span class="id">x</span> <span class="id">y</span> \/ <span class="id">eq</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof330')">Proof.</div>
<div class="proofscript" id="proof330">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">x</span> <span class="id">y</span>); <span class="tactic">inversion</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">le</span>, <span class="id">lt</span>, <span class="id">eq</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">compare</span> <span class="id">x</span> <span class="id">y</span>); <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id">le_dec</span> (<span class="id">a</span> <span class="id">b</span>:<span class="id">string</span>) : {<span class="id">le</span> <span class="id">a</span> <span class="id">b</span>} + {~<span class="id">le</span> <span class="id">a</span> <span class="id">b</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">compare</span> <span class="id">a</span> <span class="id">b</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Lt</span> =&gt; <span class="id">left</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Eq</span> =&gt; <span class="id">left</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Gt</span> =&gt; <span class="id">right</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof331')">Next Obligation.</div>
<div class="proofscript" id="proof331">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">rewrite</span> &lt;- <span class="id">Heq_anonymous</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">le_lteq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof332')">Next Obligation.</div>
<div class="proofscript" id="proof332">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">rewrite</span> &lt;- <span class="id">Heq_anonymous</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">le_lteq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof333')">Next Obligation.</div>
<div class="proofscript" id="proof333">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">rewrite</span> &lt;- <span class="id">Heq_anonymous</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">l2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">le_lteq</span> <span class="kwd">in</span> <span class="id">l2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id">asymmetry</span> <span class="id">H0</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">apply</span> (<span class="id">irreflexivity</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">StringOrder</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">ToString</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id">string_reverse_helper</span> (<span class="id">s</span>:<span class="id">string</span>) (<span class="id">acc</span>:<span class="id">string</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">s</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">EmptyString</span> =&gt; <span class="id">acc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span> <span class="id">x</span> <span class="id">xs</span> =&gt; <span class="id">string_reverse_helper</span> <span class="id">xs</span> (<span class="id">String</span> <span class="id">x</span> <span class="id">acc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">string_reverse</span> (<span class="id">s</span>:<span class="id">string</span>) := <span class="id">string_reverse_helper</span> <span class="id">s</span> <span class="id">EmptyString</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id">string_to_list</span> (<span class="id">s</span>:<span class="id">string</span>) : <span class="id">list</span> <span class="id">ascii</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">s</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">EmptyString</span> =&gt; <span class="id">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span> <span class="id">x</span> <span class="id">xs</span> =&gt; <span class="id">cons</span> <span class="id">x</span> (<span class="id">string_to_list</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id">list_to_string</span> (<span class="id">l</span>:<span class="id">list</span> <span class="id">ascii</span>) : <span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">nil</span> =&gt; <span class="id">EmptyString</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">cons</span> <span class="id">x</span> <span class="id">xs</span> =&gt; <span class="id">String</span> <span class="id">x</span> (<span class="id">list_to_string</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">string_to_list_to_string</span> (<span class="id">s</span>:<span class="id">string</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">list_to_string</span> (<span class="id">string_to_list</span> <span class="id">s</span>) = <span class="id">s</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof334')">Proof.</div>
<div class="proofscript" id="proof334">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>; <span class="tactic">simpl</span>; <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">list_to_string_to_list</span> (<span class="id">l</span>:<span class="id">list</span> <span class="id">ascii</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">string_to_list</span> (<span class="id">list_to_string</span> <span class="id">l</span>) = <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof335')">Proof.</div>
<div class="proofscript" id="proof335">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">string_to_list_inj</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id">string</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">string_to_list</span> <span class="id">x</span> = <span class="id">string_to_list</span> <span class="id">y</span> -&gt; <span class="id">x</span> = <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof336')">Proof.</div>
<div class="proofscript" id="proof336">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="tactic">f_equal</span> <span class="id">list_to_string</span> <span class="id">H</span>); <span class="tactic">intros</span> <span class="id">fe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span>  <span class="id">string_to_list_to_string</span> <span class="kwd">in</span> <span class="id">fe</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">list_to_string_inj</span> (<span class="id">x</span> <span class="id">y</span>:<span class="id">list</span> <span class="id">ascii</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">list_to_string</span> <span class="id">x</span> = <span class="id">list_to_string</span> <span class="id">y</span> -&gt; <span class="id">x</span> = <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof337')">Proof.</div>
<div class="proofscript" id="proof337">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="tactic">f_equal</span> <span class="id">string_to_list</span> <span class="id">H</span>); <span class="tactic">intros</span> <span class="id">fe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span>  <span class="id">list_to_string_to_list</span> <span class="kwd">in</span> <span class="id">fe</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="id">List</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">string_reverse_helper_reverse_append</span> <span class="id">s</span> <span class="id">acc</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">string_reverse_helper</span> <span class="id">s</span> <span class="id">acc</span> = <span class="id">list_to_string</span> (<span class="id">List.rev_append</span> (<span class="id">string_to_list</span> <span class="id">s</span>) (<span class="id">string_to_list</span> <span class="id">acc</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof338')">Proof.</div>
<div class="proofscript" id="proof338">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">acc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">string_to_list_to_string</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">IHs</span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">string_reverse_reverse</span> <span class="id">s</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">string_reverse</span> <span class="id">s</span> = <span class="id">list_to_string</span> (<span class="id">List.rev</span> (<span class="id">string_to_list</span> <span class="id">s</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof339')">Proof.</div>
<div class="proofscript" id="proof339">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">List.rev_alt</span>. <span class="tactic">apply</span> <span class="id">string_reverse_helper_reverse_append</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">string_reverse_involutive</span> <span class="id">x</span> : <span class="id">string_reverse</span> (<span class="id">string_reverse</span> <span class="id">x</span>) = <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof340')">Proof.</div>
<div class="proofscript" id="proof340">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">string_reverse_reverse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">list_to_string_to_list</span>, <span class="id">List.rev_involutive</span>, <span class="id">string_to_list_to_string</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">string_reverse_inj</span> <span class="id">x</span> <span class="id">y</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">string_reverse</span> <span class="id">x</span> = <span class="id">string_reverse</span> <span class="id">y</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span> = <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof341')">Proof.</div>
<div class="proofscript" id="proof341">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">re</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="tactic">f_equal</span> <span class="id">string_reverse</span> <span class="id">re</span>); <span class="tactic">intros</span> <span class="id">fe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">string_reverse_involutive</span> <span class="kwd">in</span> <span class="id">fe</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">lt_contr1</span> <span class="id">s1</span> <span class="id">s2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id">StringOrder.lt</span> <span class="id">s1</span> <span class="id">s2</span> -&gt; ~<span class="id">StringOrder.lt</span> <span class="id">s2</span> <span class="id">s1</span> -&gt; <span class="id">StringOrder.eq</span> <span class="id">s1</span> <span class="id">s2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof342')">Proof.</div>
<div class="proofscript" id="proof342">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">not</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">StringOrder.trichotemy</span> <span class="id">s1</span> <span class="id">s2</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H2</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">lt_contr2</span> <span class="id">s1</span> <span class="id">s2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">StringOrder.lt</span> <span class="id">s1</span> <span class="id">s2</span> -&gt; ~<span class="id">StringOrder.eq</span> <span class="id">s1</span> <span class="id">s2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof343')">Proof.</div>
<div class="proofscript" id="proof343">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">compare</span> <span class="id">s1</span> <span class="id">s2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">e</span> <span class="kwd">in</span> *; <span class="tactic">clear</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">not</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">asymmetry</span> <span class="kwd">with</span> (<span class="id">x</span> := <span class="id">s2</span>) (<span class="id">y</span> := <span class="id">s2</span>); <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">ascii_dec</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">lt_contr3</span> <span class="id">s</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">StringOrder.lt</span> <span class="id">s</span> <span class="id">s</span> -&gt; <span class="id">False</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof344')">Proof.</div>
<div class="proofscript" id="proof344">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">lt_contr2</span> <span class="id">s</span> <span class="id">s</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">not</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">H</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">ToString</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">Prefix</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">substring_zero</span> <span class="id">s</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">substring</span> 0 0 <span class="id">s</span> = ""%<span class="id">string</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof345')">Proof.</div>
<div class="proofscript" id="proof345">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">s</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">substring_S</span> <span class="id">a</span> <span class="id">m</span> <span class="id">s</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">substring</span> 0 (<span class="id">S</span> <span class="id">m</span>) (<span class="id">String</span> <span class="id">a</span> <span class="id">s</span>) = <span class="id">String</span> <span class="id">a</span> (<span class="id">substring</span> 0 <span class="id">m</span> <span class="id">s</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof346')">Proof.</div>
<div class="proofscript" id="proof346">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">append_string_distr</span> <span class="id">a</span> <span class="id">s1</span> <span class="id">s2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">String</span> <span class="id">a</span> <span class="id">s1</span> ++ <span class="id">s2</span> = <span class="id">String</span> <span class="id">a</span> (<span class="id">s1</span> ++ <span class="id">s2</span>))%<span class="id">string</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof347')">Proof.</div>
<div class="proofscript" id="proof347">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
<span class="kwd">End</span> <span class="id">Prefix</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">MapString</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id">map_string</span> (<span class="id">f</span>:<span class="id">ascii</span>-&gt;<span class="id">ascii</span>) (<span class="id">s</span>:<span class="id">string</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">s</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">EmptyString</span> =&gt; <span class="id">EmptyString</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span> <span class="id">a</span> <span class="id">s</span>' =&gt; <span class="id">String</span> (<span class="id">f</span> <span class="id">a</span>) (<span class="id">map_string</span> <span class="id">f</span> <span class="id">s</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id">flat_map_string</span> (<span class="id">f</span>:<span class="id">ascii</span>-&gt;<span class="id">string</span>) (<span class="id">s</span>:<span class="id">string</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">s</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">EmptyString</span> =&gt; <span class="id">EmptyString</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span> <span class="id">a</span> <span class="id">s</span>' =&gt; <span class="id">append</span> (<span class="id">f</span> <span class="id">a</span>) (<span class="id">flat_map_string</span> <span class="id">f</span> <span class="id">s</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id">ascii_dec</span> : <span class="id">EqDec</span> <span class="id">ascii</span> <span class="id">eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id">ascii_dec</span>.<br/>
<span class="kwd">End</span> <span class="id">MapString</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">Like</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">RUtil</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id">like_clause</span> :=<br/>
&nbsp;&nbsp;| <span class="id">like_literal</span> (<span class="id">literal</span>:<span class="id">string</span>) : <span class="id">like_clause</span><br/>
&nbsp;&nbsp;| <span class="id">like_any_char</span> : <span class="id">like_clause</span><br/>
&nbsp;&nbsp;| <span class="id">like_any_string</span> : <span class="id">like_clause</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">List</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id">make_like_clause</span> (<span class="id">s</span>:<span class="id">string</span>) (<span class="id">escape</span>:<span class="id">option</span> <span class="id">ascii</span>) {<span class="kwd">struct</span> <span class="id">s</span>}: <span class="id">list</span> <span class="id">like_clause</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">s</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">EmptyString</span> =&gt; <span class="id">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span> "<span class="id">_</span>"%<span class="id">char</span> <span class="id">tail</span> =&gt; <span class="id">like_any_char</span> :: <span class="id">make_like_clause</span> <span class="id">tail</span> <span class="id">escape</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span> "%"%<span class="id">char</span> <span class="id">tail</span> =&gt; <span class="id">like_any_string</span> :: <span class="id">make_like_clause</span> <span class="id">tail</span> <span class="id">escape</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">other</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fix</span> <span class="id">make_like_literal_clause</span> (<span class="id">ss</span>:<span class="id">string</span>)  (<span class="id">acc</span>:<span class="id">string</span>) {<span class="kwd">struct</span> <span class="id">ss</span>} : <span class="id">list</span> <span class="id">like_clause</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">ss</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">EmptyString</span> =&gt; <span class="id">like_literal</span> (<span class="id">string_reverse</span> <span class="id">acc</span>) :: <span class="id">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span> "<span class="id">_</span>"%<span class="id">char</span> <span class="id">tail</span> =&gt; <span class="id">like_literal</span> (<span class="id">string_reverse</span> <span class="id">acc</span>) :: <span class="id">like_any_char</span> :: <span class="id">make_like_clause</span> <span class="id">tail</span> <span class="id">escape</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span> "%"%<span class="id">char</span> <span class="id">tail</span> =&gt; <span class="id">like_literal</span> (<span class="id">string_reverse</span> <span class="id">acc</span>) :: <span class="id">like_any_string</span> :: <span class="id">make_like_clause</span> <span class="id">tail</span> <span class="id">escape</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span> <span class="id">h</span> <span class="id">tail</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">Some</span> <span class="id">h</span> == <span class="id">escape</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">tail</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">EmptyString</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">like_literal</span> (<span class="id">string_reverse</span> (<span class="id">String</span> <span class="id">h</span> <span class="id">acc</span>)) :: <span class="id">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span> "<span class="id">_</span>"%<span class="id">char</span> <span class="id">tail</span> =&gt; <span class="id">make_like_literal_clause</span> <span class="id">tail</span> (<span class="id">String</span> "<span class="id">_</span>" <span class="id">acc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span> "%"%<span class="id">char</span> <span class="id">tail</span> =&gt; <span class="id">make_like_literal_clause</span> <span class="id">tail</span> (<span class="id">String</span> "%" <span class="id">acc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span> <span class="id">nh</span> <span class="id">ntail</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id">Some</span> <span class="id">nh</span> == <span class="id">escape</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id">make_like_literal_clause</span> <span class="id">ntail</span> (<span class="id">String</span> <span class="id">nh</span> <span class="id">acc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">make_like_literal_clause</span> <span class="id">ntail</span> (<span class="id">String</span> <span class="id">nh</span> (<span class="id">String</span> <span class="id">h</span> <span class="id">acc</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">make_like_literal_clause</span> <span class="id">tail</span> (<span class="id">String</span> <span class="id">h</span> <span class="id">acc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="id">other</span> ""%<span class="id">string</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Example</span> <span class="id">make_like_clause_example1</span> := <span class="id">make_like_clause</span> "<span class="id">hello_there</span>^^^%%" <span class="id">None</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Example</span> <span class="id">make_like_clause_example2</span> := <span class="id">make_like_clause</span> "<span class="id">hello_there</span>^^^%%" (<span class="id">Some</span> "^"%<span class="id">char</span>).<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span>  <span class="id">string_exists_suffix</span> (<span class="id">f</span>:<span class="id">string</span>-&gt;<span class="id">bool</span>) (<span class="id">s</span>:<span class="id">string</span>) : <span class="id">bool</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id">f</span> <span class="id">s</span> ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">s</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">EmptyString</span> =&gt; <span class="id">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span> <span class="id">_</span> <span class="id">tail</span> =&gt; <span class="id">string_exists_suffix</span> <span class="id">f</span> <span class="id">tail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id">like_clause_matches_string</span> (<span class="id">pat</span>:<span class="id">list</span> <span class="id">like_clause</span>) (<span class="id">s</span>:<span class="id">string</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">pat</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">nil</span> =&gt; <span class="id">s</span> ==<span class="id">b</span> <span class="id">EmptyString</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id">like_literal</span> <span class="id">literal</span>)::<span class="id">rest</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">andb</span> (<span class="id">prefix</span> <span class="id">literal</span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">like_clause_matches_string</span> <span class="id">rest</span> (<span class="id">substring</span> (<span class="id">String.length</span> <span class="id">literal</span>) (<span class="id">String.length</span> <span class="id">s</span> - <span class="id">String.length</span> <span class="id">literal</span>) <span class="id">s</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">like_any_char</span>::<span class="id">rest</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">s</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">EmptyString</span> =&gt; <span class="id">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">String</span> <span class="id">_</span> <span class="id">tail</span> =&gt; <span class="id">like_clause_matches_string</span> <span class="id">rest</span> <span class="id">tail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">like_any_string</span>::<span class="id">rest</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">string_exists_suffix</span> (<span class="id">like_clause_matches_string</span> <span class="id">rest</span>) <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">string_like</span> (<span class="id">str</span> <span class="tactic">pattern</span>:<span class="id">string</span>) (<span class="id">escape</span>:<span class="id">option</span> <span class="id">ascii</span>) : <span class="id">bool</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">let</span> <span class="id">pat_clause</span> := <span class="id">make_like_clause</span> <span class="tactic">pattern</span> <span class="id">escape</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">like_clause_matches_string</span> <span class="id">pat_clause</span> <span class="id">str</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Example</span> <span class="id">string_like_example1</span> := <span class="id">string_like</span> "<span class="id">hello</span> <span class="id">there</span>" "<span class="id">hello</span> <span class="id">there</span>" <span class="id">None</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Example</span> <span class="id">string_like_example2</span> := <span class="id">string_like</span> "<span class="id">hello</span> <span class="id">there</span>" "<span class="id">hello</span> %<span class="id">there</span>" <span class="id">None</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Example</span> <span class="id">string_like_example3</span> := <span class="id">string_like</span> "<span class="id">hello</span> <span class="id">there</span>" "<span class="id">he</span>%<span class="id">th_re</span>" <span class="id">None</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Example</span> <span class="id">string_like_example4</span> := <span class="id">string_like</span> "<span class="id">hello</span> <span class="id">there</span> " "<span class="id">he</span>%<span class="id">th_re</span>" <span class="id">None</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Example</span> <span class="id">string_like_example5</span> := <span class="id">string_like</span> "<span class="id">hello</span> <span class="id">thethare</span>" "<span class="id">he</span>%<span class="id">th_re</span>" <span class="id">None</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Example</span> <span class="id">string_like_example6</span> := <span class="id">string_like</span> "<span class="id">hello</span> <span class="id">thetheare</span>" "<span class="id">he</span>%<span class="id">th_re</span>" <span class="id">None</span>.<br/>
<br/>
&nbsp;&nbsp;<br/>
<span class="kwd">End</span> <span class="id">Like</span>.<br/>
<br/>
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
