
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Qcert.Basic.Data.RDataSort</title>
<meta name="description" content="Documentation of Coq module Qcert.Basic.Data.RDataSort" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Qcert.Basic.Data.RDataSort</h1>
<div class="coq">
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Orders</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Equivalence</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">EquivDec</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Compare_dec</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Omega</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">String</span> <span class="id">RString</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">List</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">ZArith</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">SortableData</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id">SortDesc</span> : <span class="kwd">Set</span> := | <span class="id">Descending</span> | <span class="id">Ascending</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">SortCriteria</span> : <span class="kwd">Set</span> := <span class="id">string</span> * <span class="id">SortDesc</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">SortCriterias</span> : <span class="kwd">Set</span> := <span class="id">list</span> <span class="id">SortCriteria</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Inductive</span> <span class="id">sdata</span> :=<br/>
&nbsp;&nbsp;| <span class="id">sdnat</span> : <span class="id">Z</span> -&gt; <span class="id">sdata</span><br/>
&nbsp;&nbsp;| <span class="id">sdstring</span> : <span class="id">string</span> -&gt; <span class="id">sdata</span><br/>
&nbsp;&nbsp;.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">sort_desc_eq_dec</span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>:<span class="id">SortDesc</span>, {<span class="id">x</span>=<span class="id">y</span>}+{<span class="id">x</span>&lt;&gt;<span class="id">y</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof964')">Proof.</div>
<div class="proofscript" id="proof964">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">decide</span> <span class="id">equality</span>.<br/>
&nbsp;&nbsp;Defined.</div>
&nbsp;&nbsp;<br/>
<div class="doc">Equality is decidable for sdata </div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">sdata_eq_dec</span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>:<span class="id">sdata</span>, {<span class="id">x</span>=<span class="id">y</span>}+{<span class="id">x</span>&lt;&gt;<span class="id">y</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof965')">Proof.</div>
<div class="proofscript" id="proof965">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">try</span> <span class="id">solve</span>[<span class="id">right</span>; <span class="tactic">inversion</span> 1].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">Z_eq_dec</span> <span class="id">z</span> <span class="id">z0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>; <span class="tactic">f_equal</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>;<span class="tactic">intro</span>;<span class="tactic">apply</span> <span class="id">n</span>;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">string_dec</span> <span class="id">s</span> <span class="id">s0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>; <span class="tactic">f_equal</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>;<span class="tactic">intro</span>;<span class="tactic">apply</span> <span class="id">n</span>;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id">oql_eqdec</span> : <span class="id">EqDec</span> <span class="id">SortDesc</span> <span class="id">eq</span> := <span class="id">sort_desc_eq_dec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id">sdata_eqdec</span> : <span class="id">EqDec</span> <span class="id">sdata</span> <span class="id">eq</span> := <span class="id">sdata_eq_dec</span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id">SortableData</span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id">SortableDataOrder</span> &lt;: <span class="id">OrderedTypeFull</span> <span class="kwd">with</span> <span class="kwd">Definition</span> <span class="id">t</span>:=<span class="id">sdata</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">t</span>:=<span class="id">sdata</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">eq</span> := @<span class="id">eq</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">eq_equiv</span> : (<span class="id">Equivalence</span> <span class="id">eq</span>) := <span class="id">eq_equivalence</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">eq_dec</span> := <span class="id">sdata_eq_dec</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">compare</span> (<span class="id">d1</span> <span class="id">d2</span>:<span class="id">t</span>) : <span class="id">comparison</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">d1</span>,<span class="id">d2</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">sdnat</span> <span class="id">n</span>, <span class="id">sdstring</span> <span class="id">s</span> =&gt; <span class="id">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">sdstring</span> <span class="id">s</span>, <span class="id">sdnat</span> <span class="id">n</span> =&gt; <span class="id">Gt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">sdnat</span> <span class="id">n1</span>, <span class="id">sdnat</span> <span class="id">n2</span> =&gt; <span class="id">Z.compare</span> <span class="id">n1</span> <span class="id">n2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">sdstring</span> <span class="id">s1</span>, <span class="id">sdstring</span> <span class="id">s2</span> =&gt; <span class="id">StringOrder.compare</span> <span class="id">s1</span> <span class="id">s2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">lt</span> (<span class="id">d1</span> <span class="id">d2</span>:<span class="id">sdata</span>) : <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id">compare</span> <span class="id">d1</span> <span class="id">d2</span> = <span class="id">Lt</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">compare_spec</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id">sdata</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">CompareSpec</span> (<span class="id">eq</span> <span class="id">x</span> <span class="id">y</span>) (<span class="id">lt</span> <span class="id">x</span> <span class="id">y</span>) (<span class="id">lt</span> <span class="id">y</span> <span class="id">x</span>) (<span class="id">compare</span> <span class="id">x</span> <span class="id">y</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof966')">Proof.</div>
<div class="proofscript" id="proof966">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id">eq</span>, <span class="id">lt</span>, <span class="id">compare</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">generalize</span> (<span class="id">Z.compare_spec</span> <span class="id">z</span> <span class="id">z0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">generalize</span> (<span class="id">StringOrder.compare_spec</span> <span class="id">s</span> <span class="id">s0</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">s</span> = <span class="id">s0</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id">StringOrder.compare_eq_iff</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">trichotemy</span> <span class="id">a</span> <span class="id">b</span> : {<span class="id">lt</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">eq</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">lt</span> <span class="id">b</span> <span class="id">a</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof967')">Proof.</div>
<div class="proofscript" id="proof967">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">intros</span> <span class="id">nc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">compare</span> <span class="id">a</span> <span class="id">b</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">left</span>; <span class="id">right</span>|<span class="id">left</span>;<span class="id">left</span>|<span class="id">right</span>]; <span class="tactic">inversion</span> <span class="id">nc</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">compare_refl_eq</span> <span class="id">a</span>: <span class="id">compare</span> <span class="id">a</span> <span class="id">a</span> = <span class="id">Eq</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof968')">Proof.</div>
<div class="proofscript" id="proof968">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Zcompare_refl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">StringOrder.compare_refl_eq</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">compare_eq_iff</span> <span class="id">a</span> <span class="id">b</span>: <span class="id">compare</span> <span class="id">a</span> <span class="id">b</span> = <span class="id">Eq</span> &lt;-&gt; <span class="id">a</span> = <span class="id">b</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof969')">Proof.</div>
<div class="proofscript" id="proof969">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [| <span class="tactic">intros</span>; <span class="tactic">subst</span>; <span class="tactic">apply</span> <span class="id">compare_refl_eq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">Z.compare_eq_iff</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">StringOrder.compare_eq_iff</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">subst</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Instance</span> <span class="id">lt_strorder</span> : <span class="id">StrictOrder</span> <span class="id">lt</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof970')">Proof.</div>
<div class="proofscript" id="proof970">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">repeat</span> <span class="tactic">red</span>; <span class="tactic">unfold</span> <span class="id">lt</span>, <span class="id">compare</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id">z</span> ?= <span class="id">z</span>)%<span class="id">Z</span> = <span class="id">Eq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Z.compare_eq_iff</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">StringOrder.compare</span> <span class="id">s</span> <span class="id">s</span> = <span class="id">Eq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">StringOrder.compare_eq_iff</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">destruct</span> <span class="id">z</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> (<span class="id">Zlt_trans</span> <span class="id">z0</span> <span class="id">z1</span> <span class="id">z</span> <span class="id">H</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">generalize</span> (@<span class="id">StrictOrder_Transitive</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">StringOrder.lt_strorder</span>) <span class="id">s</span> <span class="id">s0</span> <span class="id">s1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">StringOrder.lt</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">lt_compat</span> : <span class="id">Proper</span> (<span class="id">eq</span> ==&gt; <span class="id">eq</span> ==&gt; <span class="id">iff</span>) <span class="id">lt</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof971')">Proof.</div>
<div class="proofscript" id="proof971">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Proper</span>, <span class="id">respectful</span>, <span class="id">eq</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id">lt_dec</span> (<span class="id">a</span> <span class="id">b</span>:<span class="id">sdata</span>) : {<span class="id">lt</span> <span class="id">a</span> <span class="id">b</span>} + {~<span class="id">lt</span> <span class="id">a</span> <span class="id">b</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">compare</span> <span class="id">a</span> <span class="id">b</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Lt</span> =&gt; <span class="id">left</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Eq</span> =&gt; <span class="id">right</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Gt</span> =&gt; <span class="id">right</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof972')">Next Obligation.</div>
<div class="proofscript" id="proof972">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">rewrite</span> &lt;- <span class="id">Heq_anonymous</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof973')">Next Obligation.</div>
<div class="proofscript" id="proof973">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">rewrite</span> &lt;- <span class="id">Heq_anonymous</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">apply</span> <span class="id">irreflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof974')">Next Obligation.</div>
<div class="proofscript" id="proof974">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">rewrite</span> &lt;- <span class="id">Heq_anonymous</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">l2</span>. <span class="tactic">apply</span> (<span class="id">asymmetry</span> <span class="id">H0</span> <span class="id">l2</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">le</span> (<span class="id">a</span> <span class="id">b</span>:<span class="id">sdata</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">compare</span> <span class="id">a</span> <span class="id">b</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Lt</span> =&gt; <span class="id">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Eq</span> =&gt; <span class="id">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Gt</span> =&gt; <span class="id">False</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">le_lteq</span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id">t</span>, <span class="id">le</span> <span class="id">x</span> <span class="id">y</span> &lt;-&gt; <span class="id">lt</span> <span class="id">x</span> <span class="id">y</span> \/ <span class="id">eq</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof975')">Proof.</div>
<div class="proofscript" id="proof975">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">x</span> <span class="id">y</span>); <span class="tactic">inversion</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">le</span>, <span class="id">lt</span>, <span class="id">eq</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">compare</span> <span class="id">x</span> <span class="id">y</span>); <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id">le_dec</span> (<span class="id">a</span> <span class="id">b</span>:<span class="id">sdata</span>) : {<span class="id">le</span> <span class="id">a</span> <span class="id">b</span>} + {~<span class="id">le</span> <span class="id">a</span> <span class="id">b</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">compare</span> <span class="id">a</span> <span class="id">b</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Lt</span> =&gt; <span class="id">left</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Eq</span> =&gt; <span class="id">left</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Gt</span> =&gt; <span class="id">right</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof976')">Next Obligation.</div>
<div class="proofscript" id="proof976">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">rewrite</span> &lt;- <span class="id">Heq_anonymous</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">le_lteq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof977')">Next Obligation.</div>
<div class="proofscript" id="proof977">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">rewrite</span> &lt;- <span class="id">Heq_anonymous</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">le_lteq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof978')">Next Obligation.</div>
<div class="proofscript" id="proof978">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">rewrite</span> &lt;- <span class="id">Heq_anonymous</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">l2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">le_lteq</span> <span class="kwd">in</span> <span class="id">l2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id">asymmetry</span> <span class="id">H0</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">apply</span> (<span class="id">irreflexivity</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">SortableDataOrder</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">LexicographicData</span>.<br/>
<div class="doc">Equality is decidable for lists of sortable data </div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">list_sdata_eq_dec</span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>:<span class="id">list</span> <span class="id">sdata</span>, {<span class="id">x</span>=<span class="id">y</span>}+{<span class="id">x</span>&lt;&gt;<span class="id">y</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof979')">Proof.</div>
<div class="proofscript" id="proof979">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">x</span>; <span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">try</span> <span class="id">solve</span>[<span class="id">right</span>; <span class="tactic">inversion</span> 1].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">sdata_eq_dec</span> <span class="id">a</span> <span class="id">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">IHx</span> <span class="id">y</span>); <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">inversion</span> 1; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>; <span class="tactic">inversion</span> 1; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id">list_sdata_eqdec</span> : <span class="id">EqDec</span> (<span class="id">list</span> <span class="id">sdata</span>) <span class="id">eq</span> := <span class="id">list_sdata_eq_dec</span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id">LexicographicData</span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id">LexicographicDataOrder</span> &lt;: <span class="id">OrderedTypeFull</span> <span class="kwd">with</span> <span class="kwd">Definition</span> <span class="id">t</span>:=<span class="id">list</span> <span class="id">sdata</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">t</span> := <span class="id">list</span> <span class="id">sdata</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">eq</span> := @<span class="id">eq</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">eq_equiv</span> : (<span class="id">Equivalence</span> <span class="id">eq</span>) := <span class="id">eq_equivalence</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">eq_dec</span> := <span class="id">list_sdata_eq_dec</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id">compare</span> (<span class="id">l1</span> <span class="id">l2</span>:<span class="id">list</span> <span class="id">sdata</span>) : <span class="id">comparison</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">l1</span>, <span class="id">l2</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">nil</span>, <span class="id">nil</span> =&gt; <span class="id">Eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">nil</span>, <span class="id">_</span> :: <span class="id">_</span> =&gt; <span class="id">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> :: <span class="id">_</span>, <span class="id">nil</span> =&gt; <span class="id">Gt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">d1</span> :: <span class="id">l1</span>', <span class="id">d2</span> :: <span class="id">l2</span>' =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">SortableDataOrder.compare</span> <span class="id">d1</span> <span class="id">d2</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Lt</span> =&gt; <span class="id">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Eq</span> =&gt; <span class="id">compare</span> <span class="id">l1</span>' <span class="id">l2</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Gt</span> =&gt; <span class="id">Gt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">lt</span> (<span class="id">l1</span> <span class="id">l2</span>:<span class="id">t</span>) : <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id">compare</span> <span class="id">l1</span> <span class="id">l2</span> = <span class="id">Lt</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">compare_spec</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id">t</span>, <span class="id">CompareSpec</span> (<span class="id">eq</span> <span class="id">x</span> <span class="id">y</span>) (<span class="id">lt</span> <span class="id">x</span> <span class="id">y</span>) (<span class="id">lt</span> <span class="id">y</span> <span class="id">x</span>) (<span class="id">compare</span> <span class="id">x</span> <span class="id">y</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof980')">Proof.</div>
<div class="proofscript" id="proof980">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">eq</span>, <span class="id">lt</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">x</span>; <span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHx</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">SortableDataOrder.compare_spec</span> <span class="id">a</span> <span class="id">s</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">SortableDataOrder.eq</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">IHx</span>; <span class="tactic">simpl</span>; <span class="tactic">subst</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">SortableDataOrder.compare_refl_eq</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">SortableDataOrder.lt</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">l</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">trichotemy</span> <span class="id">a</span> <span class="id">b</span> : {<span class="id">lt</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">eq</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">lt</span> <span class="id">b</span> <span class="id">a</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof981')">Proof.</div>
<div class="proofscript" id="proof981">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">intros</span> <span class="id">nc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">compare</span> <span class="id">a</span> <span class="id">b</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">left</span>; <span class="id">right</span>|<span class="id">left</span>;<span class="id">left</span>|<span class="id">right</span>]; <span class="tactic">inversion</span> <span class="id">nc</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">compare_refl_eq</span> <span class="id">a</span>: <span class="id">compare</span> <span class="id">a</span> <span class="id">a</span> = <span class="id">Eq</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof982')">Proof.</div>
<div class="proofscript" id="proof982">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">a</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">SortableDataOrder.compare_refl_eq</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">compare_eq_iff</span> <span class="id">a</span> <span class="id">b</span>: <span class="id">compare</span> <span class="id">a</span> <span class="id">b</span> = <span class="id">Eq</span> &lt;-&gt; <span class="id">a</span> = <span class="id">b</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof983')">Proof.</div>
<div class="proofscript" id="proof983">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [| <span class="tactic">intros</span>; <span class="tactic">subst</span>; <span class="tactic">apply</span> <span class="id">compare_refl_eq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">a</span>; <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">SortableDataOrder.compare_eq_iff</span> <span class="id">a</span> <span class="id">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">specialize</span> (<span class="id">IHa</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">SortableDataOrder.compare</span> <span class="id">a</span> <span class="id">s</span>); <span class="tactic">intuition</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Instance</span> <span class="id">lt_strorder</span> : <span class="id">StrictOrder</span> <span class="id">lt</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof984')">Proof.</div>
<div class="proofscript" id="proof984">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">repeat</span> <span class="tactic">red</span>; <span class="tactic">unfold</span> <span class="id">lt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">a</span> <span class="id">H</span>; <span class="tactic">rewrite</span> <span class="id">compare_refl_eq</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">discriminate</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">induction</span> <span class="id">x</span>; <span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">destruct</span> <span class="id">z</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">specialize</span> (<span class="id">IHx</span> <span class="id">y</span> <span class="id">z</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (@<span class="id">StrictOrder_Transitive</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">SortableDataOrder.lt_strorder</span>) <span class="id">a</span> <span class="id">s</span> <span class="id">s0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">SortableDataOrder.lt</span>. <span class="tactic">intros</span> <span class="id">AC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">SortableDataOrder.compare</span> <span class="id">a</span> <span class="id">s</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">re</span>; <span class="tactic">rewrite</span> <span class="id">re</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">congruence</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">SortableDataOrder.compare</span> <span class="id">s</span> <span class="id">s0</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">re2</span>; <span class="tactic">rewrite</span> <span class="id">re2</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">congruence</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">SortableDataOrder.compare_eq_iff</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">re</span> <span class="kwd">in</span>*; <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">re2</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">AC</span> <span class="tactic">by</span> <span class="tactic">trivial</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id">SortableDataOrder.compare_refl_eq</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">lt_compat</span> : <span class="id">Proper</span> (<span class="id">eq</span> ==&gt; <span class="id">eq</span> ==&gt; <span class="id">iff</span>) <span class="id">lt</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof985')">Proof.</div>
<div class="proofscript" id="proof985">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">Proper</span>, <span class="id">respectful</span>, <span class="id">eq</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id">lt_dec</span> (<span class="id">a</span> <span class="id">b</span>:<span class="id">list</span> <span class="id">sdata</span>) : {<span class="id">lt</span> <span class="id">a</span> <span class="id">b</span>} + {~<span class="id">lt</span> <span class="id">a</span> <span class="id">b</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">compare</span> <span class="id">a</span> <span class="id">b</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Lt</span> =&gt; <span class="id">left</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Eq</span> =&gt; <span class="id">right</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Gt</span> =&gt; <span class="id">right</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof986')">Next Obligation.</div>
<div class="proofscript" id="proof986">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">rewrite</span> &lt;- <span class="id">Heq_anonymous</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof987')">Next Obligation.</div>
<div class="proofscript" id="proof987">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">rewrite</span> &lt;- <span class="id">Heq_anonymous</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>.  <span class="tactic">apply</span> <span class="id">irreflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof988')">Next Obligation.</div>
<div class="proofscript" id="proof988">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">rewrite</span> &lt;- <span class="id">Heq_anonymous</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">l2</span>. <span class="tactic">apply</span> (<span class="id">asymmetry</span> <span class="id">H0</span> <span class="id">l2</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">le</span> (<span class="id">a</span> <span class="id">b</span>:<span class="id">t</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">compare</span> <span class="id">a</span> <span class="id">b</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Lt</span> =&gt; <span class="id">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Eq</span> =&gt; <span class="id">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Gt</span> =&gt; <span class="id">False</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">le_lteq</span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id">t</span>, <span class="id">le</span> <span class="id">x</span> <span class="id">y</span> &lt;-&gt; <span class="id">lt</span> <span class="id">x</span> <span class="id">y</span> \/ <span class="id">eq</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof989')">Proof.</div>
<div class="proofscript" id="proof989">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">x</span> <span class="id">y</span>); <span class="tactic">inversion</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">le</span>, <span class="id">lt</span>, <span class="id">eq</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">compare</span> <span class="id">x</span> <span class="id">y</span>); <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id">le_dec</span> (<span class="id">a</span> <span class="id">b</span>:<span class="id">t</span>) : {<span class="id">le</span> <span class="id">a</span> <span class="id">b</span>} + {~<span class="id">le</span> <span class="id">a</span> <span class="id">b</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">compare</span> <span class="id">a</span> <span class="id">b</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Lt</span> =&gt; <span class="id">left</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Eq</span> =&gt; <span class="id">left</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Gt</span> =&gt; <span class="id">right</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof990')">Next Obligation.</div>
<div class="proofscript" id="proof990">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">rewrite</span> &lt;- <span class="id">Heq_anonymous</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">le_lteq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof991')">Next Obligation.</div>
<div class="proofscript" id="proof991">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">rewrite</span> &lt;- <span class="id">Heq_anonymous</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">le_lteq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof992')">Next Obligation.</div>
<div class="proofscript" id="proof992">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">compare_spec</span> <span class="id">a</span> <span class="id">b</span>); <span class="tactic">rewrite</span> &lt;- <span class="id">Heq_anonymous</span>; <span class="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">l2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">le_lteq</span> <span class="kwd">in</span> <span class="id">l2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id">asymmetry</span> <span class="id">H0</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">apply</span> (<span class="id">irreflexivity</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">LexicographicDataOrder</span>.<br/>
&nbsp;&nbsp;<br/>
<span class="kwd">Section</span> <span class="id">DataSort</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">RSort</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">RData</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">RBindings</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id">ODT_lexdata</span> : (@<span class="id">ODT</span> (<span class="id">list</span> <span class="id">sdata</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id">mkODT</span> <span class="id">_</span> <span class="id">_</span> <span class="id">LexicographicDataOrder.lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">LexicographicDataOrder.lt_strorder</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">LexicographicDataOrder.lt_dec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">LexicographicDataOrder.compare</span> <span class="id">_</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof993')">Next Obligation.</div>
<div class="proofscript" id="proof993">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">LexicographicDataOrder.compare_spec</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">RRelation</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">ForeignData</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">fdata</span>:<span class="id">foreign_data</span>}.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">theotherdot</span> <span class="id">d</span> <span class="id">s</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">d</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">drec</span> <span class="id">r</span> =&gt; <span class="id">edot</span> <span class="id">r</span> <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<br/>
<div class="doc">Can be sorted:
      - Empty collection
      - Collection of integers
      - Collection of strings
   </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">RLift</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">RSort</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">sortable_data</span> : <span class="kwd">Set</span> := (<span class="id">list</span> <span class="id">sdata</span>) * <span class="id">data</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">sortable_coll</span> : <span class="kwd">Set</span> := <span class="id">list</span> <span class="id">sortable_data</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">dict_field_le</span> {<span class="id">A</span>} (<span class="id">a</span> <span class="id">b</span>:(<span class="id">list</span> <span class="id">sdata</span>)*<span class="id">A</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">LexicographicDataOrder.le</span> (<span class="id">fst</span> <span class="id">a</span>) (<span class="id">fst</span> <span class="id">b</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">dict_field_le_dec</span> {<span class="id">A</span>} (<span class="id">a</span> <span class="id">b</span>:(<span class="id">list</span> <span class="id">sdata</span>)*<span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">dict_field_le</span> <span class="id">a</span> <span class="id">b</span>} + {~<span class="id">dict_field_le</span> <span class="id">a</span> <span class="id">b</span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof994')">Proof.</div>
<div class="proofscript" id="proof994">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">dict_field_le</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">LexicographicDataOrder.le_dec</span>.<br/>
&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">dict_sort</span> {<span class="id">A</span>} :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id">insertion_sort</span> ((<span class="id">list</span> <span class="id">sdata</span>)*<span class="id">A</span>) <span class="id">dict_field_le</span> <span class="id">dict_field_le_dec</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">sort_sortable_coll</span> (<span class="id">sc</span>:<span class="id">sortable_coll</span>) : <span class="id">sortable_coll</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dict_sort</span> <span class="id">sc</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">coll_of_sortable_coll</span> (<span class="id">sc</span>:<span class="id">sortable_coll</span>) : <span class="id">list</span> <span class="id">data</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span> <span class="id">snd</span> <span class="id">sc</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Example</span> <span class="id">scoll1</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">sdnat</span> 2::<span class="id">sdstring</span> "<span class="id">a</span>"::<span class="id">nil</span>,<span class="id">dnat</span> 10)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: (<span class="id">sdnat</span> 3::<span class="id">sdstring</span> "<span class="id">x</span>"::<span class="id">nil</span>,<span class="id">dnat</span> 11)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: (<span class="id">sdnat</span> 2::<span class="id">sdstring</span> "<span class="id">b</span>"::<span class="id">nil</span>,<span class="id">dnat</span> 12)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: (<span class="id">sdnat</span> 2::<span class="id">sdstring</span> "<span class="id">b</span>"::<span class="id">nil</span>,<span class="id">dnat</span> 2000)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: (<span class="id">sdnat</span> 1::<span class="id">sdstring</span> "<span class="id">a</span>"::<span class="id">nil</span>,<span class="id">dnat</span> 13)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::<span class="id">nil</span>).<br/>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">get_criteria</span> (<span class="id">d</span>:<span class="id">data</span>) (<span class="id">sc</span>:<span class="id">SortCriteria</span>) : <span class="id">option</span> <span class="id">sdata</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">att</span>,<span class="id">sk</span>) := <span class="id">sc</span> <span class="kwd">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">theotherdot</span> <span class="id">d</span> <span class="id">att</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Some</span> (<span class="id">dnat</span> <span class="id">n</span>) =&gt; <span class="id">Some</span> (<span class="id">sdnat</span> <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Some</span> (<span class="id">dstring</span> <span class="id">s</span>) =&gt; <span class="id">Some</span> (<span class="id">sdstring</span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">Some</span> <span class="id">_</span> =&gt; <span class="id">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">None</span> =&gt; <span class="id">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">get_criterias</span> (<span class="id">d</span>:<span class="id">data</span>) (<span class="id">scl</span>:<span class="id">SortCriterias</span>) : <span class="id">option</span> (<span class="id">list</span> <span class="id">sdata</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lift_map</span> (<span class="id">get_criteria</span> <span class="id">d</span>) <span class="id">scl</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">sortable_data_of_data</span> (<span class="id">d</span>:<span class="id">data</span>) (<span class="id">scl</span>:<span class="id">SortCriterias</span>) : <span class="id">option</span> <span class="id">sortable_data</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lift</span> (<span class="kwd">fun</span> <span class="id">c</span> =&gt; (<span class="id">c</span>,<span class="id">d</span>)) (<span class="id">get_criterias</span> <span class="id">d</span> <span class="id">scl</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">sortable_coll_of_coll</span> (<span class="id">scl</span>:<span class="id">SortCriterias</span>) (<span class="id">coll</span>:<span class="id">list</span> <span class="id">data</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">option</span> (<span class="id">list</span> <span class="id">sortable_data</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id">lift_map</span> (<span class="kwd">fun</span> <span class="id">d</span> =&gt; <span class="id">sortable_data_of_data</span> <span class="id">d</span> <span class="id">scl</span>) <span class="id">coll</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">data_sort</span> (<span class="id">scl</span>:<span class="id">SortCriterias</span>) (<span class="id">d</span>:<span class="id">data</span>) : <span class="id">option</span> <span class="id">data</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">d</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">dcoll</span> <span class="id">coll</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lift</span> <span class="id">dcoll</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">lift</span> <span class="id">coll_of_sortable_coll</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">lift</span> <span class="id">sort_sortable_coll</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sortable_coll_of_coll</span> <span class="id">scl</span> <span class="id">coll</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">mkperson</span> (<span class="id">name</span>:<span class="id">string</span>) (<span class="id">age</span>:<span class="id">Z</span>) (<span class="id">zip</span>:<span class="id">Z</span>) (<span class="id">company</span>:<span class="id">string</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">drec</span> (("<span class="id">name</span>", <span class="id">dstring</span> <span class="id">name</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: ("<span class="id">age</span>", <span class="id">dnat</span> <span class="id">age</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: ("<span class="id">zip</span>", <span class="id">dnat</span> <span class="id">zip</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: ("<span class="id">company</span>", <span class="id">dstring</span> <span class="id">company</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id">nil</span>)%<span class="id">string</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">mkpersons_aux</span> <span class="id">l</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span> (<span class="id">name</span>, <span class="id">age</span>, <span class="id">zip</span>, <span class="id">company</span>) =&gt; <span class="id">mkperson</span> <span class="id">name</span> <span class="id">age</span> <span class="id">zip</span> <span class="id">company</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>) <span class="id">l</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">mkpersons</span> <span class="id">l</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">dcoll</span> (<span class="id">mkpersons_aux</span> <span class="id">l</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">Z_scope</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">persons</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mkpersons</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(("<span class="id">John</span>",23,1008,"<span class="id">IBM</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: ("<span class="id">Jane</span>",24,1009,"<span class="id">AIG</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: ("<span class="id">Jill</span>",25,1010,"<span class="id">IBM</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: ("<span class="id">Jack</span>",27,1010,"<span class="id">CMU</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id">nil</span>)%<span class="id">string</span>.<br/>
<br/>
<br/>
<span class="kwd">End</span> <span class="id">DataSort</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">DataSortProps</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">RDataNorm</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">ForeignData</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Utils</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">fdata</span>:<span class="id">foreign_data</span>}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">dict_field_le_anti</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id">sortable_data</span>, ~ <span class="id">dict_field_le</span> <span class="id">x</span> <span class="id">y</span> -&gt; ~ <span class="id">dict_field_le</span> <span class="id">y</span> <span class="id">x</span> -&gt; <span class="id">x</span> = <span class="id">y</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof995')">Proof.</div>
<div class="proofscript" id="proof995">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">dict_field_le</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">LexicographicDataOrder.le_lteq</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">LexicographicDataOrder.compare_spec</span> (<span class="id">fst</span> <span class="id">x</span>) (<span class="id">fst</span> <span class="id">y</span>)); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">in_sort_sortable</span> <span class="id">d</span> <span class="id">l</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">d</span> (<span class="id">sort_sortable_coll</span> <span class="id">l</span>) &lt;-&gt; <span class="id">In</span> <span class="id">d</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof996')">Proof.</div>
<div class="proofscript" id="proof996">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sort_sortable_coll</span>, <span class="id">dict_sort</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">ind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">in_insertion_sort</span> <span class="kwd">in</span> <span class="id">ind</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">insertion_sort_in</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">dict_field_le_anti</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">in_csc_ssc</span> <span class="id">d</span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">d</span> (<span class="id">coll_of_sortable_coll</span> (<span class="id">sort_sortable_coll</span> <span class="id">l</span>)) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">d</span> (<span class="id">coll_of_sortable_coll</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof997')">Proof.</div>
<div class="proofscript" id="proof997">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">coll_of_sortable_coll</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">in_map_iff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span> [[??] [??]]; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">in_sort_sortable</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>; <span class="tactic">split</span>; <span class="tactic">try</span> <span class="id">eassumption</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exists</span> (<span class="id">l0</span>, <span class="id">d</span>); <span class="tactic">split</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">in_sort_sortable</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">in_csc_cons</span> <span class="id">d</span> <span class="id">s</span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">d</span> (<span class="id">coll_of_sortable_coll</span> (<span class="id">s</span> :: <span class="id">l</span>)) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">d</span> = <span class="id">snd</span> <span class="id">s</span> \/ <span class="id">In</span> <span class="id">d</span> (<span class="id">coll_of_sortable_coll</span> <span class="id">l</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof998')">Proof.</div>
<div class="proofscript" id="proof998">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">coll_of_sortable_coll</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">in_map_iff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">ind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">ind</span> <span class="kwd">as</span> [[? ?] [? <span class="id">ind</span>]]; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">ind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">invcs</span> <span class="id">H</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">l1</span>, <span class="id">d</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">ind</span> <span class="kwd">as</span> [| [[??] [??]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">l0</span>, <span class="id">d0</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">l1</span>, <span class="id">d</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">sortable_data_normalized</span> <span class="id">h</span> <span class="id">a</span> <span class="id">sc</span> <span class="id">sd</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">data_normalized</span> <span class="id">h</span> <span class="id">a</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sortable_data_of_data</span> <span class="id">a</span> <span class="id">sc</span> = <span class="id">Some</span> <span class="id">sd</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">data_normalized</span> <span class="id">h</span> (<span class="id">snd</span> <span class="id">sd</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof999')">Proof.</div>
<div class="proofscript" id="proof999">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sortable_data_of_data</span>; <span class="tactic">intros</span> <span class="id">dn</span> <span class="id">eqs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">some_lift</span> <span class="kwd">in</span> <span class="id">eqs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">eqs</span> <span class="kwd">as</span> [? <span class="id">eqs</span> ?]; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">data_sort_normalized</span> <span class="id">h</span> <span class="id">s</span> (<span class="id">d</span> <span class="id">sd</span>:<span class="id">data</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">data_sort</span> <span class="id">s</span> <span class="id">d</span> = <span class="id">Some</span> <span class="id">sd</span> -&gt; <span class="id">data_normalized</span> <span class="id">h</span> <span class="id">d</span> -&gt; <span class="id">data_normalized</span> <span class="id">h</span> <span class="id">sd</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1000')">Proof.</div>
<div class="proofscript" id="proof1000">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">d</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">eqs</span>; <span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">inversion</span> <span class="id">eqs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">some_lift</span> <span class="kwd">in</span> <span class="id">eqs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">eqs</span> <span class="kwd">as</span> [? <span class="id">eqs</span> ? ]; <span class="tactic">subst</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">dn</span>; <span class="id">invcs</span> <span class="id">dn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Forall_forall</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">x</span> <span class="id">eqs</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">x</span> <span class="id">eqs</span> <span class="id">dn</span> <span class="id">d</span> <span class="id">ind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">sortable_coll_of_coll</span> <span class="kwd">in</span> <span class="id">eqs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">eqs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">sortable_coll_of_coll</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">eqs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">sortable_data_of_data</span> <span class="id">a</span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> ? <span class="id">eqq1</span> | <span class="tactic">intros</span> <span class="id">eqq1</span>]; <span class="tactic">rewrite</span> <span class="id">eqq1</span> <span class="kwd">in</span> <span class="id">eqs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">lift_map</span> (<span class="kwd">fun</span> <span class="id">d</span> : <span class="id">data</span> =&gt; <span class="id">sortable_data_of_data</span> <span class="id">d</span> <span class="id">s</span>) <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">intros</span> ? <span class="id">eqq2</span> | <span class="tactic">intros</span> <span class="id">eqq2</span>]; <span class="tactic">rewrite</span> <span class="id">eqq2</span> <span class="kwd">in</span> <span class="id">eqs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invcs</span> <span class="id">eqs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">dnimpl</span>:(<span class="kwd">forall</span> <span class="id">x</span> : <span class="id">data</span>, <span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt; <span class="id">data_normalized</span> <span class="id">h</span> <span class="id">x</span>)) <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">_</span> <span class="id">eqq2</span> <span class="id">dnimpl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">in_csc_ssc</span> <span class="kwd">in</span> <span class="id">ind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">ind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">sortable_data_normalized</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;- <span class="id">in_csc_ssc</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">DataSortProps</span>.<br/>
<br/>
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
