
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Qcert.Basic.Util.RSort</title>
<meta name="description" content="Documentation of Coq module Qcert.Basic.Util.RSort" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Qcert.Basic.Util.RSort</h1>
<div class="coq">
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">RUtil</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id">Sorting</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">EquivDec</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">RSort</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">List</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">RList</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id">Strongly</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">A</span>:<span class="kwd">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">R</span>:<span class="id">A</span>-&gt;<span class="id">A</span>-&gt;<span class="kwd">Prop</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> (<span class="id">R_dec</span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">a</span>', {<span class="id">R</span> <span class="id">a</span> <span class="id">a</span>'} + {~<span class="id">R</span> <span class="id">a</span> <span class="id">a</span>'}).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id">insertion_sort_insert</span> <span class="id">a</span> <span class="id">l</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">nil</span> =&gt; <span class="id">a</span> :: <span class="id">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">b</span>::<span class="id">xs</span> =&gt; <span class="kwd">if</span> (<span class="id">R_dec</span> <span class="id">a</span> <span class="id">b</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id">a</span>::<span class="id">b</span>::<span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="kwd">if</span> (<span class="id">R_dec</span> <span class="id">b</span> <span class="id">a</span>) <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">b</span>::<span class="id">insertion_sort_insert</span> <span class="id">a</span> <span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id">b</span>::<span class="id">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id">insertion_sort</span> (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">nil</span> =&gt; <span class="id">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">a</span>::<span class="id">xs</span> =&gt; <span class="id">insertion_sort_insert</span> <span class="id">a</span> (<span class="id">insertion_sort</span> <span class="id">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">insertion_sort_insert_Sorted</span> <span class="id">a</span> (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Sorted</span> <span class="id">R</span> <span class="id">l</span> -&gt; <span class="id">Sorted</span> <span class="id">R</span> (<span class="id">insertion_sort_insert</span> <span class="id">a</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof277')">Proof.</div>
<div class="proofscript" id="proof277">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Constructors</span> <span class="id">LocallySorted</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Sorted_LocallySorted_iff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">inversion</span> 1; <span class="tactic">subst</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id">context</span> [<span class="id">R_dec</span> ?<span class="id">x</span> ?<span class="id">y</span>]] =&gt; <span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">x</span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">insertion_sort_Sorted</span> (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) : <span class="id">Sorted</span> <span class="id">R</span> (<span class="id">insertion_sort</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof278')">Proof.</div>
<div class="proofscript" id="proof278">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">insertion_sort_insert_Sorted</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Permutation</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id">is_list_sorted</span> (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">l</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">nil</span> =&gt; <span class="id">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">x</span>::<span class="id">xs</span> =&gt; <span class="kwd">match</span> <span class="id">xs</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">nil</span> =&gt; <span class="id">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">y</span>::<span class="id">ls</span> =&gt; <span class="kwd">if</span> <span class="id">R_dec</span> <span class="id">x</span> <span class="id">y</span> <span class="kwd">then</span> <span class="id">is_list_sorted</span> <span class="id">xs</span> <span class="kwd">else</span> <span class="id">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">is_list_sorted_Sorted_iff</span> <span class="id">l</span>: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">is_list_sorted</span> <span class="id">l</span> = <span class="id">true</span> &lt;-&gt; <span class="id">Sorted</span> <span class="id">R</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof279')">Proof.</div>
<div class="proofscript" id="proof279">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">simpl</span>; <span class="tactic">intuition</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">H1</span>; <span class="tactic">subst</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H5</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Eqdep_dec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">RelationClasses</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">is_list_sorted_ext</span> : <span class="kwd">forall</span> <span class="id">l</span> (<span class="id">p1</span> <span class="id">p2</span>:<span class="id">is_list_sorted</span> <span class="id">l</span> = <span class="id">true</span>), <span class="id">p1</span> = <span class="id">p2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof280')">Proof.</div>
<div class="proofscript" id="proof280">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">eq_proofs_unicity</span>. <span class="id">decide</span> <span class="id">equality</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">sorted_StronglySorted</span> `{<span class="id">Transitive</span> <span class="id">A</span> <span class="id">R</span>}: <span class="kwd">forall</span> <span class="id">l</span>, <span class="id">is_list_sorted</span> <span class="id">l</span> = <span class="id">true</span> &lt;-&gt; <span class="id">StronglySorted</span> <span class="id">R</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof281')">Proof.</div>
<div class="proofscript" id="proof281">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">is_list_sorted_Sorted_iff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Sorted_StronglySorted</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>. <span class="tactic">apply</span> <span class="tactic">transitivity</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">StronglySorted_Sorted</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Forall_nin_irr</span> `{<span class="id">Irreflexive</span> <span class="id">A</span> <span class="id">R</span>}: <span class="kwd">forall</span> <span class="id">a</span> <span class="id">l</span>, <span class="id">Forall</span> (<span class="id">R</span> <span class="id">a</span>) <span class="id">l</span> -&gt; ~ <span class="id">In</span> <span class="id">a</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof282')">Proof.</div>
<div class="proofscript" id="proof282">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; [<span class="tactic">auto</span>|<span class="tactic">intros</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H1</span>; <span class="tactic">subst</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">irreflexivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">IHl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">StronglySorted_NoDup</span> `{<span class="id">Irreflexive</span> <span class="id">A</span> <span class="id">R</span>}: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>, <span class="id">StronglySorted</span> <span class="id">R</span> <span class="id">l</span> -&gt; <span class="id">NoDup</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof283')">Proof.</div>
<div class="proofscript" id="proof283">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H0</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id">Forall_nin_irr</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Sorted_NoDup</span> `{<span class="id">StrictOrder</span> <span class="id">A</span> <span class="id">R</span>}: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>, <span class="id">Sorted</span> <span class="id">R</span> <span class="id">l</span> -&gt; <span class="id">NoDup</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof284')">Proof.</div>
<div class="proofscript" id="proof284">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">StronglySorted_NoDup</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Sorted_StronglySorted</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="id">etransitivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">is_list_sorted_NoDup</span> `{<span class="id">StrictOrder</span> <span class="id">A</span> <span class="id">R</span>} : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>, <span class="id">is_list_sorted</span> <span class="id">l</span> = <span class="id">true</span> -&gt; <span class="id">NoDup</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof285')">Proof.</div>
<div class="proofscript" id="proof285">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Sorted_NoDup</span>; <span class="tactic">eapply</span> <span class="id">is_list_sorted_Sorted_iff</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">is_list_sorted_cons</span> <span class="id">a</span> <span class="id">r</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">is_list_sorted</span>  (<span class="id">a</span>::<span class="id">r</span>) = <span class="id">true</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">is_list_sorted</span> <span class="id">r</span> = <span class="id">true</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="kwd">match</span> <span class="id">r</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">nil</span> =&gt; <span class="id">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">y</span>::<span class="id">_</span> =&gt; <span class="id">R</span> <span class="id">a</span> <span class="id">y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof286')">Proof.</div>
<div class="proofscript" id="proof286">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">destruct</span> <span class="id">r</span>; <span class="tactic">intuition</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">is_list_sorted_cons_inv</span> {<span class="id">a</span> <span class="id">r</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">is_list_sorted</span> (<span class="id">a</span>::<span class="id">r</span>) = <span class="id">true</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">is_list_sorted</span> <span class="id">r</span> = <span class="id">true</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof287')">Proof.</div>
<div class="proofscript" id="proof287">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">is_list_sorted_cons</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">StronglySorted_cons_in</span> {<span class="id">x</span> <span class="id">a</span> <span class="id">l</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">StronglySorted</span> <span class="id">R</span> (<span class="id">a</span>::<span class="id">l</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">R</span> <span class="id">a</span> <span class="id">x</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof288')">Proof.</div>
<div class="proofscript" id="proof288">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 1; <span class="tactic">subst</span>; <span class="tactic">intros</span> <span class="id">iin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Forall_forall</span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">insertion_sort_sorted_is_id</span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">is_list_sorted</span> <span class="id">l</span> = <span class="id">true</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">insertion_sort</span> <span class="id">l</span> = <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof289')">Proof.</div>
<div class="proofscript" id="proof289">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">is_list_sorted</span> <span class="id">l</span> = <span class="id">true</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHl</span>; <span class="tactic">clear</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">intros</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a0</span> <span class="id">a</span>); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">insertion_sort_idempotent</span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">insertion_sort</span> (<span class="id">insertion_sort</span> <span class="id">l</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">insertion_sort</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof290')">Proof.</div>
<div class="proofscript" id="proof290">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">insertion_sort_sorted_is_id</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">is_list_sorted_Sorted_iff</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">insertion_sort_Sorted</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">insertion_sort_insert_not_nil</span> <span class="id">a</span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">insertion_sort_insert</span> <span class="id">a</span> <span class="id">l</span> &lt;&gt; <span class="id">nil</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof291')">Proof.</div>
<div class="proofscript" id="proof291">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intuition</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a0</span> <span class="id">a</span>); <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">insertion_sort_nil</span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">insertion_sort</span> <span class="id">l</span> = <span class="id">nil</span> -&gt; <span class="id">l</span> = <span class="id">nil</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof292')">Proof.</div>
<div class="proofscript" id="proof292">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">insertion_sort_insert_not_nil</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;<br/>
&nbsp;<span class="kwd">Lemma</span> <span class="id">insertion_sort_insert_swap</span> <span class="id">a</span> <span class="id">a0</span> <span class="id">l</span>  `{<span class="id">StrictOrder</span> <span class="id">A</span> <span class="id">R</span>}:<br/>
&nbsp;&nbsp;&nbsp;<span class="id">R</span> <span class="id">a</span> <span class="id">a0</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id">insertion_sort_insert</span> <span class="id">a</span> (<span class="id">insertion_sort_insert</span> <span class="id">a0</span> <span class="id">l</span>) = <br/>
&nbsp;&nbsp;&nbsp;<span class="id">insertion_sort_insert</span> <span class="id">a0</span> (<span class="id">insertion_sort_insert</span> <span class="id">a</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof293')">Proof.</div>
<div class="proofscript" id="proof293">
&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">a</span> <span class="id">a0</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">simpl</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a0</span> <span class="id">a</span>); <span class="tactic">simpl</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">r0</span> <span class="kwd">in</span> <span class="id">r</span>. <span class="id">eelim</span> <span class="id">irreflexivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a1</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a0</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a0</span> <span class="id">a1</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a1</span> <span class="id">a</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a1</span> <span class="id">a0</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">r3</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="id">eelim</span> <span class="id">irreflexivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">r</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a0</span> <span class="id">a</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a1</span> <span class="id">a</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a0</span> <span class="id">a1</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a1</span> <span class="id">a0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">r1</span> <span class="kwd">in</span> <span class="id">r0</span>; <span class="id">eelim</span> <span class="id">irreflexivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a</span> <span class="id">a1</span>); <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a0</span> <span class="id">a</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a</span> <span class="id">a1</span>); <span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a0</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">r1</span> <span class="kwd">in</span> <span class="id">r0</span>; <span class="id">eelim</span> <span class="id">irreflexivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a1</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">r2</span> <span class="kwd">in</span> <span class="id">r</span>; <span class="id">eelim</span> <span class="id">irreflexivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a</span> <span class="id">a1</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a1</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">r0</span> <span class="kwd">in</span> <span class="id">r</span>; <span class="id">eelim</span> <span class="id">irreflexivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a0</span> <span class="id">a</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a</span> <span class="id">a1</span>); <span class="tactic">intuition</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">r</span>; <span class="tactic">intuition</span>.            <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a0</span> <span class="id">a</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a1</span> <span class="id">a</span>); <span class="tactic">intuition</span>.            <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">R_dec</span> <span class="id">a</span> <span class="id">a1</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id">Strongly</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id">In</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">StronglySorted_filter</span> {<span class="id">A</span>} {<span class="id">R</span>} <span class="id">f</span> {<span class="id">l</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id">StronglySorted</span> <span class="id">A</span> <span class="id">R</span> <span class="id">l</span> -&gt; <span class="id">StronglySorted</span> <span class="id">R</span> (<span class="id">filter</span> <span class="id">f</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof294')">Proof.</div>
<div class="proofscript" id="proof294">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 1; <span class="tactic">simpl</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">a</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Forall_filter</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">in_insertion_sort_insert</span> {<span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span>} {<span class="id">x</span> <span class="id">l</span> <span class="id">a</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> (@<span class="id">insertion_sort_insert</span> <span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span> <span class="id">a</span> <span class="id">l</span>) -&gt; <span class="id">a</span> = <span class="id">x</span> \/ <span class="id">In</span> <span class="id">x</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof295')">Proof.</div>
<div class="proofscript" id="proof295">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">x</span> <span class="id">a</span>. <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; [<span class="tactic">intuition</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">a0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">R_dec</span> <span class="id">a0</span> <span class="id">a</span>); <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">R_dec</span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">IHl</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H2</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">in_insertion_sort</span> {<span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span>} {<span class="id">x</span> <span class="id">l</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> (@<span class="id">insertion_sort</span> <span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span> <span class="id">l</span>) -&gt; <span class="id">In</span> <span class="id">x</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof296')">Proof.</div>
<div class="proofscript" id="proof296">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">inn</span>. <span class="tactic">apply</span> <span class="id">in_insertion_sort_insert</span> <span class="kwd">in</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">asymmetric_over_cons_inv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">insertion_sort_insert_in_strong</span> {<span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span>} {<span class="id">x</span> <span class="id">l</span> <span class="id">a</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">contr</span>:<span class="id">asymmetric_over</span> <span class="id">R</span> (<span class="id">a</span>::<span class="id">l</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">a</span> = <span class="id">x</span> \/ <span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt; <span class="id">In</span> <span class="id">x</span> (@<span class="id">insertion_sort_insert</span> <span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span> <span class="id">a</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof297')">Proof.</div>
<div class="proofscript" id="proof297">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">x</span> <span class="id">a</span> <span class="id">contr</span>. <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; [<span class="tactic">intuition</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">a0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">R_dec</span> <span class="id">a0</span> <span class="id">a</span>); <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">R_dec</span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">intuition</span>; <span class="tactic">subst</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>; <span class="tactic">apply</span> (<span class="id">IHl</span> <span class="id">x</span> <span class="id">x</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">asymmetric_over_swap</span> <span class="kwd">in</span> <span class="id">contr</span>. <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">right</span>. <span class="tactic">apply</span> (<span class="id">IHl</span> <span class="id">x</span> <span class="id">a0</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">asymmetric_over_swap</span> <span class="kwd">in</span> <span class="id">contr</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">insertion_sort_insert_in</span> {<span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span>} {<span class="id">x</span> <span class="id">l</span> <span class="id">a</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">contr</span>:<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,  ~<span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; ~<span class="id">R</span> <span class="id">y</span> <span class="id">x</span> -&gt; <span class="id">x</span> = <span class="id">y</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">a</span> = <span class="id">x</span> \/ <span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt; <span class="id">In</span> <span class="id">x</span> (@<span class="id">insertion_sort_insert</span> <span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span> <span class="id">a</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof298')">Proof.</div>
<div class="proofscript" id="proof298">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">insertion_sort_insert_in_strong</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">asymmetric_asymmetric_over</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">insertion_sort_in_strong</span> {<span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span>} {<span class="id">x</span> <span class="id">l</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">contr</span>:<span class="id">asymmetric_over</span> <span class="id">R</span> <span class="id">l</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt; <span class="id">In</span> <span class="id">x</span> (@<span class="id">insertion_sort</span> <span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof299')">Proof.</div>
<div class="proofscript" id="proof299">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl</span> (<span class="id">asymmetric_over_cons_inv</span> <span class="id">contr</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">insertion_sort_insert_in_strong</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id">asymmetric_over_incl</span> <span class="id">contr</span>). <span class="tactic">clear</span>. <span class="tactic">simpl</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">in_insertion_sort</span> <span class="kwd">in</span> <span class="id">H0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">asymmetric_asymmetric_over</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">insertion_sort_in</span> {<span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span>} {<span class="id">x</span> <span class="id">l</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">contr</span>:<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,  ~<span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; ~<span class="id">R</span> <span class="id">y</span> <span class="id">x</span> -&gt; <span class="id">x</span> = <span class="id">y</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">In</span> <span class="id">x</span> <span class="id">l</span> -&gt; <span class="id">In</span> <span class="id">x</span> (@<span class="id">insertion_sort</span> <span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof300')">Proof.</div>
<div class="proofscript" id="proof300">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">insertion_sort_in_strong</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">equivlist_insertion_sort_strong</span> {<span class="id">A</span> <span class="id">R</span>} <span class="id">R_dec</span> {<span class="id">l</span> <span class="id">l</span>'}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">contr</span>:<span class="id">asymmetric_over</span> <span class="id">R</span> <span class="id">l</span>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">equivlist</span> <span class="id">l</span> <span class="id">l</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">equivlist</span> (@<span class="id">insertion_sort</span> <span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span> <span class="id">l</span>) (@<span class="id">insertion_sort</span> <span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span> <span class="id">l</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof301')">Proof.</div>
<div class="proofscript" id="proof301">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="kwd">forall</span> <span class="id">l</span> <span class="id">l</span>', (<span class="id">asymmetric_over</span> <span class="id">R</span> <span class="id">l</span>) -&gt; <span class="id">equivlist</span> <span class="id">l</span> <span class="id">l</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="id">In</span> <span class="id">x</span> (@<span class="id">insertion_sort</span> <span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span> <span class="id">l</span>) -&gt; <span class="id">In</span> <span class="id">x</span> (@<span class="id">insertion_sort</span> <span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span> <span class="id">l</span>'))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">C</span> <span class="id">eq</span> <span class="id">x</span>. <span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">specialize</span> (<span class="id">C</span> <span class="id">_</span> <span class="id">_</span> <span class="id">contr</span> <span class="id">eq</span>); <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">C</span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id">asymmetric_over_equivlist</span> <span class="id">eq</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">clear</span> <span class="id">l</span> <span class="id">l</span>' <span class="id">contr</span>. <span class="tactic">intros</span> <span class="id">l</span> <span class="id">l</span>' <span class="id">asym</span> <span class="id">incl</span> <span class="id">x</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">in_insertion_sort</span> <span class="kwd">in</span> <span class="id">inn</span>. <span class="tactic">apply</span> <span class="id">incl</span> <span class="kwd">in</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">insertion_sort_in_strong</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">asymmetric_over_equivlist</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>. <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">equivlist_insertion_sort</span> {<span class="id">A</span> <span class="id">R</span>} <span class="id">R_dec</span> {<span class="id">l</span> <span class="id">l</span>'}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">contr</span>:<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,  ~<span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; ~<span class="id">R</span> <span class="id">y</span> <span class="id">x</span> -&gt; <span class="id">x</span> = <span class="id">y</span>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">equivlist</span> <span class="id">l</span> <span class="id">l</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">equivlist</span> (@<span class="id">insertion_sort</span> <span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span> <span class="id">l</span>) (@<span class="id">insertion_sort</span> <span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span> <span class="id">l</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof302')">Proof.</div>
<div class="proofscript" id="proof302">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">equivlist_insertion_sort_strong</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">asymmetric_asymmetric_over</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">insertion_sort_insert_insertion_nin</span>  {<span class="id">A</span>:<span class="kwd">Type</span>} <span class="id">lt</span> <span class="id">dec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id">StrictOrder</span> <span class="id">A</span> <span class="id">lt</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">trich</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, {<span class="id">lt</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">eq</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">lt</span> <span class="id">b</span> <span class="id">a</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span>:<span class="id">A</span>) <span class="id">a0</span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;~ <span class="id">lt</span> <span class="id">a0</span> <span class="id">a</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;~ <span class="id">lt</span> <span class="id">a</span> <span class="id">a0</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id">insertion_sort_insert</span> <span class="id">dec</span> <span class="id">a0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">insertion_sort_insert</span> <span class="id">dec</span> <span class="id">a</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;= @<span class="id">insertion_sort_insert</span> <span class="id">A</span> <span class="id">lt</span> <span class="id">dec</span> <span class="id">a</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof303')">Proof.</div>
<div class="proofscript" id="proof303">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">a</span> <span class="id">a0</span>. <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">repeat</span> (<span class="id">match_destr</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">repeat</span> (<span class="id">match_destr</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">repeat</span> (<span class="id">match_destr</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>); <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">l0</span> <span class="kwd">in</span> <span class="id">l1</span>. <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">IHl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">trich</span> <span class="id">a</span> <span class="id">a0</span>) <span class="kwd">as</span> [[?|?]|?];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id">trich</span> <span class="id">a</span> <span class="id">a0</span>) <span class="kwd">as</span> [[?|?]|?];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;<span class="kwd">Lemma</span> <span class="id">insertion_sort_insert_cons_app</span> {<span class="id">A</span>:<span class="kwd">Type</span>} <span class="id">lt</span> <span class="id">dec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id">StrictOrder</span> <span class="id">A</span> <span class="id">lt</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">trich</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, {<span class="id">lt</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">eq</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">lt</span> <span class="id">b</span> <span class="id">a</span>}) <span class="id">a</span> <span class="id">l</span> <span class="id">l2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">insertion_sort</span> <span class="id">dec</span> (<span class="id">insertion_sort_insert</span> <span class="id">dec</span> <span class="id">a</span> <span class="id">l</span> ++ <span class="id">l2</span>) = @<span class="id">insertion_sort</span> <span class="id">A</span> <span class="id">lt</span> <span class="id">dec</span> (<span class="id">a</span>::<span class="id">l</span> ++ <span class="id">l2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof304')">Proof.</div>
<div class="proofscript" id="proof304">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">a</span> <span class="id">l2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">dec</span> <span class="id">a0</span> <span class="id">a</span>); <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">dec</span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">IHl</span>; <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">insertion_sort_insert_swap</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">insertion_sort_insert_insertion_nin</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;<span class="kwd">Lemma</span> <span class="id">insertion_sort_insertion_sort_app1</span> {<span class="id">A</span>} <span class="id">lt</span> <span class="id">dec</span> `{<span class="id">StrictOrder</span> <span class="id">A</span> <span class="id">lt</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">trich</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, {<span class="id">lt</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">eq</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">lt</span> <span class="id">b</span> <span class="id">a</span>}) <span class="id">l1</span> <span class="id">l2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">insertion_sort</span> <span class="id">dec</span> (<span class="id">insertion_sort</span> <span class="id">dec</span> <span class="id">l1</span> ++ <span class="id">l2</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id">insertion_sort</span> <span class="id">A</span> <span class="id">lt</span> <span class="id">dec</span> (<span class="id">l1</span> ++ <span class="id">l2</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof305')">Proof.</div>
<div class="proofscript" id="proof305">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">l2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l1</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">insertion_sort_insert_cons_app</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHl1</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">insertion_sort_trich_equiv</span> {<span class="id">A</span>:<span class="kwd">Type</span>} <span class="id">lt</span> <span class="id">dec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">trich</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, {<span class="id">lt</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">eq</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">lt</span> <span class="id">b</span> <span class="id">a</span>}) (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>)<br/>
&nbsp;&nbsp;: <span class="id">equivlist</span> (@<span class="id">insertion_sort</span> <span class="id">A</span> <span class="id">lt</span> <span class="id">dec</span> <span class="id">l</span>) <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof306')">Proof.</div>
<div class="proofscript" id="proof306">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">in_insertion_sort</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">insertion_sort_in</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">trich</span> <span class="id">x0</span> <span class="id">y</span>) <span class="kwd">as</span> [[?|?]|?]; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">insertion_sort_insert_forall_lt</span> <br/>
&nbsp;&nbsp;&nbsp;{<span class="id">A</span>:<span class="kwd">Type</span>} <span class="id">lt</span> <span class="id">dec</span> (<span class="id">a</span>:<span class="id">A</span>) (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forall</span> (<span class="id">lt</span> <span class="id">a</span>) <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id">insertion_sort_insert</span> <span class="id">A</span> <span class="id">lt</span> <span class="id">dec</span> <span class="id">a</span> <span class="id">l</span> = <span class="id">a</span> :: <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof307')">Proof.</div>
<div class="proofscript" id="proof307">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> 1; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">sort_insert_filter_true</span> {<span class="id">A</span>:<span class="kwd">Type</span>} <span class="id">f</span> <span class="id">lt</span> <span class="id">dec</span> `{<span class="id">StrictOrder</span> <span class="id">A</span> <span class="id">lt</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">trich</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, {<span class="id">lt</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">eq</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">lt</span> <span class="id">b</span> <span class="id">a</span>}) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span>:<span class="id">A</span>) (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">StronglySorted</span> <span class="id">lt</span> <span class="id">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">a</span> = <span class="id">true</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">filter</span> <span class="id">f</span> (@<span class="id">insertion_sort_insert</span> <span class="id">A</span> <span class="id">lt</span> <span class="id">dec</span> <span class="id">a</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id">insertion_sort_insert</span> <span class="id">dec</span> <span class="id">a</span> (<span class="id">filter</span> <span class="id">f</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof308')">Proof.</div>
<div class="proofscript" id="proof308">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">b</span> <span class="id">lsort</span> <span class="id">fb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">fb</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">lsort</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">f</span> <span class="id">a</span>); <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">fa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+  <span class="tactic">destruct</span> (<span class="id">dec</span> <span class="id">b</span> <span class="id">a</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">fb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> &lt;- <span class="id">IHl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id">fa</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_destr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">fb</span>, <span class="id">fa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">insertion_sort_insert_forall_lt</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Forall_filter</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Forall_impl_in</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">etransitivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> &lt;- <span class="id">IHl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">match_destr</span>; <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id">fa</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">trich</span> <span class="id">a</span> <span class="id">b</span>) <span class="kwd">as</span> [[?|?]|?]; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">sort_insert_filter_false</span> {<span class="id">A</span>:<span class="kwd">Type</span>} <span class="id">f</span> <span class="id">lt</span> <span class="id">dec</span> (<span class="id">a</span>:<span class="id">A</span>) (<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span> <span class="id">a</span> = <span class="id">false</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">filter</span> <span class="id">f</span> (@<span class="id">insertion_sort_insert</span> <span class="id">A</span> <span class="id">lt</span> <span class="id">dec</span> <span class="id">a</span> <span class="id">l</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">filter</span> <span class="id">f</span> <span class="id">l</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof309')">Proof.</div>
<div class="proofscript" id="proof309">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> ? <span class="id">fa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">fa</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">match_destr</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">fa</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">match_destr</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">sort_filter_commute</span> {<span class="id">A</span>:<span class="kwd">Type</span>} <span class="id">f</span> <span class="id">lt</span> <span class="id">dec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id">StrictOrder</span> <span class="id">A</span> <span class="id">lt</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">trich</span>:<span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, {<span class="id">lt</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">eq</span> <span class="id">a</span> <span class="id">b</span>} + {<span class="id">lt</span> <span class="id">b</span> <span class="id">a</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span>:<span class="id">list</span> <span class="id">A</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">filter</span> <span class="id">f</span> (@<span class="id">insertion_sort</span> <span class="id">A</span> <span class="id">lt</span> <span class="id">dec</span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id">insertion_sort</span> <span class="id">dec</span> (<span class="id">filter</span> <span class="id">f</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof310')">Proof.</div>
<div class="proofscript" id="proof310">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case_eq</span> (<span class="id">f</span> <span class="id">a</span>); <span class="tactic">intros</span> <span class="id">fa</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id">IHl</span>, <span class="id">sort_insert_filter_true</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">Sorted_StronglySorted</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">StrictOrder_Transitive</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">insertion_sort_Sorted</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id">IHl</span>, <span class="id">sort_insert_filter_false</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">Forall_insertion_sort</span> {<span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span>} {<span class="id">P</span>} <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forall</span> <span class="id">P</span> <span class="id">l</span> -&gt; <span class="id">Forall</span> <span class="id">P</span> (@<span class="id">insertion_sort</span> <span class="id">A</span> <span class="id">R</span> <span class="id">R_dec</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof311')">Proof.</div>
<div class="proofscript" id="proof311">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Forall_forall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">fp</span> <span class="id">x</span> <span class="id">inx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">in_insertion_sort</span> <span class="kwd">in</span> <span class="id">inx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id">In</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id">map</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">map_insertion_sort_insert</span> {<span class="id">A</span> <span class="id">B</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">R1</span> <span class="id">R2</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R1_dec</span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">a</span>' : <span class="id">A</span>, {<span class="id">R1</span> <span class="id">a</span> <span class="id">a</span>'} + {~ <span class="id">R1</span> <span class="id">a</span> <span class="id">a</span>'})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R2_dec</span> : <span class="kwd">forall</span> <span class="id">b</span> <span class="id">b</span>' : <span class="id">B</span>, {<span class="id">R2</span> <span class="id">b</span> <span class="id">b</span>'} + {~ <span class="id">R2</span> <span class="id">b</span> <span class="id">b</span>'})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">consistent</span>:<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">R1</span> <span class="id">x</span> <span class="id">y</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">R2</span> (<span class="id">f</span> <span class="id">x</span>) (<span class="id">f</span> <span class="id">y</span>)) <span class="id">a</span> <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span> <span class="id">f</span> (<span class="id">insertion_sort_insert</span> <span class="id">R1_dec</span> <span class="id">a</span> <span class="id">l</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">insertion_sort_insert</span> <span class="id">R2_dec</span> (<span class="id">f</span> <span class="id">a</span>) (<span class="id">map</span> <span class="id">f</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof312')">Proof.</div>
<div class="proofscript" id="proof312">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">consistent</span> <span class="id">a</span> <span class="id">a0</span>); <span class="tactic">destruct</span> (<span class="id">consistent</span> <span class="id">a0</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">match_destr</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id">map_insertion_sort</span> {<span class="id">A</span> <span class="id">B</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">R1</span> <span class="id">R2</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R1_dec</span> : <span class="kwd">forall</span> <span class="id">a</span> <span class="id">a</span>' : <span class="id">A</span>, {<span class="id">R1</span> <span class="id">a</span> <span class="id">a</span>'} + {~ <span class="id">R1</span> <span class="id">a</span> <span class="id">a</span>'})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R2_dec</span> : <span class="kwd">forall</span> <span class="id">b</span> <span class="id">b</span>' : <span class="id">B</span>, {<span class="id">R2</span> <span class="id">b</span> <span class="id">b</span>'} + {~ <span class="id">R2</span> <span class="id">b</span> <span class="id">b</span>'})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span>:<span class="id">A</span>-&gt;<span class="id">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">consistent</span>:<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">R1</span> <span class="id">x</span> <span class="id">y</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">R2</span> (<span class="id">f</span> <span class="id">x</span>) (<span class="id">f</span> <span class="id">y</span>)) <span class="id">l</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span> <span class="id">f</span> (<span class="id">insertion_sort</span> <span class="id">R1_dec</span> <span class="id">l</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">insertion_sort</span> <span class="id">R2_dec</span> (<span class="id">map</span> <span class="id">f</span> <span class="id">l</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof313')">Proof.</div>
<div class="proofscript" id="proof313">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">map_insertion_sort_insert</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id">map</span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id">RSort</span>.<br/>
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
