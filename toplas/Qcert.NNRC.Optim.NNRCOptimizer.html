
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Qcert.NNRC.Optim.NNRCOptimizer</title>
<meta name="description" content="Documentation of Coq module Qcert.NNRC.Optim.NNRCOptimizer" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Qcert.NNRC.Optim.NNRCOptimizer</h1>
<div class="coq">
<br/>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html">String</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.ListSet.html">ListSet</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html">BinInt</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Arith.html">Arith</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Equivalence.html">Equivalence</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Morphisms.html">Morphisms</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Setoids.Setoid.html">Setoid</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html">EquivDec</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="kwd">Program</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.Utils.Utils.html">Utils</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.Data.DataSystem.html">DataSystem</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.cNNRC.cNNRCSystem.html">cNNRCSystem</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.NNRC.NNRCSystem.html">NNRCSystem</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCRewriteUtil.html">NNRCRewriteUtil</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCRewrite.html">NNRCRewrite</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html">TNNRCRewrite</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.Utils.OptimizerLogger.html">OptimizerLogger</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Qcert.Utils.OptimizerStep.html">OptimizerStep</a></span>.<br/>
<br/>
<span class="kwd">Import</span> <span class="id">ListNotations</span>.<br/>
<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="NNRCOptimizer">NNRCOptimizer</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">nnrc_scope</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">string</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="NNRCOptimizer.engine">engine</a></span>.<br/>
<div class="doc">Apply the function f to the direct child of p </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="nnrc_map">nnrc_map</a></span> (<span class="id">f</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span> -&gt; <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCGetConstant">NNRCGetConstant</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCGetConstant">NNRCGetConstant</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id">bop</span> <span class="id">e1</span> <span class="id">e2</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id">bop</span> (<span class="id">f</span> <span class="id">e1</span>) (<span class="id">f</span> <span class="id">e2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">uop</span> <span class="id">e1</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">uop</span> (<span class="id">f</span> <span class="id">e1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id">v</span> <span class="id">e1</span> <span class="id">e2</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id">v</span> (<span class="id">f</span> <span class="id">e1</span>) (<span class="id">f</span> <span class="id">e2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v</span> <span class="id">e1</span> <span class="id">e2</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v</span> (<span class="id">f</span> <span class="id">e1</span>) (<span class="id">f</span> <span class="id">e2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">e3</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> (<span class="id">f</span> <span class="id">e1</span>) (<span class="id">f</span> <span class="id">e2</span>) (<span class="id">f</span> <span class="id">e3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">ed</span> <span class="id">xl</span> <span class="id">el</span> <span class="id">xr</span> <span class="id">er</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> (<span class="id">f</span> <span class="id">ed</span>) <span class="id">xl</span> (<span class="id">f</span> <span class="id">el</span>) <span class="id">xr</span> (<span class="id">f</span> <span class="id">er</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCGroupBy">NNRCGroupBy</a></span> <span class="id">g</span> <span class="id">sl</span> <span class="id">e1</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCGroupBy">NNRCGroupBy</a></span> <span class="id">g</span> <span class="id">sl</span> (<span class="id">f</span> <span class="id">e1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="nnrc_map_correctness">nnrc_map_correctness</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span> -&gt; <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">e</span>', <span class="id"><a href="Qcert.NNRC.Lang.NNRCEq.html#nnrc_eq">nnrc_eq</a></span> (<span class="id">f</span> <span class="id">e</span>') <span class="id">e</span>') -&gt; <span class="id"><a href="Qcert.NNRC.Lang.NNRCEq.html#nnrc_eq">nnrc_eq</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map">nnrc_map</a></span> <span class="id">f</span> <span class="id">e</span>) <span class="id">e</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3123')">Proof.</div>
<div class="proofscript" id="proof3123">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">f</span> <span class="id">e</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nnrc_cases</span> (<span class="tactic">induction</span> <span class="id">e</span>) <span class="id">Case</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">simpl</span>; <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Hf</span>; <span class="tactic">reflexivity</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">Apply the function f to all subexpression of e. </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="nnrc_map_deep">nnrc_map_deep</a></span> (<span class="id">f</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span> -&gt; <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) (<span class="id">e</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCGetConstant">NNRCGetConstant</a></span> <span class="id">v</span> =&gt; <span class="id">f</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCGetConstant">NNRCGetConstant</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id">v</span> =&gt; <span class="id">f</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span> =&gt; <span class="id">f</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id">bop</span> <span class="id">e1</span> <span class="id">e2</span> =&gt; <span class="id">f</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id">bop</span> (<span class="id">nnrc_map_deep</span> <span class="id">f</span> <span class="id">e1</span>) (<span class="id">nnrc_map_deep</span> <span class="id">f</span> <span class="id">e2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">uop</span> <span class="id">e1</span> =&gt; <span class="id">f</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">uop</span> (<span class="id">nnrc_map_deep</span> <span class="id">f</span> <span class="id">e1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id">v</span> <span class="id">e1</span> <span class="id">e2</span> =&gt; <span class="id">f</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id">v</span> (<span class="id">nnrc_map_deep</span> <span class="id">f</span> <span class="id">e1</span>) (<span class="id">nnrc_map_deep</span> <span class="id">f</span> <span class="id">e2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v</span> <span class="id">e1</span> <span class="id">e2</span> =&gt; <span class="id">f</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v</span> (<span class="id">nnrc_map_deep</span> <span class="id">f</span> <span class="id">e1</span>) (<span class="id">nnrc_map_deep</span> <span class="id">f</span> <span class="id">e2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">e3</span> =&gt; <span class="id">f</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> (<span class="id">nnrc_map_deep</span> <span class="id">f</span> <span class="id">e1</span>) (<span class="id">nnrc_map_deep</span> <span class="id">f</span> <span class="id">e2</span>) (<span class="id">nnrc_map_deep</span> <span class="id">f</span> <span class="id">e3</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">ed</span> <span class="id">xl</span> <span class="id">el</span> <span class="id">xr</span> <span class="id">er</span> =&gt; <span class="id">f</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> (<span class="id">nnrc_map_deep</span> <span class="id">f</span> <span class="id">ed</span>) <span class="id">xl</span> (<span class="id">nnrc_map_deep</span> <span class="id">f</span>  <span class="id">el</span>) <span class="id">xr</span> (<span class="id">nnrc_map_deep</span> <span class="id">f</span> <span class="id">er</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCGroupBy">NNRCGroupBy</a></span> <span class="id">g</span> <span class="id">sl</span> <span class="id">e1</span> =&gt; <span class="id">f</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCGroupBy">NNRCGroupBy</a></span> <span class="id">g</span> <span class="id">sl</span> (<span class="id">nnrc_map_deep</span> <span class="id">f</span> <span class="id">e1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="nnrc_map_deep_corretness">nnrc_map_deep_corretness</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span> -&gt; <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">e</span>', <span class="id"><a href="Qcert.NNRC.Lang.NNRCEq.html#nnrc_eq">nnrc_eq</a></span> (<span class="id">f</span> <span class="id">e</span>') <span class="id">e</span>') -&gt; <span class="id"><a href="Qcert.NNRC.Lang.NNRCEq.html#nnrc_eq">nnrc_eq</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map_deep">nnrc_map_deep</a></span> <span class="id">f</span> <span class="id">e</span>) <span class="id">e</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3124')">Proof.</div>
<div class="proofscript" id="proof3124">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">f</span> <span class="id">e</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nnrc_cases</span> (<span class="tactic">induction</span> <span class="id">e</span>) <span class="id">Case</span>; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Hf</span>; <span class="tactic">reflexivity</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Hf</span>; <span class="tactic">rewrite</span> <span class="id">IHe</span>; <span class="tactic">reflexivity</span> ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Hf</span>; <span class="tactic">rewrite</span> <span class="id">IHe1</span>; <span class="tactic">rewrite</span> <span class="id">IHe2</span>; <span class="tactic">reflexivity</span> ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">Hf</span>; <span class="tactic">rewrite</span> <span class="id">IHe1</span>; <span class="tactic">rewrite</span> <span class="id">IHe2</span>; <span class="tactic">rewrite</span> <span class="id">IHe3</span>; <span class="tactic">reflexivity</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="nunshadow">nunshadow</a></span> := <span class="id"><a href="Qcert.NNRC.Lang.NNRCShadow.html#unshadow_simpl">unshadow_simpl</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="head_rew">head_rew</a></span> (<span class="id">e</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nunshadow">nunshadow</a></span> <span class="id">e</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="head_rew_correctness">head_rew_correctness</a></span> <span class="id">e</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Lang.NNRCEq.html#nnrc_eq">nnrc_eq</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#head_rew">head_rew</a></span> <span class="id">e</span>) <span class="id">e</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3125')">Proof.</div>
<div class="proofscript" id="proof3125">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#head_rew">head_rew</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCRewrite.html#nnrc_unshadow_preserves">nnrc_unshadow_preserves</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="rewriter_simpl_rew_no_free_var">rewriter_simpl_rew_no_free_var</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">op</span> : <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) (<span class="id">x</span> : <span class="id"><a href="Qcert.Utils.Var.html#var">var</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRCVars.html#nnrc_free_vars">nnrc_free_vars</a></span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#head_rew">head_rew</a></span> <span class="id">op</span>)) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRCVars.html#nnrc_free_vars">nnrc_free_vars</a></span> <span class="id">op</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3126')">Proof.</div>
<div class="proofscript" id="proof3126">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#head_rew">head_rew</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCRewrite.html#unshadow_free_vars">unshadow_free_vars</a></span>; <span class="tactic">eapply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#NNRCOptimizer.engine">engine</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">tcorrectness_prover</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">repeat</span> <span class="tactic">progress</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">try</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id">context</span> [<span class="kwd">match</span> ?<span class="id">p</span> <span class="kwd">with</span> | <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span>] ] =&gt; <span class="tactic">destruct</span> <span class="id">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.Equivalence.html#equiv">Equivalence.equiv</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">subst</span>).<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">tprove_correctness</span> <span class="id">p</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">p</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tcorrectness_prover</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tnnrc_rewrites_to_trans">tnnrc_rewrites_to_trans</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} <span class="id">e1</span> <span class="id">e2</span> <span class="id">e3</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e1</span> <span class="id">e2</span> -&gt; <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e2</span> <span class="id">e3</span> -&gt; <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e1</span> <span class="id">e3</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3127')">Proof.</div>
<div class="proofscript" id="proof3127">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="tactic">transitivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="AUX">AUX</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} <span class="id">f</span> <span class="id">e</span> <span class="id">e</span>' :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">e</span>, <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id">f</span> <span class="id">e</span>)) -&gt; <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> <span class="id">e</span>' -&gt; <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id">f</span> <span class="id">e</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3128')">Proof.</div>
<div class="proofscript" id="proof3128">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">e</span>') <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tnnrc_map">tnnrc_map</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} := <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map">nnrc_map</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tnnrc_map_correctness">tnnrc_map_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span> -&gt; <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">p</span>', <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">p</span>' (<span class="id">f</span> <span class="id">p</span>')) -&gt; <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">p</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_map">tnnrc_map</a></span> <span class="id">f</span> <span class="id">p</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3129')">Proof.</div>
<div class="proofscript" id="proof3129">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nnrc_cases</span> (<span class="tactic">induction</span> <span class="id">p</span>) <span class="id">Case</span>; <span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">simpl</span>; <span class="tactic">apply</span> <span class="id">Hf</span>]; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">reflexivity</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p1</span>) <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p2</span>) <span class="tactic">at</span> 1; <span class="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p</span>) <span class="tactic">at</span> 1; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p1</span>) <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p2</span>) <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p3</span>) <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p1</span>) <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p2</span>) <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p3</span>) <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">H</span> <span class="id">p</span>) <span class="tactic">at</span> 1; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tnnrc_map_deep">tnnrc_map_deep</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} := <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_map_deep">nnrc_map_deep</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tnnrc_map_deep_correctness">tnnrc_map_deep_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span> -&gt; <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span>: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">p</span>', <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">p</span>' (<span class="id">f</span> <span class="id">p</span>')) -&gt; <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">p</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_map_deep">tnnrc_map_deep</a></span> <span class="id">f</span> <span class="id">p</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3130')">Proof.</div>
<div class="proofscript" id="proof3130">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">f</span> <span class="id">p</span> <span class="id">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nnrc_cases</span> (<span class="tactic">induction</span> <span class="id">p</span>) <span class="id">Case</span>; <span class="tactic">try</span> <span class="id">solve</span> [<span class="tactic">simpl</span>; <span class="tactic">apply</span> <span class="id">Hf</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">rewrite</span> <span class="id">IHp1</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">IHp2</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">Hf</span> <span class="tactic">at</span> 1; <span class="tactic">reflexivity</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">rewrite</span> <span class="id">IHp</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">Hf</span> <span class="tactic">at</span> 1; <span class="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHp1</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">IHp2</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">IHp3</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">Hf</span> <span class="tactic">at</span> 1; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHp1</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">IHp2</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">IHp3</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">Hf</span> <span class="tactic">at</span> 1; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tunshadow_preserves_fun">tunshadow_preserves_fun</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Lang.NNRCShadow.html#unshadow_simpl">unshadow_simpl</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id">e</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tunshadow_preserves_fun_correctness">tunshadow_preserves_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunshadow_preserves_fun">tunshadow_preserves_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3131')">Proof.</div>
<div class="proofscript" id="proof3131">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunshadow_preserves_fun">tunshadow_preserves_fun</a></span>, <span class="id"><a href="Qcert.NNRC.Lang.NNRCShadow.html#unshadow_simpl">unshadow_simpl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tunshadow_preserves_arrow">tunshadow_preserves_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tunshadow_preserves_step">tunshadow_preserves_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">unshadow</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Renames</span> <span class="id">variables</span> <span class="id">to</span> <span class="id">avoid</span> <span class="id">shadowing</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tunshadow_preserves_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunshadow_preserves_fun">tunshadow_preserves_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tunshadow_preserves_step_correct">tunshadow_preserves_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunshadow_preserves_step">tunshadow_preserves_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunshadow_preserves_fun_correctness">tunshadow_preserves_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tconcat_nil_fun">tconcat_nil_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id"><a href="Qcert.Data.Operators.BinaryOperators.html#OpRecConcat">OpRecConcat</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Data.Model.Data.html#drec">drec</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) <span class="id">ee</span> =&gt; <span class="id">ee</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id"><a href="Qcert.Data.Operators.BinaryOperators.html#OpRecConcat">OpRecConcat</a></span> <span class="id">ee</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Data.Model.Data.html#drec">drec</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) =&gt; <span class="id">ee</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tconcat_nil_fun_correctness">tconcat_nil_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tconcat_nil_fun">tconcat_nil_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3132')">Proof.</div>
<div class="proofscript" id="proof3132">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">e1</span> == (‵[||])).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tconcat_of_nil_l_arrow">tconcat_of_nil_l_arrow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">e2</span> == (‵[||])).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tconcat_of_nil_r_arrow">tconcat_of_nil_r_arrow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">match_destr</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">repeat</span> (<span class="id">match_destr</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tconcat_nil_step">tconcat_nil_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">concat</span>/<span class="id">nil</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Remove</span> <span class="id">record</span> <span class="id">concatenation</span> <span class="kwd">with</span> <span class="id">an</span> <span class="id">empty</span> <span class="id">bag</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tconcat_nil_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tconcat_nil_fun">tconcat_nil_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tconcat_nil_step_correct">tconcat_nil_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tconcat_nil_step">tconcat_nil_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tconcat_nil_fun_correctness">tconcat_nil_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tmerge_nil_fun">tmerge_nil_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id"><a href="Qcert.Data.Operators.BinaryOperators.html#OpRecMerge">OpRecMerge</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Data.Model.Data.html#drec">drec</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) <span class="id">ee</span> =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpBag">OpBag</a></span> <span class="id">ee</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id"><a href="Qcert.Data.Operators.BinaryOperators.html#OpRecMerge">OpRecMerge</a></span> <span class="id">ee</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Data.Model.Data.html#drec">drec</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) =&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpBag">OpBag</a></span> <span class="id">ee</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tmerge_nil_fun_correctness">tmerge_nil_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_nil_fun">tmerge_nil_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3133')">Proof.</div>
<div class="proofscript" id="proof3133">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">e1</span> == (‵[||])).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tmerge_of_nil_l_arrow">tmerge_of_nil_l_arrow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id">e2</span> == (‵[||])).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tmerge_of_nil_r_arrow">tmerge_of_nil_r_arrow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">match_destr</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">repeat</span> (<span class="id">match_destr</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tmerge_nil_step">tmerge_nil_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">merge</span>/<span class="id">nil</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Remove</span> <span class="id">record</span> <span class="id">merge</span> <span class="kwd">with</span> <span class="id">an</span> <span class="id">empty</span> <span class="id">bag</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tmerge_nil_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_nil_fun">tmerge_nil_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tmerge_nil_step_correct">tmerge_nil_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_nil_step">tmerge_nil_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_nil_fun_correctness">tmerge_nil_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_nil_fun">tfor_nil_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">x</span> ‵{||} <span class="id">e2</span> =&gt; ‵{||}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tfor_nil_fun_correctness">tfor_nil_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_nil_fun">tfor_nil_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3134')">Proof.</div>
<div class="proofscript" id="proof3134">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tfor_nil_arrow">tfor_nil_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_nil_step">tfor_nil_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="kwd">for</span>/<span class="id">nil</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Remove</span> <span class="id">loop</span> <span class="id">comprehensions</span> <span class="id">over</span> <span class="id">empty</span> <span class="id">bags</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tfor_nil_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_nil_fun">tfor_nil_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_nil_step_correct">tfor_nil_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_nil_step">tfor_nil_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_nil_fun_correctness">tfor_nil_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_singleton_to_let_fun">tfor_singleton_to_let_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">x</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpBag">OpBag</a></span> <span class="id">e1</span>) <span class="id">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpBag">OpBag</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id">x</span> <span class="id">e1</span> <span class="id">e2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tfor_singleton_to_let_fun_correctness">tfor_singleton_to_let_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_singleton_to_let_fun">tfor_singleton_to_let_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3135')">Proof.</div>
<div class="proofscript" id="proof3135">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tfor_singleton_to_let_arrow">tfor_singleton_to_let_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_singleton_to_let_step">tfor_singleton_to_let_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="kwd">for</span>/<span class="id">singleton</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Lower</span> <span class="id">a</span> <span class="id">loop</span> <span class="id">comprehension</span> <span class="id">over</span> <span class="id">a</span> <span class="id">singleton</span> <span class="id">into</span> <span class="id">a</span> <span class="id">singleton</span> <span class="id">of</span> <span class="id">a</span> <span class="kwd">let</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tfor_singleton_to_let_step</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_singleton_to_let_fun">tfor_singleton_to_let_fun</a></span> .<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_singleton_to_let_step_correct">tfor_singleton_to_let_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_singleton_to_let_step">tfor_singleton_to_let_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_singleton_to_let_fun_correctness">tfor_singleton_to_let_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tflatten_singleton_fun">tflatten_singleton_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ♯<span class="id">flatten</span>(‵{| <span class="id">e1</span> |}) =&gt; <span class="id">e1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tflatten_singleton_fun_correctness">tflatten_singleton_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_singleton_fun">tflatten_singleton_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3136')">Proof.</div>
<div class="proofscript" id="proof3136">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tflatten_singleton_nnrc_arrow">tflatten_singleton_nnrc_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tflatten_singleton_step">tflatten_singleton_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">flatten</span>/<span class="id">singleton</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">a</span> <span class="id">flatten</span> <span class="id">of</span> <span class="id">a</span> <span class="id">singleton</span> <span class="id">bag</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tflatten_singleton_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_singleton_fun">tflatten_singleton_fun</a></span> .<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tflatten_singleton_step_correct">tflatten_singleton_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_singleton_step">tflatten_singleton_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_singleton_fun_correctness">tflatten_singleton_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tflatten_nil_fun">tflatten_nil_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ♯<span class="id">flatten</span>(‵{||}) =&gt; ‵{||}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tflatten_nil_fun_correctness">tflatten_nil_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_nil_fun">tflatten_nil_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3137')">Proof.</div>
<div class="proofscript" id="proof3137">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tflatten_nil_nnrc_arrow">tflatten_nil_nnrc_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tflatten_nil_step">tflatten_nil_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">flatten</span>/<span class="id">nil</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">flatten</span> <span class="id">of</span> <span class="id">an</span> <span class="id">empty</span> <span class="id">bag</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tflatten_nil_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_nil_fun">tflatten_nil_fun</a></span> .<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tflatten_nil_step_correct">tflatten_nil_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_nil_step">tflatten_nil_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_nil_fun_correctness">tflatten_nil_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tsigma_to_if_fun">tsigma_to_if_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpFlatten">OpFlatten</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v1</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpBag">OpBag</a></span> <span class="id">e2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpBag">OpBag</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id">v2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Data.Model.Data.html#dcoll">dcoll</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>))))) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id">v1</span> == <span class="id">v2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id">v1</span> <span class="id">e2</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e1</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpBag">OpBag</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id">v1</span>)) (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Data.Model.Data.html#dcoll">dcoll</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tsigma_to_if_fun_correctness">tsigma_to_if_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tsigma_to_if_fun">tsigma_to_if_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3138')">Proof.</div>
<div class="proofscript" id="proof3138">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tsigma_to_if_arrow">tsigma_to_if_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tsigma_to_if_step">tsigma_to_if_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">sigma</span>/<span class="kwd">if</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"???" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tsigma_to_if_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tsigma_to_if_fun">tsigma_to_if_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tsigma_to_if_step_correct">tsigma_to_if_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tsigma_to_if_step">tsigma_to_if_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tsigma_to_if_fun_correctness">tsigma_to_if_fun_correctness</a></span>.<br/>
&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tmap_sigma_fusion_samevar_fun">tmap_sigma_fusion_samevar_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v2</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpFlatten">OpFlatten</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v1</span> <span class="id">e1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e2</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpBag">OpBag</a></span> <span class="id">ee</span>) (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Data.Model.Data.html#dcoll">dcoll</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">e3</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id">v1</span> == <span class="id">v2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpFlatten">OpFlatten</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v1</span> <span class="id">e1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpBag">OpBag</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id">v1</span> <span class="id">ee</span> <span class="id">e3</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Data.Model.Data.html#dcoll">dcoll</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tmap_sigma_fusion_samevar_fun_correctness">tmap_sigma_fusion_samevar_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmap_sigma_fusion_samevar_fun">tmap_sigma_fusion_samevar_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3139')">Proof.</div>
<div class="proofscript" id="proof3139">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tmap_sigma_fusion_samevar_arrow">tmap_sigma_fusion_samevar_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tmap_sigma_fusion_samevar_step">tmap_sigma_fusion_samevar_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">sigma</span>/<span class="id">same</span> <span class="id">var</span> <span class="id">fusion</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"???" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tmap_sigma_fusion_samevar_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmap_sigma_fusion_samevar_fun">tmap_sigma_fusion_samevar_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tmap_sigma_fusion_samevar_step_correct">tmap_sigma_fusion_samevar_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmap_sigma_fusion_samevar_step">tmap_sigma_fusion_samevar_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmap_sigma_fusion_samevar_fun_correctness">tmap_sigma_fusion_samevar_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tdot_of_rec_fun">tdot_of_rec_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpDot">OpDot</a></span> <span class="id">s1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRec">OpRec</a></span> <span class="id">s2</span>) <span class="id">e1</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id">s1</span> == <span class="id">s2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id">e1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tdot_of_rec_fun_correctness">tdot_of_rec_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_rec_fun">tdot_of_rec_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3140')">Proof.</div>
<div class="proofscript" id="proof3140">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tdot_of_rec">tdot_of_rec</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tdot_of_rec_step">tdot_of_rec_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">dot</span>/<span class="id">rec</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">lookup</span> <span class="id">of</span> <span class="id">a</span> <span class="id">new</span> <span class="id">record</span> <span class="id">constructor</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tdot_of_rec_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_rec_fun">tdot_of_rec_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tdot_of_rec_step_correct">tdot_of_rec_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_rec_step">tdot_of_rec_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_rec_fun_correctness">tdot_of_rec_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tnth0_bag_fun">tnth0_bag_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id"><a href="Qcert.Data.Operators.BinaryOperators.html#OpBagNth">OpBagNth</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpBag">OpBag</a></span> <span class="id">e</span>) (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Data.Model.Data.html#dnat">dnat</a></span> 0))) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpLeft">OpLeft</a></span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tnth0_bag_fun_correctness">tnth0_bag_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnth0_bag_fun">tnth0_bag_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3141')">Proof.</div>
<div class="proofscript" id="proof3141">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnth0_bag">tnth0_bag</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tnth0_bag_step">tnth0_bag_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">nth0</span>/<span class="id">bag</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">first</span> <span class="id">element</span> <span class="id">of</span> <span class="id">a</span> <span class="id">collection</span> <span class="kwd">with</span> <span class="id">one</span> <span class="id">element</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tnth0_bag_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnth0_bag_fun">tnth0_bag_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tnth0_bag_step_correct">tnth0_bag_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnth0_bag_step">tnth0_bag_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnth0_bag_fun_correctness">tnth0_bag_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tnth0_nil_fun">tnth0_nil_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id"><a href="Qcert.Data.Operators.BinaryOperators.html#OpBagNth">OpBagNth</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Data.Model.Data.html#dcoll">dcoll</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Data.Model.Data.html#dnat">dnat</a></span> 0)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id"><a href="Qcert.Data.Model.Data.html#dnone">dnone</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tnth0_nil_fun_correctness">tnth0_nil_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnth0_nil_fun">tnth0_nil_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3142')">Proof.</div>
<div class="proofscript" id="proof3142">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnth0_nil">tnth0_nil</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tnth0_nil_step">tnth0_nil_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">nth0</span>/<span class="id">nil</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">first</span> <span class="id">element</span> <span class="id">of</span> <span class="id">an</span> <span class="id">empty</span> <span class="id">collection</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tnth0_nil_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnth0_nil_fun">tnth0_nil_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tnth0_nil_step_correct">tnth0_nil_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnth0_nil_step">tnth0_nil_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnth0_nil_fun_correctness">tnth0_nil_fun_correctness</a></span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tmerge_concat_to_concat_fun">tmerge_concat_to_concat_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (‵[| (<span class="id">s1</span>, <span class="id">p1</span>)|] ⊗ ‵[| (<span class="id">s2</span>, <span class="id">p2</span>)|])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="kwd">if</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_decb">equiv_decb</a></span> <span class="id">s1</span> <span class="id">s2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> (‵{|‵[| (<span class="id">s1</span>, <span class="id">p1</span>)|] ⊕ ‵[| (<span class="id">s2</span>, <span class="id">p2</span>)|]|})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tmerge_concat_to_concat_fun_correctness">tmerge_concat_to_concat_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_concat_to_concat_fun">tmerge_concat_to_concat_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3143')">Proof.</div>
<div class="proofscript" id="proof3143">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e1</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">u</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e2</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">u</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_decb">equiv_decb</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">s</span> <span class="id">s0</span>); <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrc_merge_concat_to_concat_arrow">tnnrc_merge_concat_to_concat_arrow</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tmerge_concat_to_concat_step">tmerge_concat_to_concat_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">merge</span>-<span class="id">concat</span>-&gt;<span class="id">merge</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">a</span> <span class="id">merge</span>-<span class="id">concat</span> <span class="id">of</span> <span class="id">two</span> <span class="id">singleton</span> <span class="id">records</span> <span class="kwd">with</span> <span class="id">different</span> <span class="id">fields</span> <span class="kwd">using</span> <span class="id">concat</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tmerge_concat_to_concat_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_concat_to_concat_fun">tmerge_concat_to_concat_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tmerge_concat_to_concat_step_correct">tmerge_concat_to_concat_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_concat_to_concat_step">tmerge_concat_to_concat_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_concat_to_concat_fun_correctness">tmerge_concat_to_concat_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tdot_of_concat_rec_fun">tdot_of_concat_rec_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpDot">OpDot</a></span> <span class="id">s</span>) (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id"><a href="Qcert.Data.Operators.BinaryOperators.html#OpRecConcat">OpRecConcat</a></span> <span class="id">e1</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRec">OpRec</a></span> <span class="id">s2</span>) <span class="id">e2</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_decb">equiv_decb</a></span> <span class="id">s</span> <span class="id">s2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpDot">OpDot</a></span> <span class="id">s</span>) <span class="id">e1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tdot_of_concat_rec_fun_correctness">tdot_of_concat_rec_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_concat_rec_fun">tdot_of_concat_rec_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3144')">Proof.</div>
<div class="proofscript" id="proof3144">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">u</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e2</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">u</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_decb">equiv_decb</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Classes.EquivDec.html#equiv_dec">equiv_dec</a></span> <span class="id">s</span> <span class="id">s0</span>); <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">e</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrc_dot_of_concat_rec_eq_arrow">tnnrc_dot_of_concat_rec_eq_arrow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrc_dot_of_concat_rec_neq_arrow">tnnrc_dot_of_concat_rec_neq_arrow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tdot_of_concat_rec_step">tdot_of_concat_rec_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">dot</span>/<span class="id">concat</span>/<span class="id">rec</span> 2" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplifies</span> <span class="id">lookup</span> <span class="id">of</span> <span class="id">a</span> <span class="id">concatenation</span> <span class="kwd">with</span> <span class="id">a</span> <span class="id">record</span> <span class="id">constructor</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tdot_of_concat_rec_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_concat_rec_fun">tdot_of_concat_rec_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tdot_of_concat_rec_step_correct">tdot_of_concat_rec_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_concat_rec_step">tdot_of_concat_rec_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_concat_rec_fun_correctness">tdot_of_concat_rec_fun_correctness</a></span>.<br/>
<br/>
<div class="doc">Inlining </div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="is_small_unop">is_small_unop</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">u</span>:<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#unary_op">unary_op</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">u</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpIdentity">OpIdentity</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpNeg">OpNeg</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpBag">OpBag</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpLeft">OpLeft</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRight">OpRight</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpBrand">OpBrand</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRec">OpRec</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Fixpoint</span> <span class="id"><a name="should_inline_small">should_inline_small</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">from</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">from</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">u</span> <span class="id">e</span> =&gt; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#is_small_unop">is_small_unop</a></span> <span class="id">u</span> &amp;&amp; <span class="id">should_inline_small</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id"><a href="Qcert.Data.Operators.BinaryOperators.html#OpRecConcat">OpRecConcat</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRec">OpRec</a></span> <span class="id">_</span>) <span class="id">e1</span>) (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRec">OpRec</a></span> <span class="id">_</span>) <span class="id">e2</span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="should_inline_few_occurences">should_inline_few_occurences</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">x</span>:<span class="id"><a href="Qcert.Utils.Var.html#var">var</a></span>) (<span class="id">to</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCRewriteUtil.html#use_count">use_count</a></span> <span class="id">x</span> <span class="id">to</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.NNRC.Optim.NNRCRewriteUtil.html#NotUsed">NotUsed</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.NNRC.Optim.NNRCRewriteUtil.html#UsedOnce">UsedOnce</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="should_inline">should_inline</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">x</span>:<span class="id"><a href="Qcert.Utils.Var.html#var">var</a></span>) (<span class="id">from</span> <span class="id">to</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#should_inline_small">should_inline_small</a></span> <span class="id">from</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#should_inline_few_occurences">should_inline_few_occurences</a></span> <span class="id">x</span> <span class="id">to</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tinline_let_fun">tinline_let_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id">x</span> <span class="id">e1</span> <span class="id">e2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#should_inline">should_inline</a></span> <span class="id">x</span> <span class="id">e1</span> <span class="id">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Qcert.cNNRC.Lang.cNNRCVars.html#nnrc_subst">nnrc_subst</a></span> (<span class="id"><a href="Qcert.NNRC.Lang.NNRCShadow.html#unshadow_simpl">unshadow_simpl</a></span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRCVars.html#nnrc_free_vars">nnrc_free_vars</a></span> <span class="id">e1</span>) <span class="id">e2</span>) <span class="id">x</span> <span class="id">e1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tinline_let_fun_correctness">tinline_let_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tinline_let_fun">tinline_let_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3145')">Proof.</div>
<div class="proofscript" id="proof3145">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tlet_inline_arrow">tlet_inline_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tinline_let_step">tinline_let_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="kwd">let</span> <span class="id">inline</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="kwd">Inline</span> <span class="kwd">let</span> <span class="id">statements</span> <span class="id">heuristically</span> <span class="id">deemed</span> <span class="id">suitable</span> <span class="kwd">for</span> <span class="id">inlining</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tinline_let_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tinline_let_fun">tinline_let_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tinline_let_step_correct">tinline_let_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tinline_let_step">tinline_let_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tinline_let_fun_correctness">tinline_let_fun_correctness</a></span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_over_if_nil_fun">tfor_over_if_nil_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">x</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e1</span> <span class="id">e2</span> ‵{||}) <span class="id">ebody</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e1</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">x</span> <span class="id">e2</span> <span class="id">ebody</span>) ‵{||})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tfor_over_if_nil_fun_correctness">tfor_over_if_nil_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_if_nil_fun">tfor_over_if_nil_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3146')">Proof.</div>
<div class="proofscript" id="proof3146">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tfor_over_if_arrow">tfor_over_if_arrow</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tfor_nil_arrow">tfor_nil_arrow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_over_if_nil_step">tfor_over_if_nil_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="kwd">for</span>/<span class="kwd">if</span>/<span class="kwd">else</span> <span class="id">nil</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Push</span> <span class="id">loop</span> <span class="id">comprehension</span> <span class="id">over</span> <span class="id">an</span> <span class="kwd">if</span> <span class="id">statement</span> <span class="id">through</span> <span class="id">the</span> <span class="kwd">if</span> <span class="id">statement</span> <span class="id">when</span> <span class="id">the</span> <span class="kwd">else</span> <span class="id">clause</span> <span class="id">just</span> <span class="id">constructs</span> <span class="id">an</span> <span class="id">empty</span> <span class="id">bag</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tfor_over_if_nil_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_if_nil_fun">tfor_over_if_nil_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_over_if_nil_step_correct">tfor_over_if_nil_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_if_nil_step">tfor_over_if_nil_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_if_nil_fun_correctness">tfor_over_if_nil_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_over_for_fun">tfor_over_for_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">x</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">y</span> <span class="id">source</span> <span class="id">body1</span>) <span class="id">body2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">y</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRCVars.html#nnrc_free_vars">nnrc_free_vars</a></span> <span class="id">body2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="kwd">let</span> <span class="id">fr</span> := <span class="id"><a href="Qcert.cNNRC.Lang.cNNRCVars.html#really_fresh_in">really_fresh_in</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Lang.NNRCShadow.html#nnrc_unshadow_sep">nnrc_unshadow_sep</a></span> <span class="id">y</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRCVars.html#nnrc_free_vars">nnrc_free_vars</a></span> <span class="id">body1</span> ++ <span class="id"><a href="Qcert.cNNRC.Lang.cNNRCVars.html#nnrc_bound_vars">nnrc_bound_vars</a></span> <span class="id">body1</span>) <span class="id">body2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">in</span> <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">fr</span> <span class="id">source</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id">x</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRCVars.html#nnrc_subst">nnrc_subst</a></span> <span class="id">body1</span> <span class="id">y</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id">fr</span>)) <span class="id">body2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">y</span> <span class="id">source</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id">x</span> <span class="id">body1</span> <span class="id">body2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tfor_over_for_fun_correctness">tfor_over_for_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_for_fun">tfor_over_for_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3147')">Proof.</div>
<div class="proofscript" id="proof3147">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tfor_over_for_arrow">tfor_over_for_arrow</a></span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tproper_NNRCFor">tproper_NNRCFor</a></span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRCVars.html#really_fresh_from_avoid">really_fresh_from_avoid</a></span> <span class="id"><a href="Qcert.NNRC.Lang.NNRCShadow.html#nnrc_unshadow_sep">nnrc_unshadow_sep</a></span> <span class="id">v0</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRCVars.html#nnrc_free_vars">nnrc_free_vars</a></span> <span class="id">e1_2</span> ++ <span class="id"><a href="Qcert.cNNRC.Lang.cNNRCVars.html#nnrc_bound_vars">nnrc_bound_vars</a></span> <span class="id">e1_2</span>) <span class="id">e2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>; <span class="tactic">intros</span> <span class="id">inn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcfor_rename_arrow">tnnrcfor_rename_arrow</a></span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="Qcert.cNNRC.Lang.cNNRCVars.html#really_fresh_from_free">really_fresh_from_free</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tfor_over_for_arrow">tfor_over_for_arrow</a></span>; <span class="tactic">simpl</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_over_for_step">tfor_over_for_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="kwd">for</span>/<span class="kwd">for</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Fuse</span> <span class="id">nested</span> <span class="id">loop</span> <span class="id">comprehensions</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tfor_over_for_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_for_fun">tfor_over_for_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_over_for_step_correct">tfor_over_for_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_for_step">tfor_over_for_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_for_fun_correctness">tfor_over_for_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_over_either_nil_fun">tfor_over_either_nil_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|  (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">x</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e1</span> <span class="id">xl</span> <span class="id">el</span> <span class="id">xr</span> ‵{||}) <span class="id">ebody</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(    <span class="kwd">let</span> <span class="id">xl</span>' := <span class="id"><a href="Qcert.cNNRC.Lang.cNNRCVars.html#really_fresh_in">really_fresh_in</a></span> <span class="id"><a href="Qcert.NNRC.Lang.NNRCShadow.html#nnrc_unshadow_sep">nnrc_unshadow_sep</a></span> <span class="id">xl</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRCVars.html#nnrc_free_vars">nnrc_free_vars</a></span> <span class="id">el</span> ++ <span class="id"><a href="Qcert.cNNRC.Lang.cNNRCVars.html#nnrc_bound_vars">nnrc_bound_vars</a></span> <span class="id">el</span>) <span class="id">ebody</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xl</span>' (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">x</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRCVars.html#nnrc_subst">nnrc_subst</a></span> <span class="id">el</span> <span class="id">xl</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCVar">NNRCVar</a></span> <span class="id">xl</span>')) <span class="id">ebody</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xr</span> ‵{||}))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tfor_over_either_nil_fun_correctness">tfor_over_either_nil_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_either_nil_fun">tfor_over_either_nil_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3148')">Proof.</div>
<div class="proofscript" id="proof3148">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tfor_over_either_arrow">tfor_over_either_arrow</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tfor_nil_arrow">tfor_nil_arrow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrceither_rename_r_arrow">tnnrceither_rename_r_arrow</a></span> <span class="tactic">by</span> <span class="tactic">intuition</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_over_either_nil_step">tfor_over_either_nil_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="kwd">for</span>/<span class="id">either</span>/<span class="id">right</span> <span class="id">nil</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Push</span> <span class="id">loop</span> <span class="id">comprehension</span> <span class="id">over</span> <span class="id">an</span> <span class="id">either</span> <span class="id">statement</span> <span class="id">through</span> <span class="id">the</span> <span class="id">either</span> <span class="id">statement</span> <span class="id">when</span> <span class="id">the</span> <span class="id">right</span> <span class="id">clause</span> <span class="id">just</span> <span class="id">constructs</span> <span class="id">an</span> <span class="id">empty</span> <span class="id">bag</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tfor_over_either_nil_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_either_nil_fun">tfor_over_either_nil_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tfor_over_either_nil_step_correct">tfor_over_either_nil_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_either_nil_step">tfor_over_either_nil_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_either_nil_fun_correctness">tfor_over_either_nil_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tunop_over_either_const_fun">tunop_over_either_const_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">op</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e1</span> <span class="id">xl</span> <span class="id">el</span> <span class="id">xr</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e1</span> <span class="id">xl</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">op</span> <span class="id">el</span>) <span class="id">xr</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">op</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tunop_over_either_const_fun_correctness">tunop_over_either_const_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_either_const_fun">tunop_over_either_const_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3149')">Proof.</div>
<div class="proofscript" id="proof3149">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcunop_over_either_arrow">tnnrcunop_over_either_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tunop_over_either_const_step">tunop_over_either_const_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">unary</span>/<span class="id">either</span>/<span class="id">right</span> <span class="id">const</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Push</span> <span class="id">unary</span> <span class="id">operators</span> <span class="id">through</span> <span class="id">either</span> <span class="id">when</span> <span class="id">the</span> <span class="id">right</span> <span class="id">branch</span> <span class="id">is</span> <span class="id">a</span> <span class="id">constant</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tunop_over_either_const_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_either_const_fun">tunop_over_either_const_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tunop_over_either_const_step_correct">tunop_over_either_const_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_either_const_step">tunop_over_either_const_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_either_const_fun_correctness">tunop_over_either_const_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tunop_over_if_const_fun">tunop_over_if_const_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">op</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e1</span> <span class="id">e2</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e1</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">op</span> <span class="id">e2</span>) (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> <span class="id">op</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tunop_over_if_const_fun_correctness">tunop_over_if_const_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_if_const_fun">tunop_over_if_const_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3150')">Proof.</div>
<div class="proofscript" id="proof3150">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcunop_over_if_arrow">tnnrcunop_over_if_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tunop_over_if_const_step">tunop_over_if_const_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">unary</span>/<span class="kwd">if</span>/<span class="kwd">else</span> <span class="id">const</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Push</span> <span class="id">unary</span> <span class="id">operators</span> <span class="id">through</span> <span class="kwd">if</span> <span class="id">when</span> <span class="id">the</span> <span class="kwd">else</span> <span class="id">branch</span> <span class="id">is</span> <span class="id">a</span> <span class="id">constant</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tunop_over_if_const_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_if_const_fun">tunop_over_if_const_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tunop_over_if_const_step_correct">tunop_over_if_const_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_if_const_step">tunop_over_if_const_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_if_const_fun_correctness">tunop_over_if_const_fun_correctness</a></span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tbinop_over_if_left_const_fun">tbinop_over_if_left_const_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id">op</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e1</span> <span class="id">e2</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span>)) <span class="id">e</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e1</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id">op</span> <span class="id">e2</span> <span class="id">e</span>) (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id">op</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span>) <span class="id">e</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tbinop_over_if_left_const_fun_correctness">tbinop_over_if_left_const_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tbinop_over_if_left_const_fun">tbinop_over_if_left_const_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3151')">Proof.</div>
<div class="proofscript" id="proof3151">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcbinop_over_if_left_arrow">tnnrcbinop_over_if_left_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tbinop_over_if_left_const_step">tbinop_over_if_left_const_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">binary</span>/<span class="kwd">if</span>/<span class="kwd">else</span> <span class="id">const</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Push</span> <span class="id">binary</span> <span class="id">operators</span> <span class="id">through</span> <span class="kwd">if</span> <span class="id">when</span> <span class="id">the</span> <span class="kwd">else</span> <span class="id">branch</span> <span class="id">is</span> <span class="id">a</span> <span class="id">constant</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tbinop_over_if_left_const_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tbinop_over_if_left_const_fun">tbinop_over_if_left_const_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tbinop_over_if_left_const_step_correct">tbinop_over_if_left_const_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tbinop_over_if_left_const_step">tbinop_over_if_left_const_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tbinop_over_if_left_const_fun_correctness">tbinop_over_if_left_const_fun_correctness</a></span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tbinop_over_let_left_const_fun">tbinop_over_let_left_const_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id">op</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id">x</span> <span class="id">e1</span> <span class="id">e2</span>) (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCLet">NNRCLet</a></span> <span class="id">x</span> <span class="id">e1</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id">op</span> <span class="id">e2</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> <span class="id">d</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tbinop_over_let_left_const_fun_correctness">tbinop_over_let_left_const_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tbinop_over_let_left_const_fun">tbinop_over_let_left_const_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3152')">Proof.</div>
<div class="proofscript" id="proof3152">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcbinop_over_let_left_arrow">tnnrcbinop_over_let_left_arrow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.cNNRC.Lang.cNNRCVars.html#nnrc_free_vars">nnrc_free_vars</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tbinop_over_let_left_const_step">tbinop_over_let_left_const_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">binary</span>/<span class="kwd">let</span>/<span class="id">const</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Push</span> <span class="id">binary</span> <span class="id">operators</span> <span class="id">through</span> <span class="kwd">let</span> <span class="id">when</span> <span class="id">the</span> <span class="id">right</span> <span class="id">expression</span> <span class="id">is</span> <span class="id">a</span> <span class="id">constant</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tbinop_over_let_left_const_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tbinop_over_let_left_const_fun">tbinop_over_let_left_const_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tbinop_over_let_left_const_step_correct">tbinop_over_let_left_const_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tbinop_over_let_left_const_step">tbinop_over_let_left_const_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tbinop_over_let_left_const_fun_correctness">tbinop_over_let_left_const_fun_correctness</a></span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_nil_fun">tproject_nil_fun</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRecProject">OpRecProject</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id">e</span>₁<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Data.Model.Data.html#drec">drec</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_nil_fun_correctness">tproject_nil_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} <span class="id">p</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">p</span> ⇒ᶜ <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_nil_fun">tproject_nil_fun</a></span> <span class="id">p</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3153')">Proof.</div>
<div class="proofscript" id="proof3153">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcproject_nil">tnnrcproject_nil</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Rewrite</span> @<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_nil_fun_correctness">tproject_nil_fun_correctness</a></span> : <span class="id">toptim_correct</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_nil_step">tproject_nil_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">project</span>/<span class="id">nil</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">record</span> <span class="id">projection</span> <span class="id">over</span> <span class="id">empty</span> <span class="id">bags</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tproject_nil_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_nil_fun">tproject_nil_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_nil_step_correct">tproject_nil_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_nil_step">tproject_nil_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_nil_fun_correctness">tproject_nil_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_const_fun">tproject_over_const_fun</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRecProject">OpRecProject</a></span> <span class="id">sl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Data.Model.Data.html#drec">drec</a></span> <span class="id">l</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCConst">NNRCConst</a></span> (<span class="id"><a href="Qcert.Data.Model.Data.html#drec">drec</a></span> (<span class="id"><a href="Qcert.Utils.Bindings.html#rproject">rproject</a></span> <span class="id">l</span> <span class="id">sl</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_const_fun_correctness">tproject_over_const_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} <span class="id">p</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">p</span> ⇒ᶜ <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_const_fun">tproject_over_const_fun</a></span> <span class="id">p</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3154')">Proof.</div>
<div class="proofscript" id="proof3154">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcproject_over_const">tnnrcproject_over_const</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Rewrite</span> @<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_const_fun_correctness">tproject_over_const_fun_correctness</a></span> : <span class="id">toptim_correct</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_const_step">tproject_over_const_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">project</span>/<span class="id">const</span> <span class="id">rec</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">record</span> <span class="id">projection</span> <span class="id">over</span> <span class="id">constant</span> <span class="id">records</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tproject_over_const_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_const_fun">tproject_over_const_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_const_step_correct">tproject_over_const_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_const_step">tproject_over_const_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_const_fun_correctness">tproject_over_const_fun_correctness</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_rec_fun">tproject_over_rec_fun</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRecProject">OpRecProject</a></span> <span class="id">sl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRec">OpRec</a></span> <span class="id">s</span>) <span class="id">p</span>₁)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">s</span> <span class="id">sl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRec">OpRec</a></span> <span class="id">s</span>) <span class="id">p</span>₁<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> ‵[||]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_rec_fun_correctness">tproject_over_rec_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} <span class="id">p</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">p</span> ⇒ᶜ <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_rec_fun">tproject_over_rec_fun</a></span> <span class="id">p</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3155')">Proof.</div>
<div class="proofscript" id="proof3155">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcproject_over_rec_in">tnnrcproject_over_rec_in</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcproject_over_rec_nin">tnnrcproject_over_rec_nin</a></span>; <span class="tactic">trivial</span>. <br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Rewrite</span> @<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_rec_fun_correctness">tproject_over_rec_fun_correctness</a></span> : <span class="id">toptim_correct</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_rec_step">tproject_over_rec_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">project</span>/<span class="id">rec</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">record</span> <span class="id">projection</span> <span class="id">over</span> <span class="id">a</span> <span class="id">record</span> <span class="id">constructor</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tproject_over_rec_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_rec_fun">tproject_over_rec_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_rec_step_correct">tproject_over_rec_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_rec_step">tproject_over_rec_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_rec_fun_correctness">tproject_over_rec_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_concat_r_fun">tproject_over_concat_r_fun</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRecProject">OpRecProject</a></span> <span class="id">sl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id"><a href="Qcert.Data.Operators.BinaryOperators.html#OpRecConcat">OpRecConcat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">p</span>₁ (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRec">OpRec</a></span> <span class="id">s</span>) <span class="id">p</span>₂))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">s</span> <span class="id">sl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id"><a href="Qcert.Data.Operators.BinaryOperators.html#OpRecConcat">OpRecConcat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRecProject">OpRecProject</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#remove">remove</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">s</span> <span class="id">sl</span>)) <span class="id">p</span>₁)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRec">OpRec</a></span> <span class="id">s</span>) <span class="id">p</span>₂)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRecProject">OpRecProject</a></span> <span class="id">sl</span>) <span class="id">p</span>₁)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_concat_r_fun_correctness">tproject_over_concat_r_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} <span class="id">p</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">p</span> ⇒ᶜ <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_r_fun">tproject_over_concat_r_fun</a></span> <span class="id">p</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3156')">Proof.</div>
<div class="proofscript" id="proof3156">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcproject_over_concat_rec_r_in">tnnrcproject_over_concat_rec_r_in</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcproject_over_concat_rec_r_nin">tnnrcproject_over_concat_rec_r_nin</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Rewrite</span> @<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_r_fun_correctness">tproject_over_concat_r_fun_correctness</a></span> : <span class="id">toptim_correct</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_concat_r_step">tproject_over_concat_r_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">project</span>/<span class="id">concat</span>/<span class="id">right</span> <span class="id">rec</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">record</span> <span class="id">projection</span> <span class="id">over</span> <span class="id">concatenation</span> <span class="kwd">with</span> <span class="id">a</span> <span class="id">record</span> <span class="id">constructor</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tproject_over_concat_r_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_r_fun">tproject_over_concat_r_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_concat_r_step_correct">tproject_over_concat_r_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_r_step">tproject_over_concat_r_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_r_fun_correctness">tproject_over_concat_r_fun_correctness</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_concat_l_fun">tproject_over_concat_l_fun</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRecProject">OpRecProject</a></span> <span class="id">sl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCBinop">NNRCBinop</a></span> <span class="id"><a href="Qcert.Data.Operators.BinaryOperators.html#OpRecConcat">OpRecConcat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRec">OpRec</a></span> <span class="id">s</span>) <span class="id">p</span>₁) <span class="id">p</span>₂)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">s</span> <span class="id">sl</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRecProject">OpRecProject</a></span> <span class="id">sl</span>) <span class="id">p</span>₂)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_concat_l_fun_correctness">tproject_over_concat_l_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} <span class="id">p</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">p</span> ⇒ᶜ <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_l_fun">tproject_over_concat_l_fun</a></span> <span class="id">p</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3157')">Proof.</div>
<div class="proofscript" id="proof3157">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcproject_over_concat_rec_l_nin">tnnrcproject_over_concat_rec_l_nin</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Rewrite</span> @<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_l_fun_correctness">tproject_over_concat_l_fun_correctness</a></span> : <span class="id">toptim_correct</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_concat_l_step">tproject_over_concat_l_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">project</span>/<span class="id">concat</span>/<span class="id">left</span> <span class="id">rec</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Simplify</span> <span class="id">record</span> <span class="id">projection</span> <span class="id">over</span> <span class="id">concatenation</span> <span class="kwd">with</span> <span class="id">a</span> <span class="id">record</span> <span class="id">constructor</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tproject_over_concat_l_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_l_fun">tproject_over_concat_l_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_concat_l_step_correct">tproject_over_concat_l_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_l_step">tproject_over_concat_l_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_l_fun_correctness">tproject_over_concat_l_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_project_fun">tproject_over_project_fun</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRecProject">OpRecProject</a></span> <span class="id">sl1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRecProject">OpRecProject</a></span> <span class="id">sl2</span>) <span class="id">p1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRecProject">OpRecProject</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.ListSet.html#set_inter">set_inter</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec">string_dec</a></span> <span class="id">sl2</span> <span class="id">sl1</span>)) <span class="id">p1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_project_fun_correctness">tproject_over_project_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} <span class="id">p</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">p</span> ⇒ᶜ <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_project_fun">tproject_over_project_fun</a></span> <span class="id">p</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3158')">Proof.</div>
<div class="proofscript" id="proof3158">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcproject_over_nnrcproject">tnnrcproject_over_nnrcproject</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Rewrite</span> @<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_project_fun_correctness">tproject_over_project_fun_correctness</a></span> : <span class="id">toptim_correct</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_project_step">tproject_over_project_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">project</span>/<span class="id">project</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Fuse</span> <span class="id">nested</span> <span class="id">record</span> <span class="id">projections</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tproject_over_project_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_project_fun">tproject_over_project_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_project_step_correct">tproject_over_project_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_project_step">tproject_over_project_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_project_fun_correctness">tproject_over_project_fun_correctness</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_either_fun">tproject_over_either_fun</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRecProject">OpRecProject</a></span> <span class="id">sl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">p</span> <span class="id">xl</span> <span class="id">p</span>₁ <span class="id">xr</span> <span class="id">p</span>₂)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">p</span> <span class="id">xl</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRecProject">OpRecProject</a></span> <span class="id">sl</span>) <span class="id">p</span>₁) <span class="id">xr</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCUnop">NNRCUnop</a></span> (<span class="id"><a href="Qcert.Data.Operators.UnaryOperators.html#OpRecProject">OpRecProject</a></span> <span class="id">sl</span>) <span class="id">p</span>₂)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_either_fun_correctness">tproject_over_either_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} <span class="id">p</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">p</span> ⇒ᶜ <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_either_fun">tproject_over_either_fun</a></span> <span class="id">p</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3159')">Proof.</div>
<div class="proofscript" id="proof3159">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tprove_correctness</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tnnrcproject_over_either">tnnrcproject_over_either</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Hint</span> <span class="id">Rewrite</span> @<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_either_fun_correctness">tproject_over_either_fun_correctness</a></span> : <span class="id">toptim_correct</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_either_step">tproject_over_either_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">project</span>/<span class="id">either</span>/" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Push</span> <span class="id">record</span> <span class="id">projection</span> <span class="id">through</span> <span class="id">either</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tproject_over_either_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_either_fun">tproject_over_either_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tproject_over_either_step_correct">tproject_over_either_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_either_step">tproject_over_either_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_either_fun_correctness">tproject_over_either_fun_correctness</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tcount_over_flat_for_either_if_nil_fun">tcount_over_flat_for_either_if_nil_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (♯<span class="id">count</span>(♯<span class="id">flatten</span>(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ehead</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e1</span> <span class="id">xl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e11</span>(‵{| <span class="id">e12</span>|}) ‵{||}) <span class="id">xr</span> ‵{||}))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; (♯<span class="id">count</span>(♯<span class="id">flatten</span>(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ehead</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e1</span> <span class="id">xl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCIf">NNRCIf</a></span> <span class="id">e11</span>(‵{| ‵(<span class="id"><a href="Qcert.Data.Model.Data.html#dunit">dunit</a></span>) |}) ‵{||}) <span class="id">xr</span> ‵{||}))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tcount_over_flat_for_either_if_nil_fun_correctness">tcount_over_flat_for_either_if_nil_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_if_nil_fun">tcount_over_flat_for_either_if_nil_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3160')">Proof.</div>
<div class="proofscript" id="proof3160">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">match_destr</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tcount_over_flat_for_either_if_nil_arrow">tcount_over_flat_for_either_if_nil_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tcount_over_flat_for_either_if_nil_step">tcount_over_flat_for_either_if_nil_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">count</span>/<span class="id">flatten</span>/<span class="kwd">for</span>/<span class="id">either</span>/<span class="id">right</span> <span class="kwd">if</span>/<span class="kwd">else</span> <span class="id">nil</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Remove</span> <span class="id">work</span> <span class="id">that</span> <span class="id">is</span> <span class="id">not</span> <span class="id">needed</span> <span class="id">when</span> <span class="id">only</span> <span class="id">the</span> <span class="id">bag</span> <span class="id">count</span> <span class="id">is</span> <span class="id">needed</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tcount_over_flat_for_either_if_nil_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_if_nil_fun">tcount_over_flat_for_either_if_nil_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tcount_over_flat_for_either_if_nil_step_correct">tcount_over_flat_for_either_if_nil_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_if_nil_step">tcount_over_flat_for_either_if_nil_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_if_nil_fun_correctness">tcount_over_flat_for_either_if_nil_fun_correctness</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tcount_over_flat_for_either_either_nil_fun">tcount_over_flat_for_either_either_nil_fun</a></span>  {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}(<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (♯<span class="id">count</span>(♯<span class="id">flatten</span>(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ehead</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e1</span> <span class="id">xl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e11</span> <span class="id">xll</span> (‵{| <span class="id">e12</span>|}) <span class="id">xrr</span> ‵{||}) <span class="id">xr</span> ‵{||}))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; (♯<span class="id">count</span>(♯<span class="id">flatten</span>(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCFor">NNRCFor</a></span> <span class="id">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ehead</span> (<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e1</span> <span class="id">xl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Qcert.cNNRC.Lang.cNNRC.html#NNRCEither">NNRCEither</a></span> <span class="id">e11</span> <span class="id">xll</span> (‵{| ‵(<span class="id"><a href="Qcert.Data.Model.Data.html#dunit">dunit</a></span>) |}) <span class="id">xrr</span> ‵{||}) <span class="id">xr</span> ‵{||}))))<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tcount_over_flat_for_either_either_nil_fun_correctness">tcount_over_flat_for_either_either_nil_fun_correctness</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} (<span class="id">e</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">e</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_either_nil_fun">tcount_over_flat_for_either_either_nil_fun</a></span> <span class="id">e</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3161')">Proof.</div>
<div class="proofscript" id="proof3161">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="id">match_destr</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.TNNRCRewrite.html#tcount_over_flat_for_either_either_nil_arrow">tcount_over_flat_for_either_either_nil_arrow</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tcount_over_flat_for_either_either_nil_step">tcount_over_flat_for_either_either_nil_step</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStep">mkOptimizerStep</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">count</span>/<span class="id">flatten</span>/<span class="kwd">for</span>/<span class="id">either</span>/<span class="id">right</span> <span class="id">either</span>/<span class="id">right</span> <span class="id">nil</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">Remove</span> <span class="id">work</span> <span class="id">that</span> <span class="id">is</span> <span class="id">not</span> <span class="id">needed</span> <span class="id">when</span> <span class="id">only</span> <span class="id">the</span> <span class="id">bag</span> <span class="id">count</span> <span class="id">is</span> <span class="id">needed</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<span class="id">tcount_over_flat_for_either_either_nil_fun</span>" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_either_nil_fun">tcount_over_flat_for_either_either_nil_fun</a></span> .<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tcount_over_flat_for_either_either_nil_step_correct">tcount_over_flat_for_either_either_nil_step_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#mkOptimizerStepModel">mkOptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_either_nil_step">tcount_over_flat_for_either_either_nil_step</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_either_nil_fun_correctness">tcount_over_flat_for_either_either_nil_fun_correctness</a></span>.  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tnnrc_optim_list">tnnrc_optim_list</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (@<span class="id"><a href="Qcert.Utils.OptimizerStep.html#OptimizerStep">OptimizerStep</a></span> <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tconcat_nil_step">tconcat_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_nil_step">tmerge_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_nil_step">tfor_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_singleton_to_let_step">tfor_singleton_to_let_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_singleton_step">tflatten_singleton_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_nil_step">tflatten_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tsigma_to_if_step">tsigma_to_if_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmap_sigma_fusion_samevar_step">tmap_sigma_fusion_samevar_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_rec_step">tdot_of_rec_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnth0_bag_step">tnth0_bag_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnth0_nil_step">tnth0_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_concat_to_concat_step">tmerge_concat_to_concat_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_concat_rec_step">tdot_of_concat_rec_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tinline_let_step">tinline_let_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_if_nil_step">tfor_over_if_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_for_step">tfor_over_for_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_either_nil_step">tfor_over_either_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_either_const_step">tunop_over_either_const_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_if_const_step">tunop_over_if_const_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tbinop_over_if_left_const_step">tbinop_over_if_left_const_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tbinop_over_let_left_const_step">tbinop_over_let_left_const_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_nil_step">tproject_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_const_step">tproject_over_const_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_rec_step">tproject_over_rec_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_r_step">tproject_over_concat_r_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_l_step">tproject_over_concat_l_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_project_step">tproject_over_project_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_either_step">tproject_over_either_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_if_nil_step">tcount_over_flat_for_either_if_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_either_nil_step">tcount_over_flat_for_either_either_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tnnrc_optim_model_list">tnnrc_optim_model_list</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="Qcert.Utils.OptimizerStep.html#OptimizerStepModel">OptimizerStepModel</a></span> <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tconcat_nil_step_correct">tconcat_nil_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_nil_step_correct">tmerge_nil_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_nil_step_correct">tfor_nil_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_singleton_to_let_step_correct">tfor_singleton_to_let_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_singleton_step_correct">tflatten_singleton_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_nil_step_correct">tflatten_nil_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tsigma_to_if_step_correct">tsigma_to_if_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmap_sigma_fusion_samevar_step_correct">tmap_sigma_fusion_samevar_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_rec_step_correct">tdot_of_rec_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnth0_bag_step_correct">tnth0_bag_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnth0_nil_step_correct">tnth0_nil_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_concat_to_concat_step_correct">tmerge_concat_to_concat_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_concat_rec_step_correct">tdot_of_concat_rec_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tinline_let_step_correct">tinline_let_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_if_nil_step_correct">tfor_over_if_nil_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_for_step_correct">tfor_over_for_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_either_nil_step_correct">tfor_over_either_nil_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_either_const_step_correct">tunop_over_either_const_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_if_const_step_correct">tunop_over_if_const_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tbinop_over_if_left_const_step_correct">tbinop_over_if_left_const_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tbinop_over_let_left_const_step_correct">tbinop_over_let_left_const_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_nil_step_correct">tproject_nil_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_const_step_correct">tproject_over_const_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_rec_step_correct">tproject_over_rec_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_r_step_correct">tproject_over_concat_r_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_l_step_correct">tproject_over_concat_l_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_project_step_correct">tproject_over_project_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_either_step_correct">tproject_over_either_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_if_nil_step_correct">tcount_over_flat_for_either_if_nil_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_either_nil_step_correct">tcount_over_flat_for_either_either_nil_step_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tnnrc_optim_model_list_complete">tnnrc_optim_model_list_complete</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_model_list_complete">optim_model_list_complete</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_optim_list">tnnrc_optim_list</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_optim_model_list">tnnrc_optim_model_list</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3162')">Proof.</div>
<div class="proofscript" id="proof3162">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">optim_correct_list_complete_prover</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="tnnrc_optim_list_correct">tnnrc_optim_list_correct</a></span> {<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_list_correct">optim_list_correct</a></span> <span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_optim_list">tnnrc_optim_list</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_list_correct_from_model">optim_list_correct_from_model</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_optim_model_list_complete">tnnrc_optim_model_list_complete</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="tnnrc_optim_list_distinct">tnnrc_optim_list_distinct</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_list_distinct">optim_list_distinct</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_optim_list">tnnrc_optim_list</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3163')">Proof.</div>
<div class="proofscript" id="proof3163">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_list_distinct_prover">optim_list_distinct_prover</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vm_compute</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="nnrc_optim_top">nnrc_optim_top</a></span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">logger</span>:<span class="id"><a href="Qcert.Utils.OptimizerLogger.html#optimizer_logger">optimizer_logger</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">opc</span>:<span class="id"><a href="Qcert.Utils.OptimizerLogger.html#optim_phases_config">optim_phases_config</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span> -&gt; <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Utils.OptimizerLogger.html#run_phases">run_phases</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_map_deep">tnnrc_map_deep</a></span> <span class="id"><a href="Qcert.NNRC.Lang.NNRCSize.html#nnrc_size">NNRCSize.nnrc_size</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_optim_list">tnnrc_optim_list</a></span> <span class="id">opc</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="nnrc_optim_top_correctness">nnrc_optim_top_correctness</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} {<span class="id">logger</span>:<span class="id"><a href="Qcert.Utils.OptimizerLogger.html#optimizer_logger">optimizer_logger</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">opc</span>:<span class="id"><a href="Qcert.Utils.OptimizerLogger.html#optim_phases_config">optim_phases_config</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">p</span>:<span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">p</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_optim_top">nnrc_optim_top</a></span> <span class="id">opc</span> <span class="id">p</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3164')">Proof.</div>
<div class="proofscript" id="proof3164">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_optim_top">nnrc_optim_top</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.Utils.OptimizerLogger.html#run_phases_correctness">run_phases_correctness</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_map_deep_correctness">tnnrc_map_deep_correctness</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_optim_list_correct">tnnrc_optim_list_correct</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="NNRCOptimizer.default">default</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="nnrc_default_optim_list">nnrc_default_optim_list</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= [<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tinline_let_step">tinline_let_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_either_nil_step">tcount_over_flat_for_either_either_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tcount_over_flat_for_either_if_nil_step">tcount_over_flat_for_either_if_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_concat_to_concat_step">tmerge_concat_to_concat_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_concat_rec_step">tdot_of_concat_rec_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tdot_of_rec_step">tdot_of_rec_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnth0_bag_step">tnth0_bag_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnth0_nil_step">tnth0_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_singleton_step">tflatten_singleton_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tflatten_nil_step">tflatten_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_singleton_to_let_step">tfor_singleton_to_let_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_either_const_step">tunop_over_either_const_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tunop_over_if_const_step">tunop_over_if_const_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tbinop_over_if_left_const_step">tbinop_over_if_left_const_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tbinop_over_let_left_const_step">tbinop_over_let_left_const_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_either_nil_step">tfor_over_either_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_for_step">tfor_over_for_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_over_if_nil_step">tfor_over_if_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tfor_nil_step">tfor_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmerge_nil_step">tmerge_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tconcat_nil_step">tconcat_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tmap_sigma_fusion_samevar_step">tmap_sigma_fusion_samevar_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_nil_step">tproject_nil_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_const_step">tproject_over_const_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_rec_step">tproject_over_rec_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_r_step">tproject_over_concat_r_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_concat_l_step">tproject_over_concat_l_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_project_step">tproject_over_project_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id"><a href="Qcert.Utils.OptimizerStep.html#optim_step_name">optim_step_name</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tproject_over_either_step">tproject_over_either_step</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Remark</span> <span class="id"><a name="nnrc_default_optim_list_all_valid">nnrc_default_optim_list_all_valid</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="Qcert.Utils.OptimizerStep.html#valid_optims">valid_optims</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#tnnrc_optim_list">tnnrc_optim_list</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_default_optim_list">nnrc_default_optim_list</a></span> = (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_default_optim_list">nnrc_default_optim_list</a></span>,<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3165')">Proof.</div>
<div class="proofscript" id="proof3165">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">vm_compute</span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="default_nnrc_optim_phases">default_nnrc_optim_phases</a></span> {<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;("[<span class="id">nnrc</span>] <span class="id">default</span>"%<span class="id">string</span>,<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_default_optim_list">nnrc_default_optim_list</a></span>,10)::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#NNRCOptimizer.default">default</a></span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="nnrc_optim_top_default">nnrc_optim_top_default</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">fruntime</span>:<span class="id"><a href="Qcert.Data.ForeignRuntime.html#foreign_runtime">foreign_runtime</a></span>} {<span class="id">logger</span>:<span class="id"><a href="Qcert.Utils.OptimizerLogger.html#optimizer_logger">optimizer_logger</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_optim_top">nnrc_optim_top</a></span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#default_nnrc_optim_phases">default_nnrc_optim_phases</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="nnrc_optim_top_default_correct">nnrc_optim_top_default_correct</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">model</span>:<span class="id"><a href="Qcert.Data.DataSystem.html#basic_model">basic_model</a></span>} {<span class="id">logger</span>:<span class="id"><a href="Qcert.Utils.OptimizerLogger.html#optimizer_logger">optimizer_logger</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html#string">string</a></span> <span class="id"><a href="Qcert.NNRC.Lang.NNRC.html#nnrc">nnrc</a></span>} <span class="id">p</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Qcert.NNRC.Typing.TNNRCEq.html#tnnrc_rewrites_to">tnnrc_rewrites_to</a></span> <span class="id">p</span> (<span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_optim_top_default">nnrc_optim_top_default</a></span> <span class="id">p</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3166')">Proof.</div>
<div class="proofscript" id="proof3166">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_optim_top_default">nnrc_optim_top_default</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#nnrc_optim_top_correctness">nnrc_optim_top_correctness</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="Qcert.NNRC.Optim.NNRCOptimizer.html#NNRCOptimizer">NNRCOptimizer</a></span>.<br/>
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
